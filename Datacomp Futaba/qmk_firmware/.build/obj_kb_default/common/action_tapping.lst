   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.text
   9               	.Ltext0:
  10               		.cfi_sections	.debug_frame
  11               		.section	.text.debug_waiting_buffer,"ax",@progbits
  13               	debug_waiting_buffer:
  14               	.LFB12:
  15               		.file 1 "./tmk_core/common/action_tapping.c"
   1:./tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:./tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:./tmk_core/common/action_tapping.c **** #include "action.h"
   4:./tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:./tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:./tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:./tmk_core/common/action_tapping.c **** #include "timer.h"
   8:./tmk_core/common/action_tapping.c **** 
   9:./tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:./tmk_core/common/action_tapping.c **** #include "debug.h"
  11:./tmk_core/common/action_tapping.c **** #else
  12:./tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:./tmk_core/common/action_tapping.c **** #endif
  14:./tmk_core/common/action_tapping.c **** 
  15:./tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:./tmk_core/common/action_tapping.c **** 
  17:./tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:./tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:./tmk_core/common/action_tapping.c **** 
  23:./tmk_core/common/action_tapping.c **** 
  24:./tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:./tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:./tmk_core/common/action_tapping.c **** 
  29:./tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:./tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  34:./tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  35:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  36:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  37:./tmk_core/common/action_tapping.c **** 
  38:./tmk_core/common/action_tapping.c **** 
  39:./tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  40:./tmk_core/common/action_tapping.c **** {
  41:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  42:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  43:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  44:./tmk_core/common/action_tapping.c ****         }
  45:./tmk_core/common/action_tapping.c ****     } else {
  46:./tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  47:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  48:./tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  49:./tmk_core/common/action_tapping.c ****             clear_keyboard();
  50:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  51:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  52:./tmk_core/common/action_tapping.c ****         }
  53:./tmk_core/common/action_tapping.c ****     }
  54:./tmk_core/common/action_tapping.c **** 
  55:./tmk_core/common/action_tapping.c ****     // process waiting_buffer
  56:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  57:./tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  58:./tmk_core/common/action_tapping.c ****     }
  59:./tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  60:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  61:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  62:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  63:./tmk_core/common/action_tapping.c ****         } else {
  64:./tmk_core/common/action_tapping.c ****             break;
  65:./tmk_core/common/action_tapping.c ****         }
  66:./tmk_core/common/action_tapping.c ****     }
  67:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  68:./tmk_core/common/action_tapping.c ****         debug("\n");
  69:./tmk_core/common/action_tapping.c ****     }
  70:./tmk_core/common/action_tapping.c **** }
  71:./tmk_core/common/action_tapping.c **** 
  72:./tmk_core/common/action_tapping.c **** 
  73:./tmk_core/common/action_tapping.c **** /* Tapping
  74:./tmk_core/common/action_tapping.c ****  *
  75:./tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  76:./tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  77:./tmk_core/common/action_tapping.c ****  */
  78:./tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  79:./tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  80:./tmk_core/common/action_tapping.c **** {
  81:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  82:./tmk_core/common/action_tapping.c **** 
  83:./tmk_core/common/action_tapping.c ****     // if tapping
  84:./tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  85:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  86:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  87:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  88:./tmk_core/common/action_tapping.c ****                     // first tap!
  89:./tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  90:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  91:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  92:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
  93:./tmk_core/common/action_tapping.c **** 
  94:./tmk_core/common/action_tapping.c ****                     // copy tapping state
  95:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
  96:./tmk_core/common/action_tapping.c ****                     // enqueue
  97:./tmk_core/common/action_tapping.c ****                     return false;
  98:./tmk_core/common/action_tapping.c ****                 }
  99:./tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500
 100:./tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 101:./tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 102:./tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 103:./tmk_core/common/action_tapping.c ****                  */
 104:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 105:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 106:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 107:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 108:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 109:./tmk_core/common/action_tapping.c ****                     // enqueue
 110:./tmk_core/common/action_tapping.c ****                     return false;
 111:./tmk_core/common/action_tapping.c ****                 }
 112:./tmk_core/common/action_tapping.c **** #endif
 113:./tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 114:./tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 115:./tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 116:./tmk_core/common/action_tapping.c ****                  */
 117:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 118:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 119:./tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 120:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 121:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 122:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 123:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 124:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 125:./tmk_core/common/action_tapping.c ****                             break;
 126:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 127:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 128:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 129:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 130:./tmk_core/common/action_tapping.c ****                             break;
 131:./tmk_core/common/action_tapping.c ****                     }
 132:./tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 133:./tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 134:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 135:./tmk_core/common/action_tapping.c ****                     return true;
 136:./tmk_core/common/action_tapping.c ****                 }
 137:./tmk_core/common/action_tapping.c ****                 else {
 138:./tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 139:./tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 140:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 141:./tmk_core/common/action_tapping.c ****                     }
 142:./tmk_core/common/action_tapping.c ****                     // enqueue
 143:./tmk_core/common/action_tapping.c ****                     return false;
 144:./tmk_core/common/action_tapping.c ****                 }
 145:./tmk_core/common/action_tapping.c ****             }
 146:./tmk_core/common/action_tapping.c ****             // tap_count > 0
 147:./tmk_core/common/action_tapping.c ****             else {
 148:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 149:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 150:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 151:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 152:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 153:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 154:./tmk_core/common/action_tapping.c ****                     return true;
 155:./tmk_core/common/action_tapping.c ****                 }
 156:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 157:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 158:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 159:./tmk_core/common/action_tapping.c ****                         // unregister key
 160:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 161:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 162:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 163:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 164:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 165:./tmk_core/common/action_tapping.c ****                         });
 166:./tmk_core/common/action_tapping.c ****                     } else {
 167:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 168:./tmk_core/common/action_tapping.c ****                     }
 169:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 170:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 171:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 172:./tmk_core/common/action_tapping.c ****                     return true;
 173:./tmk_core/common/action_tapping.c ****                 }
 174:./tmk_core/common/action_tapping.c ****                 else {
 175:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 176:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 177:./tmk_core/common/action_tapping.c ****                     }
 178:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 179:./tmk_core/common/action_tapping.c ****                     return true;
 180:./tmk_core/common/action_tapping.c ****                 }
 181:./tmk_core/common/action_tapping.c ****             }
 182:./tmk_core/common/action_tapping.c ****         }
 183:./tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 184:./tmk_core/common/action_tapping.c ****         else {
 185:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 186:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 187:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 188:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 189:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 190:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 191:./tmk_core/common/action_tapping.c ****                 return false;
 192:./tmk_core/common/action_tapping.c ****             }  else {
 193:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 194:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 195:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 196:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 197:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 198:./tmk_core/common/action_tapping.c ****                     return true;
 199:./tmk_core/common/action_tapping.c ****                 }
 200:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 201:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 202:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 203:./tmk_core/common/action_tapping.c ****                         // unregister key
 204:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 205:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 206:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 207:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 208:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 209:./tmk_core/common/action_tapping.c ****                         });
 210:./tmk_core/common/action_tapping.c ****                     } else {
 211:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 212:./tmk_core/common/action_tapping.c ****                     }
 213:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 214:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 215:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 216:./tmk_core/common/action_tapping.c ****                     return true;
 217:./tmk_core/common/action_tapping.c ****                 }
 218:./tmk_core/common/action_tapping.c ****                 else {
 219:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 220:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 221:./tmk_core/common/action_tapping.c ****                     }
 222:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 223:./tmk_core/common/action_tapping.c ****                     return true;
 224:./tmk_core/common/action_tapping.c ****                 }
 225:./tmk_core/common/action_tapping.c ****             }
 226:./tmk_core/common/action_tapping.c ****         }
 227:./tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 228:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 229:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 230:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 231:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 232:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 233:./tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 234:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 235:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 236:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 237:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 238:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 239:./tmk_core/common/action_tapping.c ****                         return true;
 240:./tmk_core/common/action_tapping.c ****                     } else {
 241:./tmk_core/common/action_tapping.c ****                         // FIX: start new tap again
 242:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 243:./tmk_core/common/action_tapping.c ****                         return true;
 244:./tmk_core/common/action_tapping.c ****                     }
 245:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 246:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 247:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 248:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 249:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 250:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 251:./tmk_core/common/action_tapping.c ****                     return true;
 252:./tmk_core/common/action_tapping.c ****                 } else {
 253:./tmk_core/common/action_tapping.c ****                     // should none in buffer
 254:./tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 255:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 256:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 257:./tmk_core/common/action_tapping.c ****                     return true;
 258:./tmk_core/common/action_tapping.c ****                 }
 259:./tmk_core/common/action_tapping.c ****             } else {
 260:./tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n") {};
 261:./tmk_core/common/action_tapping.c ****                 process_record(keyp);
 262:./tmk_core/common/action_tapping.c ****                 return true;
 263:./tmk_core/common/action_tapping.c ****             }
 264:./tmk_core/common/action_tapping.c ****         } else {
 265:./tmk_core/common/action_tapping.c ****             // FIX: process_aciton here?
 266:./tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 267:./tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 268:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 269:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 270:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 271:./tmk_core/common/action_tapping.c ****             return false;
 272:./tmk_core/common/action_tapping.c ****         }
 273:./tmk_core/common/action_tapping.c ****     }
 274:./tmk_core/common/action_tapping.c ****     // not tapping state
 275:./tmk_core/common/action_tapping.c ****     else {
 276:./tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event.key)) {
 277:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 278:./tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 279:./tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 280:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 281:./tmk_core/common/action_tapping.c ****             return true;
 282:./tmk_core/common/action_tapping.c ****         } else {
 283:./tmk_core/common/action_tapping.c ****             process_record(keyp);
 284:./tmk_core/common/action_tapping.c ****             return true;
 285:./tmk_core/common/action_tapping.c ****         }
 286:./tmk_core/common/action_tapping.c ****     }
 287:./tmk_core/common/action_tapping.c **** }
 288:./tmk_core/common/action_tapping.c **** 
 289:./tmk_core/common/action_tapping.c **** 
 290:./tmk_core/common/action_tapping.c **** /*
 291:./tmk_core/common/action_tapping.c ****  * Waiting buffer
 292:./tmk_core/common/action_tapping.c ****  */
 293:./tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 294:./tmk_core/common/action_tapping.c **** {
 295:./tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 296:./tmk_core/common/action_tapping.c ****         return true;
 297:./tmk_core/common/action_tapping.c ****     }
 298:./tmk_core/common/action_tapping.c **** 
 299:./tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 300:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 301:./tmk_core/common/action_tapping.c ****         return false;
 302:./tmk_core/common/action_tapping.c ****     }
 303:./tmk_core/common/action_tapping.c **** 
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 305:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 306:./tmk_core/common/action_tapping.c **** 
 307:./tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 308:./tmk_core/common/action_tapping.c ****     return true;
 309:./tmk_core/common/action_tapping.c **** }
 310:./tmk_core/common/action_tapping.c **** 
 311:./tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 312:./tmk_core/common/action_tapping.c **** {
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 314:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 315:./tmk_core/common/action_tapping.c **** }
 316:./tmk_core/common/action_tapping.c **** 
 317:./tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 318:./tmk_core/common/action_tapping.c **** {
 319:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 320:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 321:./tmk_core/common/action_tapping.c ****             return true;
 322:./tmk_core/common/action_tapping.c ****         }
 323:./tmk_core/common/action_tapping.c ****     }
 324:./tmk_core/common/action_tapping.c ****     return false;
 325:./tmk_core/common/action_tapping.c **** }
 326:./tmk_core/common/action_tapping.c **** 
 327:./tmk_core/common/action_tapping.c **** __attribute__((unused))
 328:./tmk_core/common/action_tapping.c **** bool waiting_buffer_has_anykey_pressed(void)
 329:./tmk_core/common/action_tapping.c **** {
 330:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 331:./tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 332:./tmk_core/common/action_tapping.c ****     }
 333:./tmk_core/common/action_tapping.c ****     return false;
 334:./tmk_core/common/action_tapping.c **** }
 335:./tmk_core/common/action_tapping.c **** 
 336:./tmk_core/common/action_tapping.c **** /* scan buffer for tapping */
 337:./tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 338:./tmk_core/common/action_tapping.c **** {
 339:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 340:./tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 341:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 342:./tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 343:./tmk_core/common/action_tapping.c **** 
 344:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 345:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 346:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 347:./tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 348:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 349:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 350:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 351:./tmk_core/common/action_tapping.c **** 
 352:./tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 353:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 354:./tmk_core/common/action_tapping.c ****             return;
 355:./tmk_core/common/action_tapping.c ****         }
 356:./tmk_core/common/action_tapping.c ****     }
 357:./tmk_core/common/action_tapping.c **** }
 358:./tmk_core/common/action_tapping.c **** 
 359:./tmk_core/common/action_tapping.c **** 
 360:./tmk_core/common/action_tapping.c **** /*
 361:./tmk_core/common/action_tapping.c ****  * debug print
 362:./tmk_core/common/action_tapping.c ****  */
 363:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 364:./tmk_core/common/action_tapping.c **** {
 365:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 366:./tmk_core/common/action_tapping.c **** }
 367:./tmk_core/common/action_tapping.c **** 
 368:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 369:./tmk_core/common/action_tapping.c **** {
  16               		.loc 1 369 1 view -0
  17               		.cfi_startproc
  18 0000 1F93      		push r17
  19               	.LCFI0:
  20               		.cfi_def_cfa_offset 3
  21               		.cfi_offset 17, -2
  22 0002 CF93      		push r28
  23               	.LCFI1:
  24               		.cfi_def_cfa_offset 4
  25               		.cfi_offset 28, -3
  26 0004 DF93      		push r29
  27               	.LCFI2:
  28               		.cfi_def_cfa_offset 5
  29               		.cfi_offset 29, -4
  30               	/* prologue: function */
  31               	/* frame size = 0 */
  32               	/* stack size = 3 */
  33               	.L__stack_usage = 3
 370:./tmk_core/common/action_tapping.c ****     debug("{ ");
  34               		.loc 1 370 16 view .LVU1
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  35               		.loc 1 371 5 view .LVU2
  36               	.LBB40:
  37               		.loc 1 371 10 view .LVU3
  38               		.loc 1 371 18 is_stmt 0 view .LVU4
  39 0006 E091 0000 		lds r30,waiting_buffer_tail
  40               	.LVL0:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  41               		.loc 1 372 48 view .LVU5
  42 000a 16E0      		ldi r17,lo8(6)
  43               	.LVL1:
  44               	.L2:
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  45               		.loc 1 371 45 is_stmt 1 discriminator 1 view .LVU6
  46 000c 8091 0000 		lds r24,waiting_buffer_head
  47 0010 8E13      		cpse r24,r30
  48 0012 00C0      		rjmp .L3
  49               	/* epilogue start */
  50               	.LBE40:
 373:./tmk_core/common/action_tapping.c ****     }
 374:./tmk_core/common/action_tapping.c ****     debug("}\n");
 375:./tmk_core/common/action_tapping.c **** }
  51               		.loc 1 375 1 is_stmt 0 view .LVU7
  52 0014 DF91      		pop r29
  53 0016 CF91      		pop r28
  54 0018 1F91      		pop r17
  55 001a 0895      		ret
  56               	.L3:
  57               	.LBB41:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  58               		.loc 1 372 19 is_stmt 1 discriminator 3 view .LVU8
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  59               		.loc 1 372 33 discriminator 3 view .LVU9
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  60               		.loc 1 372 46 discriminator 3 view .LVU10
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  61               		.loc 1 372 48 discriminator 3 view .LVU11
  62 001c CE2F      		mov r28,r30
  63 001e D0E0      		ldi r29,0
  64 0020 1E9F      		mul r17,r30
  65 0022 F001      		movw r30,r0
  66 0024 1124      		clr __zero_reg__
  67               	.LVL2:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  68               		.loc 1 372 48 is_stmt 0 discriminator 3 view .LVU12
  69 0026 E050      		subi r30,lo8(-(waiting_buffer))
  70 0028 F040      		sbci r31,hi8(-(waiting_buffer))
  71 002a 4081      		ld r20,Z
  72 002c 5181      		ldd r21,Z+1
  73 002e 6281      		ldd r22,Z+2
  74 0030 7381      		ldd r23,Z+3
  75 0032 8481      		ldd r24,Z+4
  76 0034 9581      		ldd r25,Z+5
  77 0036 0E94 0000 		call debug_record
  78               	.LVL3:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  79               		.loc 1 372 91 is_stmt 1 discriminator 3 view .LVU13
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  80               		.loc 1 371 71 discriminator 3 view .LVU14
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  81               		.loc 1 371 76 is_stmt 0 discriminator 3 view .LVU15
  82 003a 2196      		adiw r28,1
  83               	.LVL4:
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  84               		.loc 1 371 71 discriminator 3 view .LVU16
  85 003c EC2F      		mov r30,r28
  86 003e E770      		andi r30,lo8(7)
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  87               		.loc 1 371 71 discriminator 3 view .LVU17
  88 0040 00C0      		rjmp .L2
  89               	.LBE41:
  90               		.cfi_endproc
  91               	.LFE12:
  93               		.section	.text.debug_tapping_key,"ax",@progbits
  95               	debug_tapping_key:
  96               	.LFB11:
 364:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  97               		.loc 1 364 1 is_stmt 1 view -0
  98               		.cfi_startproc
  99               	/* prologue: function */
 100               	/* frame size = 0 */
 101               	/* stack size = 0 */
 102               	.L__stack_usage = 0
 365:./tmk_core/common/action_tapping.c **** }
 103               		.loc 1 365 26 view .LVU19
 365:./tmk_core/common/action_tapping.c **** }
 104               		.loc 1 365 28 view .LVU20
 105 0000 4091 0000 		lds r20,tapping_key
 106 0004 5091 0000 		lds r21,tapping_key+1
 107 0008 6091 0000 		lds r22,tapping_key+2
 108 000c 7091 0000 		lds r23,tapping_key+3
 109 0010 8091 0000 		lds r24,tapping_key+4
 110 0014 9091 0000 		lds r25,tapping_key+5
 111 0018 0C94 0000 		jmp debug_record
 112               	.LVL5:
 113               		.cfi_endproc
 114               	.LFE11:
 116               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 118               	waiting_buffer_scan_tap:
 119               	.LFB10:
 338:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 120               		.loc 1 338 1 view -0
 121               		.cfi_startproc
 122 0000 CF93      		push r28
 123               	.LCFI3:
 124               		.cfi_def_cfa_offset 3
 125               		.cfi_offset 28, -2
 126               	/* prologue: function */
 127               	/* frame size = 0 */
 128               	/* stack size = 1 */
 129               	.L__stack_usage = 1
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 130               		.loc 1 340 5 view .LVU22
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 131               		.loc 1 340 31 is_stmt 0 view .LVU23
 132 0002 8091 0000 		lds r24,tapping_key+5
 133 0006 807F      		andi r24,lo8(-16)
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 134               		.loc 1 340 8 view .LVU24
 135 0008 01F4      		brne .L5
 342:./tmk_core/common/action_tapping.c **** 
 136               		.loc 1 342 5 is_stmt 1 view .LVU25
 342:./tmk_core/common/action_tapping.c **** 
 137               		.loc 1 342 8 is_stmt 0 view .LVU26
 138 000a 8091 0000 		lds r24,tapping_key+2
 139 000e 8823      		tst r24
 140 0010 01F0      		breq .L5
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 141               		.loc 1 344 5 is_stmt 1 view .LVU27
 142               	.LBB42:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 143               		.loc 1 344 10 view .LVU28
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 144               		.loc 1 344 18 is_stmt 0 view .LVU29
 145 0012 8091 0000 		lds r24,waiting_buffer_tail
 146               	.LVL6:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 147               		.loc 1 344 45 view .LVU30
 148 0016 A091 0000 		lds r26,waiting_buffer_head
 149 001a 7091 0000 		lds r23,tapping_key
 150 001e 6091 0000 		lds r22,tapping_key+1
 151 0022 4091 0000 		lds r20,tapping_key+3
 152 0026 5091 0000 		lds r21,tapping_key+3+1
 153 002a B62F      		mov r27,r22
 154 002c B723      		and r27,r23
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 155               		.loc 1 345 13 view .LVU31
 156 002e C6E0      		ldi r28,lo8(6)
 157               	.LVL7:
 158               	.L7:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 159               		.loc 1 344 45 is_stmt 1 discriminator 1 view .LVU32
 160 0030 A813      		cpse r26,r24
 161 0032 00C0      		rjmp .L12
 162               	.LVL8:
 163               	.L5:
 164               	/* epilogue start */
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 165               		.loc 1 344 45 is_stmt 0 discriminator 1 view .LVU33
 166               	.LBE42:
 357:./tmk_core/common/action_tapping.c **** 
 167               		.loc 1 357 1 view .LVU34
 168 0034 CF91      		pop r28
 169 0036 0895      		ret
 170               	.LVL9:
 171               	.L12:
 172               	.LBB47:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 173               		.loc 1 345 9 is_stmt 1 view .LVU35
 174               	.LBB43:
 175               	.LBI43:
 176               		.file 2 "./tmk_core/common/keyboard.h"
   1:./tmk_core/common/keyboard.h **** /*
   2:./tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:./tmk_core/common/keyboard.h **** 
   4:./tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:./tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:./tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:./tmk_core/common/keyboard.h **** (at your option) any later version.
   8:./tmk_core/common/keyboard.h **** 
   9:./tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:./tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:./tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:./tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:./tmk_core/common/keyboard.h **** 
  14:./tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:./tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:./tmk_core/common/keyboard.h **** */
  17:./tmk_core/common/keyboard.h **** 
  18:./tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:./tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:./tmk_core/common/keyboard.h **** 
  21:./tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:./tmk_core/common/keyboard.h **** #include <stdint.h>
  23:./tmk_core/common/keyboard.h **** 
  24:./tmk_core/common/keyboard.h **** 
  25:./tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:./tmk_core/common/keyboard.h **** extern "C" {
  27:./tmk_core/common/keyboard.h **** #endif
  28:./tmk_core/common/keyboard.h **** 
  29:./tmk_core/common/keyboard.h **** /* key matrix position */
  30:./tmk_core/common/keyboard.h **** typedef struct {
  31:./tmk_core/common/keyboard.h ****     uint8_t col;
  32:./tmk_core/common/keyboard.h ****     uint8_t row;
  33:./tmk_core/common/keyboard.h **** } keypos_t;
  34:./tmk_core/common/keyboard.h **** 
  35:./tmk_core/common/keyboard.h **** /* key event */
  36:./tmk_core/common/keyboard.h **** typedef struct {
  37:./tmk_core/common/keyboard.h ****     keypos_t key;
  38:./tmk_core/common/keyboard.h ****     bool     pressed;
  39:./tmk_core/common/keyboard.h ****     uint16_t time;
  40:./tmk_core/common/keyboard.h **** } keyevent_t;
  41:./tmk_core/common/keyboard.h **** 
  42:./tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:./tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:./tmk_core/common/keyboard.h **** 
  45:./tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:./tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:./tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:./tmk_core/common/keyboard.h ****  */
  49:./tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 177               		.loc 2 49 20 view .LVU36
 178               	.LBB44:
 179               		.loc 2 49 51 view .LVU37
 180               	.LBE44:
 181               	.LBE43:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 182               		.loc 1 345 13 is_stmt 0 view .LVU38
 183 0038 90E0      		ldi r25,0
 184               	.LBB46:
 185               	.LBB45:
 186               		.loc 2 49 74 view .LVU39
 187 003a 4115      		cp r20,__zero_reg__
 188 003c 5105      		cpc r21,__zero_reg__
 189 003e 01F0      		breq .L8
 190 0040 BF3F      		cpi r27,lo8(-1)
 191 0042 01F4      		brne .L23
 192               	.LVL10:
 193               	.L8:
 194               		.loc 2 49 74 view .LVU40
 195               	.LBE45:
 196               	.LBE46:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 197               		.loc 1 344 71 is_stmt 1 discriminator 2 view .LVU41
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 198               		.loc 1 344 76 is_stmt 0 discriminator 2 view .LVU42
 199 0044 0196      		adiw r24,1
 200               	.LVL11:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 201               		.loc 1 344 71 discriminator 2 view .LVU43
 202 0046 8770      		andi r24,lo8(7)
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 203               		.loc 1 344 71 discriminator 2 view .LVU44
 204 0048 00C0      		rjmp .L7
 205               	.LVL12:
 206               	.L10:
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 207               		.loc 1 347 17 discriminator 2 view .LVU45
 208 004a 2150      		subi r18,1
 209 004c 3109      		sbc r19,__zero_reg__
 210 004e 00C0      		rjmp .L25
 211               	.LVL13:
 212               	.L23:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 213               		.loc 1 345 13 view .LVU46
 214 0050 C89F      		mul r28,r24
 215 0052 F001      		movw r30,r0
 216 0054 C99F      		mul r28,r25
 217 0056 F00D      		add r31,r0
 218 0058 1124      		clr __zero_reg__
 219 005a E050      		subi r30,lo8(-(waiting_buffer))
 220 005c F040      		sbci r31,hi8(-(waiting_buffer))
 221 005e 2181      		ldd r18,Z+1
 222 0060 6213      		cpse r22,r18
 223 0062 00C0      		rjmp .L8
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 224               		.loc 1 345 13 discriminator 2 view .LVU47
 225 0064 2081      		ld r18,Z
 226 0066 2713      		cpse r18,r23
 227 0068 00C0      		rjmp .L8
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 228               		.loc 1 345 57 discriminator 3 view .LVU48
 229 006a 2281      		ldd r18,Z+2
 230 006c 2111      		cpse r18,__zero_reg__
 231 006e 00C0      		rjmp .L8
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 232               		.loc 1 347 17 view .LVU49
 233 0070 0380      		ldd __tmp_reg__,Z+3
 234 0072 F481      		ldd r31,Z+4
 235 0074 E02D      		mov r30,__tmp_reg__
 236 0076 9F01      		movw r18,r30
 237 0078 241B      		sub r18,r20
 238 007a 350B      		sbc r19,r21
 239 007c E417      		cp r30,r20
 240 007e F507      		cpc r31,r21
 241 0080 00F0      		brlo .L10
 242               	.L25:
 346:./tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 243               		.loc 1 346 50 discriminator 2 view .LVU50
 244 0082 283C      		cpi r18,-56
 245 0084 3105      		cpc r19,__zero_reg__
 246 0086 00F4      		brsh .L8
 348:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 247               		.loc 1 348 13 is_stmt 1 view .LVU51
 348:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 248               		.loc 1 348 35 is_stmt 0 view .LVU52
 249 0088 2091 0000 		lds r18,tapping_key+5
 250 008c 2F70      		andi r18,lo8(15)
 251 008e 2061      		ori r18,lo8(16)
 252 0090 2093 0000 		sts tapping_key+5,r18
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 253               		.loc 1 349 13 is_stmt 1 view .LVU53
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 254               		.loc 1 349 41 is_stmt 0 view .LVU54
 255 0094 26E0      		ldi r18,lo8(6)
 256 0096 289F      		mul r18,r24
 257 0098 F001      		movw r30,r0
 258 009a 299F      		mul r18,r25
 259 009c F00D      		add r31,r0
 260 009e 1124      		clr __zero_reg__
 261 00a0 E050      		subi r30,lo8(-(waiting_buffer+5))
 262 00a2 F040      		sbci r31,hi8(-(waiting_buffer+5))
 263 00a4 8081      		ld r24,Z
 264               	.LVL14:
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 265               		.loc 1 349 41 view .LVU55
 266 00a6 8F70      		andi r24,lo8(15)
 267 00a8 8061      		ori r24,lo8(16)
 268 00aa 8083      		st Z,r24
 350:./tmk_core/common/action_tapping.c **** 
 269               		.loc 1 350 13 is_stmt 1 view .LVU56
 270 00ac 80E0      		ldi r24,lo8(tapping_key)
 271 00ae 90E0      		ldi r25,hi8(tapping_key)
 272 00b0 0E94 0000 		call process_record
 273               	.LVL15:
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 274               		.loc 1 352 57 view .LVU57
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 275               		.loc 1 352 71 view .LVU58
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 276               		.loc 1 352 85 view .LVU59
 353:./tmk_core/common/action_tapping.c ****             return;
 277               		.loc 1 353 13 view .LVU60
 278               	/* epilogue start */
 279               	.LBE47:
 357:./tmk_core/common/action_tapping.c **** 
 280               		.loc 1 357 1 is_stmt 0 view .LVU61
 281 00b4 CF91      		pop r28
 282               	.LBB48:
 353:./tmk_core/common/action_tapping.c ****             return;
 283               		.loc 1 353 13 view .LVU62
 284 00b6 0C94 0000 		jmp debug_waiting_buffer
 285               	.LVL16:
 286               	.LBE48:
 287               		.cfi_endproc
 288               	.LFE10:
 290               		.section	.text.process_tapping,"ax",@progbits
 292               	process_tapping:
 293               	.LVL17:
 294               	.LFB5:
  80:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 295               		.loc 1 80 1 is_stmt 1 view -0
 296               		.cfi_startproc
  80:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 297               		.loc 1 80 1 is_stmt 0 view .LVU64
 298 0000 9F92      		push r9
 299               	.LCFI4:
 300               		.cfi_def_cfa_offset 3
 301               		.cfi_offset 9, -2
 302 0002 AF92      		push r10
 303               	.LCFI5:
 304               		.cfi_def_cfa_offset 4
 305               		.cfi_offset 10, -3
 306 0004 BF92      		push r11
 307               	.LCFI6:
 308               		.cfi_def_cfa_offset 5
 309               		.cfi_offset 11, -4
 310 0006 CF92      		push r12
 311               	.LCFI7:
 312               		.cfi_def_cfa_offset 6
 313               		.cfi_offset 12, -5
 314 0008 DF92      		push r13
 315               	.LCFI8:
 316               		.cfi_def_cfa_offset 7
 317               		.cfi_offset 13, -6
 318 000a EF92      		push r14
 319               	.LCFI9:
 320               		.cfi_def_cfa_offset 8
 321               		.cfi_offset 14, -7
 322 000c FF92      		push r15
 323               	.LCFI10:
 324               		.cfi_def_cfa_offset 9
 325               		.cfi_offset 15, -8
 326 000e 0F93      		push r16
 327               	.LCFI11:
 328               		.cfi_def_cfa_offset 10
 329               		.cfi_offset 16, -9
 330 0010 1F93      		push r17
 331               	.LCFI12:
 332               		.cfi_def_cfa_offset 11
 333               		.cfi_offset 17, -10
 334 0012 CF93      		push r28
 335               	.LCFI13:
 336               		.cfi_def_cfa_offset 12
 337               		.cfi_offset 28, -11
 338 0014 DF93      		push r29
 339               	.LCFI14:
 340               		.cfi_def_cfa_offset 13
 341               		.cfi_offset 29, -12
 342 0016 CDB7      		in r28,__SP_L__
 343 0018 DEB7      		in r29,__SP_H__
 344               	.LCFI15:
 345               		.cfi_def_cfa_register 28
 346 001a 2B97      		sbiw r28,11
 347               	.LCFI16:
 348               		.cfi_def_cfa_offset 24
 349 001c 0FB6      		in __tmp_reg__,__SREG__
 350 001e F894      		cli
 351 0020 DEBF      		out __SP_H__,r29
 352 0022 0FBE      		out __SREG__,__tmp_reg__
 353 0024 CDBF      		out __SP_L__,r28
 354               	/* prologue: function */
 355               	/* frame size = 11 */
 356               	/* stack size = 22 */
 357               	.L__stack_usage = 22
 358 0026 8C01      		movw r16,r24
  81:./tmk_core/common/action_tapping.c **** 
 359               		.loc 1 81 5 is_stmt 1 view .LVU65
  81:./tmk_core/common/action_tapping.c **** 
 360               		.loc 1 81 16 is_stmt 0 view .LVU66
 361 0028 85E0      		ldi r24,lo8(5)
 362               	.LVL18:
  81:./tmk_core/common/action_tapping.c **** 
 363               		.loc 1 81 16 view .LVU67
 364 002a F801      		movw r30,r16
 365 002c DE01      		movw r26,r28
 366 002e 1796      		adiw r26,7
 367               		0:
 368 0030 0190      		ld r0,Z+
 369 0032 0D92      		st X+,r0
 370 0034 8A95      		dec r24
 371 0036 01F4      		brne 0b
 372 0038 D801      		movw r26,r16
 373 003a 1296      		adiw r26,2
 374 003c EC90      		ld r14,X
 375 003e 1297      		sbiw r26,2
 376               	.LVL19:
  81:./tmk_core/common/action_tapping.c **** 
 377               		.loc 1 81 16 view .LVU68
 378 0040 3C91      		ld r19,X
 379               	.LVL20:
  81:./tmk_core/common/action_tapping.c **** 
 380               		.loc 1 81 16 view .LVU69
 381 0042 1196      		adiw r26,1
 382 0044 2C91      		ld r18,X
 383 0046 1197      		sbiw r26,1
 384               	.LVL21:
  81:./tmk_core/common/action_tapping.c **** 
 385               		.loc 1 81 16 view .LVU70
 386 0048 1396      		adiw r26,3
 387 004a CD90      		ld r12,X+
 388 004c DC90      		ld r13,X
 389               	.LVL22:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 390               		.loc 1 84 5 is_stmt 1 view .LVU71
 391 004e 4091 0000 		lds r20,tapping_key
 392               	.LVL23:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 393               		.loc 1 84 5 is_stmt 0 view .LVU72
 394 0052 5091 0000 		lds r21,tapping_key+1
 395               	.LVL24:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 396               		.loc 1 84 5 view .LVU73
 397 0056 6091 0000 		lds r22,tapping_key+3
 398 005a 7091 0000 		lds r23,tapping_key+3+1
 399               	.LVL25:
 400               	.LBB75:
 401               	.LBI75:
 402               		.loc 2 49 20 is_stmt 1 view .LVU74
 403               	.LBB76:
 404               		.loc 2 49 51 view .LVU75
 405               		.loc 2 49 74 is_stmt 0 view .LVU76
 406 005e 6115      		cp r22,__zero_reg__
 407 0060 7105      		cpc r23,__zero_reg__
 408 0062 01F0      		breq .L27
 409 0064 842F      		mov r24,r20
 410 0066 8523      		and r24,r21
 411 0068 8F3F      		cpi r24,lo8(-1)
 412 006a 01F0      		breq .+2
 413 006c 00C0      		rjmp .L115
 414               	.L27:
 415               	.LVL26:
 416               		.loc 2 49 74 view .LVU77
 417               	.LBE76:
 418               	.LBE75:
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 419               		.loc 1 276 9 is_stmt 1 view .LVU78
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 420               		.loc 1 276 12 is_stmt 0 view .LVU79
 421 006e EE20      		tst r14
 422 0070 01F4      		brne .+2
 423 0072 00C0      		rjmp .L58
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 424               		.loc 1 276 30 discriminator 1 view .LVU80
 425 0074 8F81      		ldd r24,Y+7
 426 0076 9885      		ldd r25,Y+8
 427 0078 0E94 0000 		call is_tap_key
 428               	.LVL27:
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 429               		.loc 1 276 27 discriminator 1 view .LVU81
 430 007c 8823      		tst r24
 431 007e 01F4      		brne .+2
 432 0080 00C0      		rjmp .L58
 433 0082 00C0      		rjmp .L50
 434               	.LVL28:
 435               	.L67:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 436               		.loc 1 85 9 is_stmt 1 view .LVU82
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 437               		.loc 1 85 13 is_stmt 0 view .LVU83
 438 0084 C616      		cp r12,r22
 439 0086 D706      		cpc r13,r23
 440 0088 00F0      		brlo .L29
 441               	.L123:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 442               		.loc 1 85 13 discriminator 2 view .LVU84
 443 008a FF24      		clr r15
 444 008c F394      		inc r15
 445 008e 883C      		cpi r24,-56
 446 0090 9105      		cpc r25,__zero_reg__
 447 0092 00F0      		brlo .L31
 448 0094 F12C      		mov r15,__zero_reg__
 449               	.L31:
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 450               		.loc 1 86 39 view .LVU85
 451 0096 80E0      		ldi r24,lo8(tapping_key)
 452 0098 A82E      		mov r10,r24
 453 009a 80E0      		ldi r24,hi8(tapping_key)
 454 009c B82E      		mov r11,r24
 455 009e 8091 0000 		lds r24,tapping_key+5
 456 00a2 982F      		mov r25,r24
 457 00a4 907F      		andi r25,lo8(-16)
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 458               		.loc 1 85 12 view .LVU86
 459 00a6 F110      		cpse r15,__zero_reg__
 460 00a8 00C0      		rjmp .L69
 185:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 461               		.loc 1 185 13 is_stmt 1 view .LVU87
 185:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 462               		.loc 1 185 16 is_stmt 0 view .LVU88
 463 00aa 01F0      		breq .+2
 464 00ac 00C0      		rjmp .L51
 465               	.LBB77:
 186:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 466               		.loc 1 186 61 is_stmt 1 view .LVU89
 187:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 467               		.loc 1 187 17 view .LVU90
 468 00ae 4F81      		ldd r20,Y+7
 469 00b0 5885      		ldd r21,Y+8
 470 00b2 6985      		ldd r22,Y+9
 471 00b4 7A85      		ldd r23,Y+10
 472 00b6 8B85      		ldd r24,Y+11
 473 00b8 0E94 0000 		call debug_event
 474               	.LVL29:
 187:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 475               		.loc 1 187 48 view .LVU91
 188:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 476               		.loc 1 188 17 view .LVU92
 477 00bc 80E0      		ldi r24,lo8(tapping_key)
 478 00be 90E0      		ldi r25,hi8(tapping_key)
 479 00c0 0E94 0000 		call process_record
 480               	.LVL30:
 189:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 481               		.loc 1 189 17 view .LVU93
 189:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 482               		.loc 1 189 29 is_stmt 0 view .LVU94
 483 00c4 86E0      		ldi r24,lo8(6)
 484 00c6 D501      		movw r26,r10
 485               		0:
 486 00c8 1D92      		st X+,__zero_reg__
 487 00ca 8A95      		dec r24
 488 00cc 01F4      		brne 0b
 489               	.L125:
 190:./tmk_core/common/action_tapping.c ****                 return false;
 490               		.loc 1 190 17 is_stmt 1 view .LVU95
 491 00ce 0E94 0000 		call debug_tapping_key
 492               	.LVL31:
 191:./tmk_core/common/action_tapping.c ****             }  else {
 493               		.loc 1 191 17 view .LVU96
 494 00d2 00C0      		rjmp .L26
 495               	.LVL32:
 496               	.L29:
 191:./tmk_core/common/action_tapping.c ****             }  else {
 497               		.loc 1 191 17 is_stmt 0 view .LVU97
 498               	.LBE77:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 499               		.loc 1 85 13 discriminator 2 view .LVU98
 500 00d4 0197      		sbiw r24,1
 501 00d6 00C0      		rjmp .L123
 502               	.L69:
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 503               		.loc 1 86 13 is_stmt 1 view .LVU99
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 504               		.loc 1 86 16 is_stmt 0 view .LVU100
 505 00d8 9111      		cpse r25,__zero_reg__
 506 00da 00C0      		rjmp .L33
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 507               		.loc 1 87 17 is_stmt 1 view .LVU101
 508               	.LVL33:
 509               	.LBB78:
 510               	.LBB79:
  50:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:./tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 511               		.loc 2 51 88 is_stmt 0 view .LVU102
 512 00dc FE2C      		mov r15,r14
 513               	.LVL34:
 514               		.loc 2 51 88 view .LVU103
 515               	.LBE79:
 516               	.LBE78:
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 517               		.loc 1 87 21 view .LVU104
 518 00de 2513      		cpse r18,r21
 519 00e0 00C0      		rjmp .L34
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 520               		.loc 1 87 21 discriminator 2 view .LVU105
 521 00e2 4313      		cpse r20,r19
 522 00e4 00C0      		rjmp .L34
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 523               		.loc 1 87 47 discriminator 3 view .LVU106
 524 00e6 E110      		cpse r14,__zero_reg__
 525 00e8 00C0      		rjmp .L34
  89:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 526               		.loc 1 89 57 is_stmt 1 view .LVU107
  90:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 527               		.loc 1 90 21 view .LVU108
  90:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 528               		.loc 1 90 43 is_stmt 0 view .LVU109
 529 00ea 8F70      		andi r24,lo8(15)
 530 00ec 8061      		ori r24,lo8(16)
 531 00ee 8093 0000 		sts tapping_key+5,r24
  91:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 532               		.loc 1 91 21 is_stmt 1 view .LVU110
 533 00f2 0E94 0000 		call debug_tapping_key
 534               	.LVL35:
  92:./tmk_core/common/action_tapping.c **** 
 535               		.loc 1 92 21 view .LVU111
 536 00f6 80E0      		ldi r24,lo8(tapping_key)
 537 00f8 90E0      		ldi r25,hi8(tapping_key)
 538 00fa 0E94 0000 		call process_record
 539               	.LVL36:
  95:./tmk_core/common/action_tapping.c ****                     // enqueue
 540               		.loc 1 95 21 view .LVU112
  95:./tmk_core/common/action_tapping.c ****                     // enqueue
 541               		.loc 1 95 31 is_stmt 0 view .LVU113
 542 00fe 8091 0000 		lds r24,tapping_key+5
 543 0102 F801      		movw r30,r16
 544 0104 8583      		std Z+5,r24
  97:./tmk_core/common/action_tapping.c ****                 }
 545               		.loc 1 97 21 is_stmt 1 view .LVU114
 546               	.LVL37:
 547               	.L26:
 287:./tmk_core/common/action_tapping.c **** 
 548               		.loc 1 287 1 is_stmt 0 view .LVU115
 549 0106 8F2D      		mov r24,r15
 550               	/* epilogue start */
 287:./tmk_core/common/action_tapping.c **** 
 551               		.loc 1 287 1 view .LVU116
 552 0108 2B96      		adiw r28,11
 553 010a 0FB6      		in __tmp_reg__,__SREG__
 554 010c F894      		cli
 555 010e DEBF      		out __SP_H__,r29
 556 0110 0FBE      		out __SREG__,__tmp_reg__
 557 0112 CDBF      		out __SP_L__,r28
 558 0114 DF91      		pop r29
 559 0116 CF91      		pop r28
 560 0118 1F91      		pop r17
 561 011a 0F91      		pop r16
 562               	.LVL38:
 287:./tmk_core/common/action_tapping.c **** 
 563               		.loc 1 287 1 view .LVU117
 564 011c FF90      		pop r15
 565 011e EF90      		pop r14
 566               	.LVL39:
 287:./tmk_core/common/action_tapping.c **** 
 567               		.loc 1 287 1 view .LVU118
 568 0120 DF90      		pop r13
 569 0122 CF90      		pop r12
 570               	.LVL40:
 287:./tmk_core/common/action_tapping.c **** 
 571               		.loc 1 287 1 view .LVU119
 572 0124 BF90      		pop r11
 573 0126 AF90      		pop r10
 574 0128 9F90      		pop r9
 575 012a 0895      		ret
 576               	.LVL41:
 577               	.L34:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 578               		.loc 1 117 22 is_stmt 1 view .LVU120
 579               	.LBB84:
 580               	.LBI78:
 581               		.loc 2 51 20 view .LVU121
 582               	.LBB82:
 583               		.loc 2 51 52 view .LVU122
 584               	.LBB80:
 585               	.LBI80:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 586               		.loc 2 49 20 view .LVU123
 587               	.LBB81:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 588               		.loc 2 49 51 view .LVU124
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 589               		.loc 2 49 74 is_stmt 0 view .LVU125
 590 012c CD28      		or r12,r13
 591 012e 01F0      		breq .L71
 592 0130 822F      		mov r24,r18
 593 0132 8323      		and r24,r19
 594 0134 8F3F      		cpi r24,lo8(-1)
 595 0136 01F0      		breq .+2
 596 0138 00C0      		rjmp .L37
 597               	.L71:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 598               		.loc 2 49 74 view .LVU126
 599               	.LBE81:
 600               	.LBE80:
 601               		.loc 2 51 79 view .LVU127
 602 013a 80E0      		ldi r24,0
 603               	.LVL42:
 604               	.L36:
 605               		.loc 2 51 79 view .LVU128
 606               	.LBE82:
 607               	.LBE84:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 608               		.loc 1 117 25 view .LVU129
 609 013c F82F      		mov r31,r24
 610 013e F170      		andi r31,lo8(1)
 611 0140 DF2E      		mov r13,r31
 612               	.LBB85:
 613               	.LBB86:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 614               		.loc 1 319 18 view .LVU130
 615 0142 E091 0000 		lds r30,waiting_buffer_tail
 616               	.LVL43:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 617               		.loc 1 319 45 view .LVU131
 618 0146 4091 0000 		lds r20,waiting_buffer_head
 320:./tmk_core/common/action_tapping.c ****             return true;
 619               		.loc 1 320 13 view .LVU132
 620 014a 56E0      		ldi r21,lo8(6)
 621               	.LBE86:
 622               	.LBE85:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 623               		.loc 1 117 25 view .LVU133
 624 014c 80FD      		sbrc r24,0
 625 014e 00C0      		rjmp .L39
 626               	.LVL44:
 627               	.L38:
 139:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 628               		.loc 1 139 21 is_stmt 1 view .LVU134
 139:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 629               		.loc 1 139 24 is_stmt 0 view .LVU135
 630 0150 EE20      		tst r14
 631 0152 01F0      		breq .L26
 140:./tmk_core/common/action_tapping.c ****                     }
 632               		.loc 1 140 25 is_stmt 1 view .LVU136
 140:./tmk_core/common/action_tapping.c ****                     }
 633               		.loc 1 140 53 is_stmt 0 view .LVU137
 634 0154 8091 0000 		lds r24,tapping_key+5
 635 0158 8160      		ori r24,lo8(1<<0)
 636 015a 8093 0000 		sts tapping_key+5,r24
 637               	.LVL45:
 638               	.L124:
 639               	.LBB88:
 271:./tmk_core/common/action_tapping.c ****         }
 640               		.loc 1 271 13 is_stmt 1 view .LVU138
 271:./tmk_core/common/action_tapping.c ****         }
 641               		.loc 1 271 20 is_stmt 0 view .LVU139
 642 015e F12C      		mov r15,__zero_reg__
 643 0160 00C0      		rjmp .L26
 644               	.LVL46:
 645               	.L41:
 271:./tmk_core/common/action_tapping.c ****         }
 646               		.loc 1 271 20 view .LVU140
 647               	.LBE88:
 648               	.LBB89:
 649               	.LBB87:
 320:./tmk_core/common/action_tapping.c ****             return true;
 650               		.loc 1 320 9 is_stmt 1 view .LVU141
 320:./tmk_core/common/action_tapping.c ****             return true;
 651               		.loc 1 320 13 is_stmt 0 view .LVU142
 652 0162 8E2F      		mov r24,r30
 653 0164 90E0      		ldi r25,0
 654 0166 5E9F      		mul r21,r30
 655 0168 F001      		movw r30,r0
 656 016a 1124      		clr __zero_reg__
 657               	.LVL47:
 320:./tmk_core/common/action_tapping.c ****             return true;
 658               		.loc 1 320 13 view .LVU143
 659 016c E050      		subi r30,lo8(-(waiting_buffer))
 660 016e F040      		sbci r31,hi8(-(waiting_buffer))
 320:./tmk_core/common/action_tapping.c ****             return true;
 661               		.loc 1 320 12 view .LVU144
 662 0170 6181      		ldd r22,Z+1
 663 0172 2613      		cpse r18,r22
 664 0174 00C0      		rjmp .L40
 320:./tmk_core/common/action_tapping.c ****             return true;
 665               		.loc 1 320 13 view .LVU145
 666 0176 6081      		ld r22,Z
 667 0178 3613      		cpse r19,r22
 668 017a 00C0      		rjmp .L40
 320:./tmk_core/common/action_tapping.c ****             return true;
 669               		.loc 1 320 59 view .LVU146
 670 017c 6281      		ldd r22,Z+2
 671 017e E612      		cpse r14,r22
 672 0180 00C0      		rjmp .L38
 673               	.L40:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 674               		.loc 1 319 71 is_stmt 1 view .LVU147
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 675               		.loc 1 319 76 is_stmt 0 view .LVU148
 676 0182 0196      		adiw r24,1
 677               	.LVL48:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 678               		.loc 1 319 71 view .LVU149
 679 0184 E82F      		mov r30,r24
 680 0186 E770      		andi r30,lo8(7)
 681               	.L39:
 682               	.LVL49:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 683               		.loc 1 319 45 is_stmt 1 view .LVU150
 684 0188 E413      		cpse r30,r20
 685 018a 00C0      		rjmp .L41
 686               	.LVL50:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 687               		.loc 1 319 45 is_stmt 0 view .LVU151
 688               	.LBE87:
 689               	.LBE89:
 690               	.LBB90:
 119:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 691               		.loc 1 119 21 is_stmt 1 view .LVU152
 119:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 692               		.loc 1 119 39 is_stmt 0 view .LVU153
 693 018c 8F81      		ldd r24,Y+7
 694 018e 9885      		ldd r25,Y+8
 695 0190 0E94 0000 		call layer_switch_get_action
 696               	.LVL51:
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 697               		.loc 1 120 21 is_stmt 1 view .LVU154
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 698               		.loc 1 120 40 is_stmt 0 view .LVU155
 699 0194 292F      		mov r18,r25
 700 0196 2295      		swap r18
 701 0198 2F70      		andi r18,lo8(15)
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 702               		.loc 1 120 21 view .LVU156
 703 019a 9032      		cpi r25,lo8(32)
 704 019c 00F0      		brlo .L62
 705 019e 225F      		subi r18,lo8(-(14))
 706 01a0 2F70      		andi r18,lo8(15)
 707 01a2 2230      		cpi r18,lo8(2)
 708 01a4 00F4      		brsh .L45
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 709               		.loc 1 128 29 is_stmt 1 view .LVU157
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 710               		.loc 1 128 33 is_stmt 0 view .LVU158
 711 01a6 9F70      		andi r25,lo8(15)
 712               	.LVL52:
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 713               		.loc 1 128 32 view .LVU159
 714 01a8 01F0      		breq .L46
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 715               		.loc 1 128 68 discriminator 1 view .LVU160
 716 01aa D801      		movw r26,r16
 717 01ac 1596      		adiw r26,5
 718 01ae 9C91      		ld r25,X
 719 01b0 907F      		andi r25,lo8(-16)
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 720               		.loc 1 128 49 discriminator 1 view .LVU161
 721 01b2 01F4      		brne .L46
 722               	.LVL53:
 723               	.L75:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 724               		.loc 1 123 77 view .LVU162
 725 01b4 D12C      		mov r13,__zero_reg__
 726 01b6 00C0      		rjmp .L44
 727               	.LVL54:
 728               	.L62:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 729               		.loc 1 123 29 is_stmt 1 view .LVU163
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 730               		.loc 1 123 33 is_stmt 0 view .LVU164
 731 01b8 9F70      		andi r25,lo8(15)
 732               	.LVL55:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 733               		.loc 1 123 32 view .LVU165
 734 01ba 01F0      		breq .L46
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 735               		.loc 1 123 49 discriminator 1 view .LVU166
 736 01bc 8823      		tst r24
 737 01be 01F0      		breq .L75
 738               	.L46:
 129:./tmk_core/common/action_tapping.c ****                             break;
 739               		.loc 1 129 29 is_stmt 1 view .LVU167
 129:./tmk_core/common/action_tapping.c ****                             break;
 740               		.loc 1 129 33 is_stmt 0 view .LVU168
 741 01c0 805E      		subi r24,lo8(-(32))
 742               	.LVL56:
 129:./tmk_core/common/action_tapping.c ****                             break;
 743               		.loc 1 129 32 view .LVU169
 744 01c2 8830      		cpi r24,lo8(8)
 745 01c4 00F0      		brlo .L75
 746               	.LVL57:
 747               	.L45:
 133:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 748               		.loc 1 133 86 is_stmt 1 view .LVU170
 134:./tmk_core/common/action_tapping.c ****                     return true;
 749               		.loc 1 134 21 view .LVU171
 750 01c6 C801      		movw r24,r16
 751               	.LVL58:
 134:./tmk_core/common/action_tapping.c ****                     return true;
 752               		.loc 1 134 21 is_stmt 0 view .LVU172
 753 01c8 0E94 0000 		call process_record
 754               	.LVL59:
 135:./tmk_core/common/action_tapping.c ****                 }
 755               		.loc 1 135 21 is_stmt 1 view .LVU173
 756               	.L44:
 135:./tmk_core/common/action_tapping.c ****                 }
 757               		.loc 1 135 21 is_stmt 0 view .LVU174
 758 01cc FD2C      		mov r15,r13
 759 01ce 00C0      		rjmp .L26
 760               	.LVL60:
 761               	.L54:
 135:./tmk_core/common/action_tapping.c ****                 }
 762               		.loc 1 135 21 view .LVU175
 763               	.LBE90:
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 764               		.loc 1 228 13 discriminator 2 view .LVU176
 765 01d0 0197      		sbiw r24,1
 766 01d2 00C0      		rjmp .L121
 767               	.L60:
 242:./tmk_core/common/action_tapping.c ****                         return true;
 768               		.loc 1 242 25 is_stmt 1 view .LVU177
 242:./tmk_core/common/action_tapping.c ****                         return true;
 769               		.loc 1 242 37 is_stmt 0 view .LVU178
 770 01d4 86E0      		ldi r24,lo8(6)
 771 01d6 F801      		movw r30,r16
 772 01d8 A0E0      		ldi r26,lo8(tapping_key)
 773 01da B0E0      		ldi r27,hi8(tapping_key)
 774               		0:
 775 01dc 0190      		ld r0,Z+
 776 01de 0D92      		st X+,r0
 777 01e0 8A95      		dec r24
 778 01e2 01F4      		brne 0b
 243:./tmk_core/common/action_tapping.c ****                     }
 779               		.loc 1 243 25 is_stmt 1 view .LVU179
 243:./tmk_core/common/action_tapping.c ****                     }
 780               		.loc 1 243 32 is_stmt 0 view .LVU180
 781 01e4 00C0      		rjmp .L26
 782               	.L59:
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 783               		.loc 1 245 24 is_stmt 1 view .LVU181
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 784               		.loc 1 245 28 is_stmt 0 view .LVU182
 785 01e6 8F81      		ldd r24,Y+7
 786 01e8 9885      		ldd r25,Y+8
 787 01ea 0E94 0000 		call is_tap_key
 788               	.LVL61:
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 789               		.loc 1 245 27 view .LVU183
 790 01ee 8111      		cpse r24,__zero_reg__
 791 01f0 00C0      		rjmp .L50
 255:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 792               		.loc 1 255 21 is_stmt 1 view .LVU184
 255:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 793               		.loc 1 255 49 is_stmt 0 view .LVU185
 794 01f2 8091 0000 		lds r24,tapping_key+5
 795 01f6 8160      		ori r24,lo8(1<<0)
 796 01f8 8093 0000 		sts tapping_key+5,r24
 256:./tmk_core/common/action_tapping.c ****                     return true;
 797               		.loc 1 256 21 is_stmt 1 view .LVU186
 798 01fc C801      		movw r24,r16
 799 01fe 0E94 0000 		call process_record
 800               	.LVL62:
 257:./tmk_core/common/action_tapping.c ****                 }
 801               		.loc 1 257 21 view .LVU187
 257:./tmk_core/common/action_tapping.c ****                 }
 802               		.loc 1 257 28 is_stmt 0 view .LVU188
 803 0202 00C0      		rjmp .L26
 804               	.LVL63:
 805               	.L56:
 806               	.LBB91:
 267:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 807               		.loc 1 267 70 is_stmt 1 view .LVU189
 268:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 808               		.loc 1 268 13 view .LVU190
 809 0204 4F81      		ldd r20,Y+7
 810 0206 5885      		ldd r21,Y+8
 811 0208 6985      		ldd r22,Y+9
 812 020a 7A85      		ldd r23,Y+10
 813 020c 8B85      		ldd r24,Y+11
 814 020e 0E94 0000 		call debug_event
 815               	.LVL64:
 268:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 816               		.loc 1 268 44 view .LVU191
 269:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 817               		.loc 1 269 13 view .LVU192
 269:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 818               		.loc 1 269 25 is_stmt 0 view .LVU193
 819 0212 86E0      		ldi r24,lo8(6)
 820 0214 E0E0      		ldi r30,lo8(tapping_key)
 821 0216 F0E0      		ldi r31,hi8(tapping_key)
 822 0218 DF01      		movw r26,r30
 823               		0:
 824 021a 1D92      		st X+,__zero_reg__
 825 021c 8A95      		dec r24
 826 021e 01F4      		brne 0b
 270:./tmk_core/common/action_tapping.c ****             return false;
 827               		.loc 1 270 13 is_stmt 1 view .LVU194
 828 0220 0E94 0000 		call debug_tapping_key
 829               	.LVL65:
 830 0224 00C0      		rjmp .L124
 831               	.LVL66:
 832               	.L37:
 270:./tmk_core/common/action_tapping.c ****             return false;
 833               		.loc 1 270 13 is_stmt 0 view .LVU195
 834               	.LBE91:
 835               	.LBB92:
 836               	.LBB83:
 837               		.loc 2 51 79 view .LVU196
 838 0226 81E0      		ldi r24,lo8(1)
 839 0228 8E25      		eor r24,r14
 840 022a 00C0      		rjmp .L36
 841               	.LVL67:
 842               	.L33:
 843               		.loc 2 51 79 view .LVU197
 844               	.LBE83:
 845               	.LBE92:
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 846               		.loc 1 148 17 is_stmt 1 view .LVU198
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 847               		.loc 1 148 21 is_stmt 0 view .LVU199
 848 022c 2513      		cpse r18,r21
 849 022e 00C0      		rjmp .L47
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 850               		.loc 1 148 21 discriminator 2 view .LVU200
 851 0230 4313      		cpse r20,r19
 852 0232 00C0      		rjmp .L47
 150:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 853               		.loc 1 150 31 discriminator 3 view .LVU201
 854 0234 F801      		movw r30,r16
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 855               		.loc 1 148 47 discriminator 3 view .LVU202
 856 0236 EE20      		tst r14
 857 0238 01F4      		brne .+2
 858 023a 00C0      		rjmp .L129
 859               	.L47:
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 860               		.loc 1 156 22 is_stmt 1 view .LVU203
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 861               		.loc 1 156 26 is_stmt 0 view .LVU204
 862 023c 8F81      		ldd r24,Y+7
 863 023e 9885      		ldd r25,Y+8
 864 0240 0E94 0000 		call is_tap_key
 865               	.LVL68:
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 866               		.loc 1 156 25 view .LVU205
 867 0244 8823      		tst r24
 868 0246 01F4      		brne .+2
 869 0248 00C0      		rjmp .L58
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 870               		.loc 1 156 48 discriminator 1 view .LVU206
 871 024a EE20      		tst r14
 872 024c 01F4      		brne .+2
 873 024e 00C0      		rjmp .L58
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 874               		.loc 1 157 21 is_stmt 1 view .LVU207
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 875               		.loc 1 157 40 is_stmt 0 view .LVU208
 876 0250 8091 0000 		lds r24,tapping_key+5
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 877               		.loc 1 157 24 view .LVU209
 878 0254 8032      		cpi r24,lo8(32)
 879 0256 00F0      		brlo .L50
 880               	.LBB93:
 158:./tmk_core/common/action_tapping.c ****                         // unregister key
 881               		.loc 1 158 87 is_stmt 1 view .LVU210
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 882               		.loc 1 160 25 view .LVU211
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 883               		.loc 1 160 54 is_stmt 0 view .LVU212
 884 0258 2091 0000 		lds r18,tapping_key
 885 025c 3091 0000 		lds r19,tapping_key+1
 886 0260 3A83      		std Y+2,r19
 887 0262 2983      		std Y+1,r18
 888 0264 1B82      		std Y+3,__zero_reg__
 889 0266 DD82      		std Y+5,r13
 890 0268 CC82      		std Y+4,r12
 891 026a 8E83      		std Y+6,r24
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 892               		.loc 1 160 25 view .LVU213
 893 026c CE01      		movw r24,r28
 894 026e 0196      		adiw r24,1
 895 0270 0E94 0000 		call process_record
 896               	.LVL69:
 897               	.L50:
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 898               		.loc 1 160 25 view .LVU214
 899               	.LBE93:
 167:./tmk_core/common/action_tapping.c ****                     }
 900               		.loc 1 167 69 is_stmt 1 view .LVU215
 169:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 901               		.loc 1 169 21 view .LVU216
 169:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 902               		.loc 1 169 33 is_stmt 0 view .LVU217
 903 0274 86E0      		ldi r24,lo8(6)
 904 0276 F801      		movw r30,r16
 905 0278 A0E0      		ldi r26,lo8(tapping_key)
 906 027a B0E0      		ldi r27,hi8(tapping_key)
 907               		0:
 908 027c 0190      		ld r0,Z+
 909 027e 0D92      		st X+,r0
 910 0280 8A95      		dec r24
 911 0282 01F4      		brne 0b
 170:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 912               		.loc 1 170 21 is_stmt 1 view .LVU218
 913 0284 0E94 0000 		call waiting_buffer_scan_tap
 914               	.LVL70:
 171:./tmk_core/common/action_tapping.c ****                     return true;
 915               		.loc 1 171 21 view .LVU219
 916 0288 0E94 0000 		call debug_tapping_key
 917               	.LVL71:
 172:./tmk_core/common/action_tapping.c ****                 }
 918               		.loc 1 172 21 view .LVU220
 919               	.L126:
 179:./tmk_core/common/action_tapping.c ****                 }
 920               		.loc 1 179 21 view .LVU221
 179:./tmk_core/common/action_tapping.c ****                 }
 921               		.loc 1 179 28 is_stmt 0 view .LVU222
 922 028c FF24      		clr r15
 923 028e F394      		inc r15
 924 0290 00C0      		rjmp .L26
 925               	.LVL72:
 926               	.L51:
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 927               		.loc 1 193 17 is_stmt 1 view .LVU223
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 928               		.loc 1 193 21 is_stmt 0 view .LVU224
 929 0292 2513      		cpse r18,r21
 930 0294 00C0      		rjmp .L47
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 931               		.loc 1 193 21 discriminator 2 view .LVU225
 932 0296 4313      		cpse r20,r19
 933 0298 00C0      		rjmp .L47
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 934               		.loc 1 193 47 discriminator 3 view .LVU226
 935 029a E110      		cpse r14,__zero_reg__
 936 029c 00C0      		rjmp .L47
 937               	.LBB94:
 194:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 938               		.loc 1 194 73 is_stmt 1 view .LVU227
 195:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 939               		.loc 1 195 21 view .LVU228
 195:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 940               		.loc 1 195 31 is_stmt 0 view .LVU229
 941 029e F801      		movw r30,r16
 942 02a0 8583      		std Z+5,r24
 196:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 943               		.loc 1 196 21 is_stmt 1 view .LVU230
 944 02a2 C801      		movw r24,r16
 945 02a4 0E94 0000 		call process_record
 946               	.LVL73:
 197:./tmk_core/common/action_tapping.c ****                     return true;
 947               		.loc 1 197 21 view .LVU231
 197:./tmk_core/common/action_tapping.c ****                     return true;
 948               		.loc 1 197 33 is_stmt 0 view .LVU232
 949 02a8 86E0      		ldi r24,lo8(6)
 950 02aa D501      		movw r26,r10
 951               		0:
 952 02ac 1D92      		st X+,__zero_reg__
 953 02ae 8A95      		dec r24
 954 02b0 01F4      		brne 0b
 198:./tmk_core/common/action_tapping.c ****                 }
 955               		.loc 1 198 21 is_stmt 1 view .LVU233
 198:./tmk_core/common/action_tapping.c ****                 }
 956               		.loc 1 198 28 is_stmt 0 view .LVU234
 957 02b2 F92C      		mov r15,r9
 958 02b4 00C0      		rjmp .L26
 959               	.LVL74:
 960               	.L57:
 198:./tmk_core/common/action_tapping.c ****                 }
 961               		.loc 1 198 28 view .LVU235
 962               	.LBE94:
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 963               		.loc 1 230 17 is_stmt 1 view .LVU236
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 964               		.loc 1 230 21 is_stmt 0 view .LVU237
 965 02b6 2513      		cpse r18,r21
 966 02b8 00C0      		rjmp .L59
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 967               		.loc 1 230 21 discriminator 2 view .LVU238
 968 02ba 4313      		cpse r20,r19
 969 02bc 00C0      		rjmp .L59
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 970               		.loc 1 231 21 is_stmt 1 view .LVU239
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 971               		.loc 1 231 41 is_stmt 0 view .LVU240
 972 02be 8091 0000 		lds r24,tapping_key+5
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 973               		.loc 1 231 24 view .LVU241
 974 02c2 80FD      		sbrc r24,0
 975 02c4 00C0      		rjmp .L60
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 976               		.loc 1 231 79 discriminator 1 view .LVU242
 977 02c6 982F      		mov r25,r24
 978 02c8 907F      		andi r25,lo8(-16)
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 979               		.loc 1 231 54 discriminator 1 view .LVU243
 980 02ca 01F4      		brne .+2
 981 02cc 00C0      		rjmp .L60
 233:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 982               		.loc 1 233 25 is_stmt 1 view .LVU244
 233:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 983               		.loc 1 233 35 is_stmt 0 view .LVU245
 984 02ce F801      		movw r30,r16
 985 02d0 8583      		std Z+5,r24
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 986               		.loc 1 234 25 is_stmt 1 view .LVU246
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 987               		.loc 1 234 28 is_stmt 0 view .LVU247
 988 02d2 903F      		cpi r25,lo8(-16)
 989 02d4 01F0      		breq .L61
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 990               		.loc 1 234 51 is_stmt 1 discriminator 1 view .LVU248
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 991               		.loc 1 234 67 is_stmt 0 discriminator 1 view .LVU249
 992 02d6 982F      		mov r25,r24
 993 02d8 907F      		andi r25,lo8(-16)
 994 02da 905F      		subi r25,lo8(-(16))
 995 02dc 8F70      		andi r24,lo8(15)
 996 02de 892B      		or r24,r25
 997               	.L129:
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 998               		.loc 1 234 67 discriminator 1 view .LVU250
 999 02e0 8583      		std Z+5,r24
 1000               	.L61:
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1001               		.loc 1 235 53 is_stmt 1 view .LVU251
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1002               		.loc 1 235 81 view .LVU252
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1003               		.loc 1 235 95 view .LVU253
 236:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 1004               		.loc 1 236 25 view .LVU254
 1005 02e2 C801      		movw r24,r16
 1006 02e4 0E94 0000 		call process_record
 1007               	.LVL75:
 237:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1008               		.loc 1 237 25 view .LVU255
 237:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1009               		.loc 1 237 37 is_stmt 0 view .LVU256
 1010 02e8 86E0      		ldi r24,lo8(6)
 1011 02ea F801      		movw r30,r16
 1012 02ec A0E0      		ldi r26,lo8(tapping_key)
 1013 02ee B0E0      		ldi r27,hi8(tapping_key)
 1014               		0:
 1015 02f0 0190      		ld r0,Z+
 1016 02f2 0D92      		st X+,r0
 1017 02f4 8A95      		dec r24
 1018 02f6 01F4      		brne 0b
 238:./tmk_core/common/action_tapping.c ****                         return true;
 1019               		.loc 1 238 25 is_stmt 1 view .LVU257
 1020 02f8 00C0      		rjmp .L125
 1021               	.LVL76:
 1022               	.L115:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 1023               		.loc 1 84 9 is_stmt 0 view .LVU258
 1024 02fa 9090 0000 		lds r9,tapping_key+2
 1025 02fe C601      		movw r24,r12
 1026 0300 861B      		sub r24,r22
 1027 0302 970B      		sbc r25,r23
 1028 0304 9110      		cpse r9,__zero_reg__
 1029 0306 00C0      		rjmp .L67
 227:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 1030               		.loc 1 227 12 is_stmt 1 view .LVU259
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1031               		.loc 1 228 9 view .LVU260
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1032               		.loc 1 228 13 is_stmt 0 view .LVU261
 1033 0308 C616      		cp r12,r22
 1034 030a D706      		cpc r13,r23
 1035 030c 00F4      		brsh .+2
 1036 030e 00C0      		rjmp .L54
 1037               	.L121:
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1038               		.loc 1 228 12 discriminator 2 view .LVU262
 1039 0310 883C      		cpi r24,-56
 1040 0312 9105      		cpc r25,__zero_reg__
 1041 0314 00F0      		brlo .+2
 1042 0316 00C0      		rjmp .L56
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 1043               		.loc 1 229 13 is_stmt 1 view .LVU263
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 1044               		.loc 1 229 22 is_stmt 0 view .LVU264
 1045 0318 FE2C      		mov r15,r14
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 1046               		.loc 1 229 16 view .LVU265
 1047 031a E110      		cpse r14,__zero_reg__
 1048 031c 00C0      		rjmp .L57
 1049               	.LVL77:
 1050               	.L58:
 175:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 1051               		.loc 1 175 21 is_stmt 1 view .LVU266
 176:./tmk_core/common/action_tapping.c ****                     }
 1052               		.loc 1 176 74 view .LVU267
 178:./tmk_core/common/action_tapping.c ****                     return true;
 1053               		.loc 1 178 21 view .LVU268
 1054 031e C801      		movw r24,r16
 1055 0320 0E94 0000 		call process_record
 1056               	.LVL78:
 1057 0324 00C0      		rjmp .L126
 1058               		.cfi_endproc
 1059               	.LFE5:
 1061               		.section	.text.action_tapping_process,"ax",@progbits
 1062               	.global	action_tapping_process
 1064               	action_tapping_process:
 1065               	.LFB4:
  40:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1066               		.loc 1 40 1 view -0
 1067               		.cfi_startproc
 1068 0000 1F93      		push r17
 1069               	.LCFI17:
 1070               		.cfi_def_cfa_offset 3
 1071               		.cfi_offset 17, -2
 1072 0002 CF93      		push r28
 1073               	.LCFI18:
 1074               		.cfi_def_cfa_offset 4
 1075               		.cfi_offset 28, -3
 1076 0004 DF93      		push r29
 1077               	.LCFI19:
 1078               		.cfi_def_cfa_offset 5
 1079               		.cfi_offset 29, -4
 1080 0006 CDB7      		in r28,__SP_L__
 1081 0008 DEB7      		in r29,__SP_H__
 1082               	.LCFI20:
 1083               		.cfi_def_cfa_register 28
 1084 000a 2C97      		sbiw r28,12
 1085               	.LCFI21:
 1086               		.cfi_def_cfa_offset 17
 1087 000c 0FB6      		in __tmp_reg__,__SREG__
 1088 000e F894      		cli
 1089 0010 DEBF      		out __SP_H__,r29
 1090 0012 0FBE      		out __SREG__,__tmp_reg__
 1091 0014 CDBF      		out __SP_L__,r28
 1092               	/* prologue: function */
 1093               	/* frame size = 12 */
 1094               	/* stack size = 15 */
 1095               	.L__stack_usage = 15
 1096 0016 4F83      		std Y+7,r20
 1097 0018 5887      		std Y+8,r21
 1098 001a 6987      		std Y+9,r22
 1099 001c 7A87      		std Y+10,r23
 1100 001e 8B87      		std Y+11,r24
 1101 0020 9C87      		std Y+12,r25
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1102               		.loc 1 41 5 view .LVU270
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1103               		.loc 1 41 9 is_stmt 0 view .LVU271
 1104 0022 CE01      		movw r24,r28
 1105 0024 0796      		adiw r24,7
 1106 0026 0E94 0000 		call process_tapping
 1107               	.LVL79:
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1108               		.loc 1 41 8 view .LVU272
 1109 002a 8823      		tst r24
 1110 002c 01F0      		breq .L134
  42:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1111               		.loc 1 42 9 is_stmt 1 view .LVU273
 1112               	.LVL80:
 1113               	.LBB104:
 1114               	.LBI104:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1115               		.loc 2 49 20 view .LVU274
 1116               	.LBB105:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1117               		.loc 2 49 51 view .LVU275
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1118               		.loc 2 49 74 is_stmt 0 view .LVU276
 1119 002e 8A85      		ldd r24,Y+10
 1120 0030 9B85      		ldd r25,Y+11
 1121 0032 892B      		or r24,r25
 1122 0034 01F0      		breq .L135
 1123 0036 5885      		ldd r21,Y+8
 1124 0038 4F81      		ldd r20,Y+7
 1125 003a 852F      		mov r24,r21
 1126 003c 8423      		and r24,r20
 1127 003e 8F3F      		cpi r24,lo8(-1)
 1128 0040 01F0      		breq .+2
 1129 0042 00C0      		rjmp .L157
 1130               	.LVL81:
 1131               	.L135:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1132               		.loc 2 49 74 view .LVU277
 1133               	.LBE105:
 1134               	.LBE104:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1135               		.loc 1 60 13 discriminator 1 view .LVU278
 1136 0044 16E0      		ldi r17,lo8(6)
 1137 0046 00C0      		rjmp .L142
 1138               	.L134:
  46:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1139               		.loc 1 46 9 is_stmt 1 view .LVU279
 1140 0048 86E0      		ldi r24,lo8(6)
 1141 004a FE01      		movw r30,r28
 1142 004c 3796      		adiw r30,7
 1143 004e DE01      		movw r26,r28
 1144 0050 1196      		adiw r26,1
 1145               		0:
 1146 0052 0190      		ld r0,Z+
 1147 0054 0D92      		st X+,r0
 1148 0056 8A95      		dec r24
 1149 0058 01F4      		brne 0b
 1150 005a 8F81      		ldd r24,Y+7
 1151               	.LVL82:
  46:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1152               		.loc 1 46 9 is_stmt 0 view .LVU280
 1153 005c 9885      		ldd r25,Y+8
 1154               	.LVL83:
 1155               	.LBB106:
 1156               	.LBI106:
 293:./tmk_core/common/action_tapping.c **** {
 1157               		.loc 1 293 6 is_stmt 1 view .LVU281
 1158               	.LBB107:
 295:./tmk_core/common/action_tapping.c ****         return true;
 1159               		.loc 1 295 5 view .LVU282
 1160               	.LBB108:
 1161               	.LBI108:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1162               		.loc 2 49 20 view .LVU283
 1163               	.LBB109:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1164               		.loc 2 49 51 view .LVU284
 1165               	.LBE109:
 1166               	.LBE108:
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1167               		.loc 1 299 30 is_stmt 0 view .LVU285
 1168 005e 2091 0000 		lds r18,waiting_buffer_head
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1169               		.loc 1 299 57 view .LVU286
 1170 0062 4091 0000 		lds r20,waiting_buffer_tail
 1171               	.LBB111:
 1172               	.LBB110:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1173               		.loc 2 49 74 view .LVU287
 1174 0066 6A85      		ldd r22,Y+10
 1175 0068 7B85      		ldd r23,Y+11
 1176 006a 672B      		or r22,r23
 1177 006c 01F0      		breq .L135
 1178 006e 8923      		and r24,r25
 1179               	.LVL84:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1180               		.loc 2 49 74 view .LVU288
 1181 0070 8F3F      		cpi r24,lo8(-1)
 1182 0072 01F0      		breq .L135
 1183               	.LVL85:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1184               		.loc 2 49 74 view .LVU289
 1185               	.LBE110:
 1186               	.LBE111:
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1187               		.loc 1 299 5 is_stmt 1 view .LVU290
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1188               		.loc 1 299 30 is_stmt 0 view .LVU291
 1189 0074 30E0      		ldi r19,0
 1190 0076 C901      		movw r24,r18
 1191 0078 0196      		adiw r24,1
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1192               		.loc 1 299 35 view .LVU292
 1193 007a 8770      		andi r24,7
 1194 007c 9927      		clr r25
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1195               		.loc 1 299 8 view .LVU293
 1196 007e 4817      		cp r20,r24
 1197 0080 1906      		cpc __zero_reg__,r25
 1198 0082 01F4      		brne .L159
 1199               	.LVL86:
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1200               		.loc 1 299 8 view .LVU294
 1201               	.LBE107:
 1202               	.LBE106:
 1203               	.LBB113:
  48:./tmk_core/common/action_tapping.c ****             clear_keyboard();
 1204               		.loc 1 48 50 is_stmt 1 view .LVU295
  49:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1205               		.loc 1 49 13 view .LVU296
 1206 0084 0E94 0000 		call clear_keyboard
 1207               	.LVL87:
  50:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1208               		.loc 1 50 13 view .LVU297
 1209               	.LBB114:
 1210               	.LBI114:
 311:./tmk_core/common/action_tapping.c **** {
 1211               		.loc 1 311 6 view .LVU298
 1212               	.LBB115:
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1213               		.loc 1 313 5 view .LVU299
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1214               		.loc 1 313 25 is_stmt 0 view .LVU300
 1215 0088 1092 0000 		sts waiting_buffer_head,__zero_reg__
 314:./tmk_core/common/action_tapping.c **** }
 1216               		.loc 1 314 5 is_stmt 1 view .LVU301
 314:./tmk_core/common/action_tapping.c **** }
 1217               		.loc 1 314 25 is_stmt 0 view .LVU302
 1218 008c 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1219               	.LBE115:
 1220               	.LBE114:
  51:./tmk_core/common/action_tapping.c ****         }
 1221               		.loc 1 51 13 is_stmt 1 view .LVU303
  51:./tmk_core/common/action_tapping.c ****         }
 1222               		.loc 1 51 25 is_stmt 0 view .LVU304
 1223 0090 86E0      		ldi r24,lo8(6)
 1224 0092 E0E0      		ldi r30,lo8(tapping_key)
 1225 0094 F0E0      		ldi r31,hi8(tapping_key)
 1226 0096 DF01      		movw r26,r30
 1227               		0:
 1228 0098 1D92      		st X+,__zero_reg__
 1229 009a 8A95      		dec r24
 1230 009c 01F4      		brne 0b
 1231 009e 00C0      		rjmp .L135
 1232               	.LVL88:
 1233               	.L159:
  51:./tmk_core/common/action_tapping.c ****         }
 1234               		.loc 1 51 25 view .LVU305
 1235               	.LBE113:
 1236               	.LBB116:
 1237               	.LBB112:
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1238               		.loc 1 304 5 is_stmt 1 view .LVU306
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1239               		.loc 1 304 41 is_stmt 0 view .LVU307
 1240 00a0 96E0      		ldi r25,lo8(6)
 1241               	.LVL89:
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1242               		.loc 1 304 41 view .LVU308
 1243 00a2 929F      		mul r25,r18
 1244 00a4 D001      		movw r26,r0
 1245 00a6 939F      		mul r25,r19
 1246 00a8 B00D      		add r27,r0
 1247 00aa 1124      		clr __zero_reg__
 1248 00ac A050      		subi r26,lo8(-(waiting_buffer))
 1249 00ae B040      		sbci r27,hi8(-(waiting_buffer))
 1250 00b0 FE01      		movw r30,r28
 1251 00b2 3196      		adiw r30,1
 1252               		0:
 1253 00b4 0190      		ld r0,Z+
 1254 00b6 0D92      		st X+,r0
 1255 00b8 9A95      		dec r25
 1256 00ba 01F4      		brne 0b
 305:./tmk_core/common/action_tapping.c **** 
 1257               		.loc 1 305 5 is_stmt 1 view .LVU309
 305:./tmk_core/common/action_tapping.c **** 
 1258               		.loc 1 305 25 is_stmt 0 view .LVU310
 1259 00bc 8093 0000 		sts waiting_buffer_head,r24
 307:./tmk_core/common/action_tapping.c ****     return true;
 1260               		.loc 1 307 34 is_stmt 1 view .LVU311
 307:./tmk_core/common/action_tapping.c ****     return true;
 1261               		.loc 1 307 36 view .LVU312
 1262 00c0 0E94 0000 		call debug_waiting_buffer
 1263               	.LVL90:
 308:./tmk_core/common/action_tapping.c **** }
 1264               		.loc 1 308 5 view .LVU313
 308:./tmk_core/common/action_tapping.c **** }
 1265               		.loc 1 308 5 is_stmt 0 view .LVU314
 1266 00c4 00C0      		rjmp .L135
 1267               	.L140:
 1268               	.LBE112:
 1269               	.LBE116:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1270               		.loc 1 60 9 is_stmt 1 view .LVU315
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1271               		.loc 1 60 13 is_stmt 0 view .LVU316
 1272 00c6 819F      		mul r24,r17
 1273 00c8 C001      		movw r24,r0
 1274 00ca 1124      		clr __zero_reg__
 1275 00cc 8050      		subi r24,lo8(-(waiting_buffer))
 1276 00ce 9040      		sbci r25,hi8(-(waiting_buffer))
 1277 00d0 0E94 0000 		call process_tapping
 1278               	.LVL91:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1279               		.loc 1 60 12 view .LVU317
 1280 00d4 8823      		tst r24
 1281 00d6 01F0      		breq .L133
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1282               		.loc 1 61 48 is_stmt 1 view .LVU318
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1283               		.loc 1 61 80 view .LVU319
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1284               		.loc 1 61 95 view .LVU320
  62:./tmk_core/common/action_tapping.c ****         } else {
 1285               		.loc 1 62 13 view .LVU321
 1286 00d8 E091 0000 		lds r30,waiting_buffer_tail
 1287 00dc 1E9F      		mul r17,r30
 1288 00de F001      		movw r30,r0
 1289 00e0 1124      		clr __zero_reg__
 1290 00e2 E050      		subi r30,lo8(-(waiting_buffer))
 1291 00e4 F040      		sbci r31,hi8(-(waiting_buffer))
 1292 00e6 4081      		ld r20,Z
 1293 00e8 5181      		ldd r21,Z+1
 1294 00ea 6281      		ldd r22,Z+2
 1295 00ec 7381      		ldd r23,Z+3
 1296 00ee 8481      		ldd r24,Z+4
 1297 00f0 9581      		ldd r25,Z+5
 1298 00f2 0E94 0000 		call debug_record
 1299               	.LVL92:
  62:./tmk_core/common/action_tapping.c ****         } else {
 1300               		.loc 1 62 77 view .LVU322
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1301               		.loc 1 59 76 view .LVU323
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1302               		.loc 1 59 99 is_stmt 0 view .LVU324
 1303 00f6 8091 0000 		lds r24,waiting_buffer_tail
 1304 00fa 90E0      		ldi r25,0
 1305 00fc 0196      		adiw r24,1
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1306               		.loc 1 59 104 view .LVU325
 1307 00fe 8770      		andi r24,7
 1308 0100 9927      		clr r25
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1309               		.loc 1 59 76 view .LVU326
 1310 0102 8093 0000 		sts waiting_buffer_tail,r24
 1311               	.L142:
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1312               		.loc 1 59 32 is_stmt 1 discriminator 1 view .LVU327
 1313 0106 8091 0000 		lds r24,waiting_buffer_tail
 1314 010a 9091 0000 		lds r25,waiting_buffer_head
 1315 010e 8913      		cpse r24,r25
 1316 0110 00C0      		rjmp .L140
 1317               	.L133:
 1318               	/* epilogue start */
  70:./tmk_core/common/action_tapping.c **** 
 1319               		.loc 1 70 1 is_stmt 0 view .LVU328
 1320 0112 2C96      		adiw r28,12
 1321 0114 0FB6      		in __tmp_reg__,__SREG__
 1322 0116 F894      		cli
 1323 0118 DEBF      		out __SP_H__,r29
 1324 011a 0FBE      		out __SREG__,__tmp_reg__
 1325 011c CDBF      		out __SP_L__,r28
 1326 011e DF91      		pop r29
 1327 0120 CF91      		pop r28
 1328 0122 1F91      		pop r17
 1329 0124 0895      		ret
 1330               	.LVL93:
 1331               	.L157:
  43:./tmk_core/common/action_tapping.c ****         }
 1332               		.loc 1 43 33 is_stmt 1 view .LVU329
  43:./tmk_core/common/action_tapping.c ****         }
 1333               		.loc 1 43 35 view .LVU330
 1334 0126 6985      		ldd r22,Y+9
 1335 0128 7A85      		ldd r23,Y+10
 1336 012a 8B85      		ldd r24,Y+11
 1337 012c 9C85      		ldd r25,Y+12
 1338 012e 0E94 0000 		call debug_record
 1339               	.LVL94:
 1340 0132 00C0      		rjmp .L135
 1341               		.cfi_endproc
 1342               	.LFE4:
 1344               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1347               	waiting_buffer_tail:
 1348 0000 00        		.zero	1
 1349               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1352               	waiting_buffer_head:
 1353 0000 00        		.zero	1
 1354               		.section	.bss.waiting_buffer,"aw",@nobits
 1357               	waiting_buffer:
 1358 0000 0000 0000 		.zero	48
 1358      0000 0000 
 1358      0000 0000 
 1358      0000 0000 
 1358      0000 0000 
 1359               		.section	.bss.tapping_key,"aw",@nobits
 1362               	tapping_key:
 1363 0000 0000 0000 		.zero	6
 1363      0000 
 1364               		.text
 1365               	.Letext0:
 1366               		.file 3 "/usr/avr/include/stdint.h"
 1367               		.file 4 "./tmk_core/common/keycode.h"
 1368               		.file 5 "./tmk_core/common/action_code.h"
 1369               		.file 6 "./tmk_core/common/action.h"
 1370               		.file 7 "./tmk_core/common/action_layer.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
     /tmp/ccZXmx8E.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccZXmx8E.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccZXmx8E.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccZXmx8E.s:5      *ABS*:000000000000003b __RAMPZ__
     /tmp/ccZXmx8E.s:6      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccZXmx8E.s:7      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccZXmx8E.s:13     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
     /tmp/ccZXmx8E.s:1347   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
     /tmp/ccZXmx8E.s:1352   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
     /tmp/ccZXmx8E.s:1357   .bss.waiting_buffer:0000000000000000 waiting_buffer
     /tmp/ccZXmx8E.s:95     .text.debug_tapping_key:0000000000000000 debug_tapping_key
     /tmp/ccZXmx8E.s:1362   .bss.tapping_key:0000000000000000 tapping_key
     /tmp/ccZXmx8E.s:118    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
     /tmp/ccZXmx8E.s:292    .text.process_tapping:0000000000000000 process_tapping
     /tmp/ccZXmx8E.s:1064   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
debug_record
process_record
is_tap_key
debug_event
layer_switch_get_action
clear_keyboard
__do_clear_bss
