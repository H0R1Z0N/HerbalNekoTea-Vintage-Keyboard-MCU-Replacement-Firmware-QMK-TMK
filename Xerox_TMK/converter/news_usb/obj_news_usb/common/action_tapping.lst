   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB11:
  14               		.file 1 "../../tmk_core/common/action_tapping.c"
   1:../../tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:../../tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:../../tmk_core/common/action_tapping.c **** #include "action.h"
   4:../../tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:../../tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:../../tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:../../tmk_core/common/action_tapping.c **** #include "timer.h"
   8:../../tmk_core/common/action_tapping.c **** 
   9:../../tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:../../tmk_core/common/action_tapping.c **** #include "debug.h"
  11:../../tmk_core/common/action_tapping.c **** #else
  12:../../tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:../../tmk_core/common/action_tapping.c **** #endif
  14:../../tmk_core/common/action_tapping.c **** 
  15:../../tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:../../tmk_core/common/action_tapping.c **** 
  17:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:../../tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:../../tmk_core/common/action_tapping.c **** 
  23:../../tmk_core/common/action_tapping.c **** 
  24:../../tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:../../tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:../../tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:../../tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:../../tmk_core/common/action_tapping.c **** 
  29:../../tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:../../tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:../../tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:../../tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:../../tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  34:../../tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  35:../../tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  36:../../tmk_core/common/action_tapping.c **** 
  37:../../tmk_core/common/action_tapping.c **** 
  38:../../tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  39:../../tmk_core/common/action_tapping.c **** {
  40:../../tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  41:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  42:../../tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  43:../../tmk_core/common/action_tapping.c ****         }
  44:../../tmk_core/common/action_tapping.c ****     } else {
  45:../../tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  46:../../tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  47:../../tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  48:../../tmk_core/common/action_tapping.c ****             clear_keyboard();
  49:../../tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  50:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  51:../../tmk_core/common/action_tapping.c ****         }
  52:../../tmk_core/common/action_tapping.c ****     }
  53:../../tmk_core/common/action_tapping.c **** 
  54:../../tmk_core/common/action_tapping.c ****     // process waiting_buffer
  55:../../tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  56:../../tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  57:../../tmk_core/common/action_tapping.c ****     }
  58:../../tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  59:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  60:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  61:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  62:../../tmk_core/common/action_tapping.c ****         } else {
  63:../../tmk_core/common/action_tapping.c ****             break;
  64:../../tmk_core/common/action_tapping.c ****         }
  65:../../tmk_core/common/action_tapping.c ****     }
  66:../../tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  67:../../tmk_core/common/action_tapping.c ****         debug("\n");
  68:../../tmk_core/common/action_tapping.c ****     }
  69:../../tmk_core/common/action_tapping.c **** }
  70:../../tmk_core/common/action_tapping.c **** 
  71:../../tmk_core/common/action_tapping.c **** 
  72:../../tmk_core/common/action_tapping.c **** /* Tapping
  73:../../tmk_core/common/action_tapping.c ****  *
  74:../../tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  75:../../tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  76:../../tmk_core/common/action_tapping.c ****  */
  77:../../tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  78:../../tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  79:../../tmk_core/common/action_tapping.c **** {
  80:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  81:../../tmk_core/common/action_tapping.c **** 
  82:../../tmk_core/common/action_tapping.c ****     // if tapping
  83:../../tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  84:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  85:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  86:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  87:../../tmk_core/common/action_tapping.c ****                     // first tap!
  88:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  89:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  90:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  91:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
  92:../../tmk_core/common/action_tapping.c **** 
  93:../../tmk_core/common/action_tapping.c ****                     // copy tapping state
  94:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
  95:../../tmk_core/common/action_tapping.c ****                     // enqueue
  96:../../tmk_core/common/action_tapping.c ****                     return false;
  97:../../tmk_core/common/action_tapping.c ****                 }
  98:../../tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500
  99:../../tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 100:../../tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 101:../../tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 102:../../tmk_core/common/action_tapping.c ****                  */
 103:../../tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 104:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 105:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
 106:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 107:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 108:../../tmk_core/common/action_tapping.c ****                     // enqueue
 109:../../tmk_core/common/action_tapping.c ****                     return false;
 110:../../tmk_core/common/action_tapping.c ****                 }
 111:../../tmk_core/common/action_tapping.c **** #endif
 112:../../tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 113:../../tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 114:../../tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 115:../../tmk_core/common/action_tapping.c ****                  */
 116:../../tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 117:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 118:../../tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event);
 119:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 120:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 121:../../tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 122:../../tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 123:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 124:../../tmk_core/common/action_tapping.c ****                             break;
 125:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 126:../../tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 127:../../tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 128:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 129:../../tmk_core/common/action_tapping.c ****                             break;
 130:../../tmk_core/common/action_tapping.c ****                     }
 131:../../tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 132:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 133:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 134:../../tmk_core/common/action_tapping.c ****                     return true;
 135:../../tmk_core/common/action_tapping.c ****                 }
 136:../../tmk_core/common/action_tapping.c ****                 else {
 137:../../tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 138:../../tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 139:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 140:../../tmk_core/common/action_tapping.c ****                     }
 141:../../tmk_core/common/action_tapping.c ****                     // enqueue 
 142:../../tmk_core/common/action_tapping.c ****                     return false;
 143:../../tmk_core/common/action_tapping.c ****                 }
 144:../../tmk_core/common/action_tapping.c ****             }
 145:../../tmk_core/common/action_tapping.c ****             // tap_count > 0
 146:../../tmk_core/common/action_tapping.c ****             else {
 147:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 148:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 149:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 150:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 151:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 152:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 153:../../tmk_core/common/action_tapping.c ****                     return true;
 154:../../tmk_core/common/action_tapping.c ****                 }
 155:../../tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event) && event.pressed) {
 156:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 157:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 158:../../tmk_core/common/action_tapping.c ****                         // unregister key
 159:../../tmk_core/common/action_tapping.c ****                         process_action(&(keyrecord_t){
 160:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 161:../../tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 162:../../tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 163:../../tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 164:../../tmk_core/common/action_tapping.c ****                         });
 165:../../tmk_core/common/action_tapping.c ****                     } else {
 166:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 167:../../tmk_core/common/action_tapping.c ****                     }
 168:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 169:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 170:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 171:../../tmk_core/common/action_tapping.c ****                     return true;
 172:../../tmk_core/common/action_tapping.c ****                 }
 173:../../tmk_core/common/action_tapping.c ****                 else {
 174:../../tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 175:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 176:../../tmk_core/common/action_tapping.c ****                     }
 177:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 178:../../tmk_core/common/action_tapping.c ****                     return true;
 179:../../tmk_core/common/action_tapping.c ****                 }
 180:../../tmk_core/common/action_tapping.c ****             }
 181:../../tmk_core/common/action_tapping.c ****         }
 182:../../tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 183:../../tmk_core/common/action_tapping.c ****         else {
 184:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 185:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 186:../../tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 187:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 188:../../tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 189:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 190:../../tmk_core/common/action_tapping.c ****                 return false;
 191:../../tmk_core/common/action_tapping.c ****             }  else {
 192:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 193:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 194:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 195:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 196:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 197:../../tmk_core/common/action_tapping.c ****                     return true;
 198:../../tmk_core/common/action_tapping.c ****                 }
 199:../../tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event) && event.pressed) {
 200:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 201:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 202:../../tmk_core/common/action_tapping.c ****                         // unregister key
 203:../../tmk_core/common/action_tapping.c ****                         process_action(&(keyrecord_t){
 204:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 205:../../tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 206:../../tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 207:../../tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 208:../../tmk_core/common/action_tapping.c ****                         });
 209:../../tmk_core/common/action_tapping.c ****                     } else {
 210:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 211:../../tmk_core/common/action_tapping.c ****                     }
 212:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 213:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 214:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 215:../../tmk_core/common/action_tapping.c ****                     return true;
 216:../../tmk_core/common/action_tapping.c ****                 }
 217:../../tmk_core/common/action_tapping.c ****                 else {
 218:../../tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 219:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 220:../../tmk_core/common/action_tapping.c ****                     }
 221:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 222:../../tmk_core/common/action_tapping.c ****                     return true;
 223:../../tmk_core/common/action_tapping.c ****                 }
 224:../../tmk_core/common/action_tapping.c ****             }
 225:../../tmk_core/common/action_tapping.c ****         }
 226:../../tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 227:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 228:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 229:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 230:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 231:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 232:../../tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 233:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 234:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 235:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 236:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 237:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 238:../../tmk_core/common/action_tapping.c ****                         return true;
 239:../../tmk_core/common/action_tapping.c ****                     } else {
 240:../../tmk_core/common/action_tapping.c ****                         // FIX: start new tap again
 241:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 242:../../tmk_core/common/action_tapping.c ****                         return true;
 243:../../tmk_core/common/action_tapping.c ****                     }
 244:../../tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event)) {
 245:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 246:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 247:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 248:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 249:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 250:../../tmk_core/common/action_tapping.c ****                     return true;
 251:../../tmk_core/common/action_tapping.c ****                 } else {
 252:../../tmk_core/common/action_tapping.c ****                     // should none in buffer
 253:../../tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 254:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 255:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 256:../../tmk_core/common/action_tapping.c ****                     return true;
 257:../../tmk_core/common/action_tapping.c ****                 }
 258:../../tmk_core/common/action_tapping.c ****             } else {
 259:../../tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 260:../../tmk_core/common/action_tapping.c ****                 process_action(keyp);
 261:../../tmk_core/common/action_tapping.c ****                 return true;
 262:../../tmk_core/common/action_tapping.c ****             }
 263:../../tmk_core/common/action_tapping.c ****         } else {
 264:../../tmk_core/common/action_tapping.c ****             // FIX: process_aciton here?
 265:../../tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 266:../../tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 267:../../tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 268:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 269:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 270:../../tmk_core/common/action_tapping.c ****             return false;
 271:../../tmk_core/common/action_tapping.c ****         }
 272:../../tmk_core/common/action_tapping.c ****     }
 273:../../tmk_core/common/action_tapping.c ****     // not tapping state
 274:../../tmk_core/common/action_tapping.c ****     else {
 275:../../tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event)) {
 276:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 277:../../tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 278:../../tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 279:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 280:../../tmk_core/common/action_tapping.c ****             return true;
 281:../../tmk_core/common/action_tapping.c ****         } else {
 282:../../tmk_core/common/action_tapping.c ****             process_action(keyp);
 283:../../tmk_core/common/action_tapping.c ****             return true;
 284:../../tmk_core/common/action_tapping.c ****         }
 285:../../tmk_core/common/action_tapping.c ****     }
 286:../../tmk_core/common/action_tapping.c **** }
 287:../../tmk_core/common/action_tapping.c **** 
 288:../../tmk_core/common/action_tapping.c **** 
 289:../../tmk_core/common/action_tapping.c **** /*
 290:../../tmk_core/common/action_tapping.c ****  * Waiting buffer
 291:../../tmk_core/common/action_tapping.c ****  */
 292:../../tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 293:../../tmk_core/common/action_tapping.c **** {
 294:../../tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 295:../../tmk_core/common/action_tapping.c ****         return true;
 296:../../tmk_core/common/action_tapping.c ****     }
 297:../../tmk_core/common/action_tapping.c **** 
 298:../../tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 299:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 300:../../tmk_core/common/action_tapping.c ****         return false;
 301:../../tmk_core/common/action_tapping.c ****     }
 302:../../tmk_core/common/action_tapping.c **** 
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 304:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 305:../../tmk_core/common/action_tapping.c **** 
 306:../../tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 307:../../tmk_core/common/action_tapping.c ****     return true;
 308:../../tmk_core/common/action_tapping.c **** }
 309:../../tmk_core/common/action_tapping.c **** 
 310:../../tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 311:../../tmk_core/common/action_tapping.c **** {
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 313:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 314:../../tmk_core/common/action_tapping.c **** }
 315:../../tmk_core/common/action_tapping.c **** 
 316:../../tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 317:../../tmk_core/common/action_tapping.c **** {
 318:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 319:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 320:../../tmk_core/common/action_tapping.c ****             return true;
 321:../../tmk_core/common/action_tapping.c ****         }
 322:../../tmk_core/common/action_tapping.c ****     }
 323:../../tmk_core/common/action_tapping.c ****     return false;
 324:../../tmk_core/common/action_tapping.c **** }
 325:../../tmk_core/common/action_tapping.c **** 
 326:../../tmk_core/common/action_tapping.c **** /* scan buffer for tapping */
 327:../../tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 328:../../tmk_core/common/action_tapping.c **** {
 329:../../tmk_core/common/action_tapping.c ****     // tapping already is settled
 330:../../tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 331:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 332:../../tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 333:../../tmk_core/common/action_tapping.c **** 
 334:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 335:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 336:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 337:../../tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 338:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 339:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 340:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 341:../../tmk_core/common/action_tapping.c **** 
 342:../../tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 343:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 344:../../tmk_core/common/action_tapping.c ****             return;
 345:../../tmk_core/common/action_tapping.c ****         }
 346:../../tmk_core/common/action_tapping.c ****     }
 347:../../tmk_core/common/action_tapping.c **** }
 348:../../tmk_core/common/action_tapping.c **** 
 349:../../tmk_core/common/action_tapping.c **** 
 350:../../tmk_core/common/action_tapping.c **** /*
 351:../../tmk_core/common/action_tapping.c ****  * debug print
 352:../../tmk_core/common/action_tapping.c ****  */
 353:../../tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 354:../../tmk_core/common/action_tapping.c **** {
 355:../../tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 356:../../tmk_core/common/action_tapping.c **** }
 357:../../tmk_core/common/action_tapping.c **** 
 358:../../tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 359:../../tmk_core/common/action_tapping.c **** {
  15               		.loc 1 359 1 view -0
  16               		.cfi_startproc
  17 0000 CF93      		push r28
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 28, -2
  21 0002 DF93      		push r29
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 29, -3
  25               	/* prologue: function */
  26               	/* frame size = 0 */
  27               	/* stack size = 2 */
  28               	.L__stack_usage = 2
 360:../../tmk_core/common/action_tapping.c ****     debug("{ ");
  29               		.loc 1 360 5 view .LVU1
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  30               		.loc 1 361 5 view .LVU2
  31               	.LBB41:
  32               		.loc 1 361 10 view .LVU3
  33               		.loc 1 361 18 is_stmt 0 view .LVU4
  34 0004 C091 0000 		lds r28,waiting_buffer_tail
  35               	.LVL0:
  36               	.L2:
  37               		.loc 1 361 43 is_stmt 1 discriminator 1 view .LVU5
  38               		.loc 1 361 5 is_stmt 0 discriminator 1 view .LVU6
  39 0008 8091 0000 		lds r24,waiting_buffer_head
  40 000c 8C13      		cpse r24,r28
  41 000e 00C0      		rjmp .L3
  42               	/* epilogue start */
  43               	.LBE41:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
 363:../../tmk_core/common/action_tapping.c ****     }
 364:../../tmk_core/common/action_tapping.c ****     debug("}\n");
 365:../../tmk_core/common/action_tapping.c **** }
  44               		.loc 1 365 1 view .LVU7
  45 0010 DF91      		pop r29
  46 0012 CF91      		pop r28
  47               	.LVL1:
  48               		.loc 1 365 1 view .LVU8
  49 0014 0895      		ret
  50               	.LVL2:
  51               	.L3:
  52               	.LBB42:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  53               		.loc 1 362 9 is_stmt 1 discriminator 3 view .LVU9
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  54               		.loc 1 362 21 discriminator 3 view .LVU10
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  55               		.loc 1 362 35 discriminator 3 view .LVU11
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  56               		.loc 1 362 48 discriminator 3 view .LVU12
  57 0016 D0E0      		ldi r29,0
  58 0018 CE01      		movw r24,r28
  59 001a 66E0      		ldi r22,lo8(6)
  60 001c 70E0      		ldi r23,0
  61 001e 0E94 0000 		call __mulhi3
  62 0022 FC01      		movw r30,r24
  63 0024 E050      		subi r30,lo8(-(waiting_buffer))
  64 0026 F040      		sbci r31,hi8(-(waiting_buffer))
  65 0028 4081      		ld r20,Z
  66 002a 5181      		ldd r21,Z+1
  67 002c 6281      		ldd r22,Z+2
  68 002e 7381      		ldd r23,Z+3
  69 0030 8481      		ldd r24,Z+4
  70 0032 9581      		ldd r25,Z+5
  71 0034 0E94 0000 		call debug_record
  72               	.LVL3:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  73               		.loc 1 362 81 discriminator 3 view .LVU13
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  74               		.loc 1 361 69 discriminator 3 view .LVU14
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  75               		.loc 1 361 76 is_stmt 0 discriminator 3 view .LVU15
  76 0038 2196      		adiw r28,1
  77               	.LVL4:
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  78               		.loc 1 361 71 discriminator 3 view .LVU16
  79 003a C770      		andi r28,lo8(7)
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  80               		.loc 1 361 71 discriminator 3 view .LVU17
  81 003c 00C0      		rjmp .L2
  82               	.LBE42:
  83               		.cfi_endproc
  84               	.LFE11:
  86               		.section	.text.debug_tapping_key,"ax",@progbits
  88               	debug_tapping_key:
  89               	.LFB10:
 354:../../tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  90               		.loc 1 354 1 is_stmt 1 view -0
  91               		.cfi_startproc
  92               	/* prologue: function */
  93               	/* frame size = 0 */
  94               	/* stack size = 0 */
  95               	.L__stack_usage = 0
 355:../../tmk_core/common/action_tapping.c **** }
  96               		.loc 1 355 5 view .LVU19
 355:../../tmk_core/common/action_tapping.c **** }
  97               		.loc 1 355 28 view .LVU20
  98 0000 4091 0000 		lds r20,tapping_key
  99 0004 5091 0000 		lds r21,tapping_key+1
 100 0008 6091 0000 		lds r22,tapping_key+2
 101 000c 7091 0000 		lds r23,tapping_key+3
 102 0010 8091 0000 		lds r24,tapping_key+4
 103 0014 9091 0000 		lds r25,tapping_key+5
 104 0018 0C94 0000 		jmp debug_record
 105               	.LVL5:
 106               		.cfi_endproc
 107               	.LFE10:
 109               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 111               	waiting_buffer_scan_tap:
 112               	.LFB9:
 328:../../tmk_core/common/action_tapping.c ****     // tapping already is settled
 113               		.loc 1 328 1 view -0
 114               		.cfi_startproc
 115 0000 FF92      		push r15
 116               	.LCFI2:
 117               		.cfi_def_cfa_offset 3
 118               		.cfi_offset 15, -2
 119 0002 0F93      		push r16
 120               	.LCFI3:
 121               		.cfi_def_cfa_offset 4
 122               		.cfi_offset 16, -3
 123 0004 1F93      		push r17
 124               	.LCFI4:
 125               		.cfi_def_cfa_offset 5
 126               		.cfi_offset 17, -4
 127 0006 CF93      		push r28
 128               	.LCFI5:
 129               		.cfi_def_cfa_offset 6
 130               		.cfi_offset 28, -5
 131 0008 DF93      		push r29
 132               	.LCFI6:
 133               		.cfi_def_cfa_offset 7
 134               		.cfi_offset 29, -6
 135               	/* prologue: function */
 136               	/* frame size = 0 */
 137               	/* stack size = 5 */
 138               	.L__stack_usage = 5
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 139               		.loc 1 330 5 view .LVU22
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 140               		.loc 1 330 31 is_stmt 0 view .LVU23
 141 000a 8091 0000 		lds r24,tapping_key+5
 142 000e 807F      		andi r24,lo8(-16)
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 143               		.loc 1 330 8 view .LVU24
 144 0010 01F4      		brne .L5
 332:../../tmk_core/common/action_tapping.c **** 
 145               		.loc 1 332 5 is_stmt 1 view .LVU25
 332:../../tmk_core/common/action_tapping.c **** 
 146               		.loc 1 332 8 is_stmt 0 view .LVU26
 147 0012 8091 0000 		lds r24,tapping_key+2
 148 0016 8823      		tst r24
 149 0018 01F0      		breq .L5
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 150               		.loc 1 334 5 is_stmt 1 view .LVU27
 151               	.LBB43:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 152               		.loc 1 334 10 view .LVU28
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 153               		.loc 1 334 18 is_stmt 0 view .LVU29
 154 001a 2091 0000 		lds r18,waiting_buffer_tail
 155               	.LVL6:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 156               		.loc 1 334 45 view .LVU30
 157 001e 0091 0000 		lds r16,waiting_buffer_head
 158 0022 1091 0000 		lds r17,tapping_key
 159 0026 4091 0000 		lds r20,tapping_key+1
 160 002a A091 0000 		lds r26,tapping_key+3
 161 002e B091 0000 		lds r27,tapping_key+3+1
 162 0032 F42E      		mov r15,r20
 163 0034 F122      		and r15,r17
 164 0036 ED01      		movw r28,r26
 165 0038 C095      		com r28
 166 003a D095      		com r29
 167               	.LVL7:
 168               	.L7:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 169               		.loc 1 334 43 is_stmt 1 discriminator 1 view .LVU31
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 170               		.loc 1 334 5 is_stmt 0 discriminator 1 view .LVU32
 171 003c 0213      		cpse r16,r18
 172 003e 00C0      		rjmp .L12
 173               	.LVL8:
 174               	.L5:
 175               	/* epilogue start */
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 176               		.loc 1 334 5 discriminator 1 view .LVU33
 177               	.LBE43:
 347:../../tmk_core/common/action_tapping.c **** 
 178               		.loc 1 347 1 view .LVU34
 179 0040 DF91      		pop r29
 180 0042 CF91      		pop r28
 181 0044 1F91      		pop r17
 182 0046 0F91      		pop r16
 183 0048 FF90      		pop r15
 184 004a 0895      		ret
 185               	.LVL9:
 186               	.L12:
 187               	.LBB48:
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 188               		.loc 1 335 9 is_stmt 1 view .LVU35
 189               	.LBB44:
 190               	.LBI44:
 191               		.file 2 "../../tmk_core/common/keyboard.h"
   1:../../tmk_core/common/keyboard.h **** /*
   2:../../tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:../../tmk_core/common/keyboard.h **** 
   4:../../tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:../../tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:../../tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:../../tmk_core/common/keyboard.h **** (at your option) any later version.
   8:../../tmk_core/common/keyboard.h **** 
   9:../../tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:../../tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:../../tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:../../tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:../../tmk_core/common/keyboard.h **** 
  14:../../tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:../../tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:../../tmk_core/common/keyboard.h **** */
  17:../../tmk_core/common/keyboard.h **** 
  18:../../tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:../../tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:../../tmk_core/common/keyboard.h **** 
  21:../../tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:../../tmk_core/common/keyboard.h **** #include <stdint.h>
  23:../../tmk_core/common/keyboard.h **** 
  24:../../tmk_core/common/keyboard.h **** 
  25:../../tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:../../tmk_core/common/keyboard.h **** extern "C" {
  27:../../tmk_core/common/keyboard.h **** #endif
  28:../../tmk_core/common/keyboard.h **** 
  29:../../tmk_core/common/keyboard.h **** /* key matrix position */
  30:../../tmk_core/common/keyboard.h **** typedef struct {
  31:../../tmk_core/common/keyboard.h ****     uint8_t col;
  32:../../tmk_core/common/keyboard.h ****     uint8_t row;
  33:../../tmk_core/common/keyboard.h **** } keypos_t;
  34:../../tmk_core/common/keyboard.h **** 
  35:../../tmk_core/common/keyboard.h **** /* key event */
  36:../../tmk_core/common/keyboard.h **** typedef struct {
  37:../../tmk_core/common/keyboard.h ****     keypos_t key;
  38:../../tmk_core/common/keyboard.h ****     bool     pressed;
  39:../../tmk_core/common/keyboard.h ****     uint16_t time;
  40:../../tmk_core/common/keyboard.h **** } keyevent_t;
  41:../../tmk_core/common/keyboard.h **** 
  42:../../tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:../../tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:../../tmk_core/common/keyboard.h **** 
  45:../../tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:../../tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:../../tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:../../tmk_core/common/keyboard.h ****  */
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 192               		.loc 2 49 20 view .LVU36
 193               	.LBB45:
 194               		.loc 2 49 51 view .LVU37
 195               	.LBE45:
 196               	.LBE44:
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 197               		.loc 1 335 13 is_stmt 0 view .LVU38
 198 004c 30E0      		ldi r19,0
 199               	.LBB47:
 200               	.LBB46:
 201               		.loc 2 49 74 view .LVU39
 202 004e 1097      		sbiw r26,0
 203 0050 01F0      		breq .L8
 204 0052 8FEF      		ldi r24,lo8(-1)
 205 0054 F812      		cpse r15,r24
 206 0056 00C0      		rjmp .L23
 207               	.LVL10:
 208               	.L8:
 209               		.loc 2 49 74 view .LVU40
 210               	.LBE46:
 211               	.LBE47:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 212               		.loc 1 334 69 is_stmt 1 discriminator 2 view .LVU41
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 213               		.loc 1 334 76 is_stmt 0 discriminator 2 view .LVU42
 214 0058 2F5F      		subi r18,-1
 215 005a 3F4F      		sbci r19,-1
 216               	.LVL11:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 217               		.loc 1 334 71 discriminator 2 view .LVU43
 218 005c 2770      		andi r18,lo8(7)
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 219               		.loc 1 334 71 discriminator 2 view .LVU44
 220 005e 00C0      		rjmp .L7
 221               	.LVL12:
 222               	.L10:
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 223               		.loc 1 337 17 discriminator 2 view .LVU45
 224 0060 8C0F      		add r24,r28
 225 0062 9D1F      		adc r25,r29
 226 0064 00C0      		rjmp .L25
 227               	.LVL13:
 228               	.L23:
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 229               		.loc 1 335 13 view .LVU46
 230 0066 C901      		movw r24,r18
 231 0068 66E0      		ldi r22,lo8(6)
 232 006a 70E0      		ldi r23,0
 233 006c 0E94 0000 		call __mulhi3
 234 0070 FC01      		movw r30,r24
 235 0072 E050      		subi r30,lo8(-(waiting_buffer))
 236 0074 F040      		sbci r31,hi8(-(waiting_buffer))
 237 0076 8181      		ldd r24,Z+1
 238 0078 4813      		cpse r20,r24
 239 007a 00C0      		rjmp .L8
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 240               		.loc 1 335 13 discriminator 2 view .LVU47
 241 007c 8081      		ld r24,Z
 242 007e 8113      		cpse r24,r17
 243 0080 00C0      		rjmp .L8
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 244               		.loc 1 335 57 discriminator 3 view .LVU48
 245 0082 8281      		ldd r24,Z+2
 246 0084 8111      		cpse r24,__zero_reg__
 247 0086 00C0      		rjmp .L8
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 248               		.loc 1 337 17 view .LVU49
 249 0088 8381      		ldd r24,Z+3
 250 008a 9481      		ldd r25,Z+4
 251 008c 8A17      		cp r24,r26
 252 008e 9B07      		cpc r25,r27
 253 0090 00F0      		brlo .L10
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 254               		.loc 1 337 17 discriminator 1 view .LVU50
 255 0092 8A1B      		sub r24,r26
 256 0094 9B0B      		sbc r25,r27
 257               	.L25:
 336:../../tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 258               		.loc 1 336 50 discriminator 2 view .LVU51
 259 0096 883C      		cpi r24,-56
 260 0098 9105      		cpc r25,__zero_reg__
 261 009a 00F4      		brsh .L8
 338:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 262               		.loc 1 338 13 is_stmt 1 view .LVU52
 338:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 263               		.loc 1 338 35 is_stmt 0 view .LVU53
 264 009c 8091 0000 		lds r24,tapping_key+5
 265 00a0 8F70      		andi r24,lo8(15)
 266 00a2 8061      		ori r24,lo8(16)
 267 00a4 8093 0000 		sts tapping_key+5,r24
 339:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 268               		.loc 1 339 13 is_stmt 1 view .LVU54
 339:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 269               		.loc 1 339 41 is_stmt 0 view .LVU55
 270 00a8 C901      		movw r24,r18
 271 00aa 66E0      		ldi r22,lo8(6)
 272 00ac 70E0      		ldi r23,0
 273 00ae 0E94 0000 		call __mulhi3
 274 00b2 FC01      		movw r30,r24
 275 00b4 E050      		subi r30,lo8(-(waiting_buffer+5))
 276 00b6 F040      		sbci r31,hi8(-(waiting_buffer+5))
 277 00b8 9081      		ld r25,Z
 278 00ba 9F70      		andi r25,lo8(15)
 279 00bc 9061      		ori r25,lo8(16)
 280 00be 9083      		st Z,r25
 340:../../tmk_core/common/action_tapping.c **** 
 281               		.loc 1 340 13 is_stmt 1 view .LVU56
 282 00c0 80E0      		ldi r24,lo8(tapping_key)
 283 00c2 90E0      		ldi r25,hi8(tapping_key)
 284 00c4 0E94 0000 		call process_action
 285               	.LVL14:
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 286               		.loc 1 342 13 view .LVU57
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 287               		.loc 1 342 59 view .LVU58
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 288               		.loc 1 342 73 view .LVU59
 343:../../tmk_core/common/action_tapping.c ****             return;
 289               		.loc 1 343 13 view .LVU60
 290               	/* epilogue start */
 291               	.LBE48:
 347:../../tmk_core/common/action_tapping.c **** 
 292               		.loc 1 347 1 is_stmt 0 view .LVU61
 293 00c8 DF91      		pop r29
 294 00ca CF91      		pop r28
 295 00cc 1F91      		pop r17
 296 00ce 0F91      		pop r16
 297 00d0 FF90      		pop r15
 298               	.LBB49:
 343:../../tmk_core/common/action_tapping.c ****             return;
 299               		.loc 1 343 13 view .LVU62
 300 00d2 0C94 0000 		jmp debug_waiting_buffer
 301               	.LVL15:
 302               	.LBE49:
 303               		.cfi_endproc
 304               	.LFE9:
 306               		.section	.text.process_tapping,"ax",@progbits
 308               	process_tapping:
 309               	.LVL16:
 310               	.LFB5:
  79:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 311               		.loc 1 79 1 is_stmt 1 view -0
 312               		.cfi_startproc
  79:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 313               		.loc 1 79 1 is_stmt 0 view .LVU64
 314 0000 9F92      		push r9
 315               	.LCFI7:
 316               		.cfi_def_cfa_offset 3
 317               		.cfi_offset 9, -2
 318 0002 AF92      		push r10
 319               	.LCFI8:
 320               		.cfi_def_cfa_offset 4
 321               		.cfi_offset 10, -3
 322 0004 BF92      		push r11
 323               	.LCFI9:
 324               		.cfi_def_cfa_offset 5
 325               		.cfi_offset 11, -4
 326 0006 CF92      		push r12
 327               	.LCFI10:
 328               		.cfi_def_cfa_offset 6
 329               		.cfi_offset 12, -5
 330 0008 DF92      		push r13
 331               	.LCFI11:
 332               		.cfi_def_cfa_offset 7
 333               		.cfi_offset 13, -6
 334 000a EF92      		push r14
 335               	.LCFI12:
 336               		.cfi_def_cfa_offset 8
 337               		.cfi_offset 14, -7
 338 000c FF92      		push r15
 339               	.LCFI13:
 340               		.cfi_def_cfa_offset 9
 341               		.cfi_offset 15, -8
 342 000e 0F93      		push r16
 343               	.LCFI14:
 344               		.cfi_def_cfa_offset 10
 345               		.cfi_offset 16, -9
 346 0010 1F93      		push r17
 347               	.LCFI15:
 348               		.cfi_def_cfa_offset 11
 349               		.cfi_offset 17, -10
 350 0012 CF93      		push r28
 351               	.LCFI16:
 352               		.cfi_def_cfa_offset 12
 353               		.cfi_offset 28, -11
 354 0014 DF93      		push r29
 355               	.LCFI17:
 356               		.cfi_def_cfa_offset 13
 357               		.cfi_offset 29, -12
 358 0016 CDB7      		in r28,__SP_L__
 359 0018 DEB7      		in r29,__SP_H__
 360               	.LCFI18:
 361               		.cfi_def_cfa_register 28
 362 001a 2B97      		sbiw r28,11
 363               	.LCFI19:
 364               		.cfi_def_cfa_offset 24
 365 001c 0FB6      		in __tmp_reg__,__SREG__
 366 001e F894      		cli
 367 0020 DEBF      		out __SP_H__,r29
 368 0022 0FBE      		out __SREG__,__tmp_reg__
 369 0024 CDBF      		out __SP_L__,r28
 370               	/* prologue: function */
 371               	/* frame size = 11 */
 372               	/* stack size = 22 */
 373               	.L__stack_usage = 22
 374 0026 8C01      		movw r16,r24
  80:../../tmk_core/common/action_tapping.c **** 
 375               		.loc 1 80 5 is_stmt 1 view .LVU65
  80:../../tmk_core/common/action_tapping.c **** 
 376               		.loc 1 80 16 is_stmt 0 view .LVU66
 377 0028 85E0      		ldi r24,lo8(5)
 378               	.LVL17:
  80:../../tmk_core/common/action_tapping.c **** 
 379               		.loc 1 80 16 view .LVU67
 380 002a F801      		movw r30,r16
 381 002c DE01      		movw r26,r28
 382 002e 1796      		adiw r26,7
 383               		0:
 384 0030 0190      		ld r0,Z+
 385 0032 0D92      		st X+,r0
 386 0034 8A95      		dec r24
 387 0036 01F4      		brne 0b
 388 0038 D801      		movw r26,r16
 389 003a 4C91      		ld r20,X
 390               	.LVL18:
  80:../../tmk_core/common/action_tapping.c **** 
 391               		.loc 1 80 16 view .LVU68
 392 003c 1196      		adiw r26,1
 393 003e 2C91      		ld r18,X
 394 0040 1197      		sbiw r26,1
 395               	.LVL19:
  80:../../tmk_core/common/action_tapping.c **** 
 396               		.loc 1 80 16 view .LVU69
 397 0042 1296      		adiw r26,2
 398 0044 FC90      		ld r15,X
 399               	.LVL20:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 400               		.loc 1 83 5 is_stmt 1 view .LVU70
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 401               		.loc 1 83 5 is_stmt 0 view .LVU71
 402 0046 8091 0000 		lds r24,tapping_key+3
 403 004a 9091 0000 		lds r25,tapping_key+3+1
 404               	.LVL21:
 405               	.LBB75:
 406               	.LBI75:
 407               		.loc 2 49 20 is_stmt 1 view .LVU72
 408               	.LBB76:
 409               		.loc 2 49 51 view .LVU73
 410               		.loc 2 49 74 is_stmt 0 view .LVU74
 411 004e 0097      		sbiw r24,0
 412 0050 01F0      		breq .L27
 413 0052 3091 0000 		lds r19,tapping_key
 414 0056 5091 0000 		lds r21,tapping_key+1
 415 005a 632F      		mov r22,r19
 416 005c 6523      		and r22,r21
 417 005e 6F3F      		cpi r22,lo8(-1)
 418 0060 01F0      		breq .+2
 419 0062 00C0      		rjmp .L115
 420               	.L27:
 421               	.LVL22:
 422               		.loc 2 49 74 view .LVU75
 423               	.LBE76:
 424               	.LBE75:
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 425               		.loc 1 275 9 is_stmt 1 view .LVU76
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 426               		.loc 1 275 12 is_stmt 0 view .LVU77
 427 0064 FF20      		tst r15
 428 0066 01F4      		brne .+2
 429 0068 00C0      		rjmp .L58
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 430               		.loc 1 275 30 discriminator 1 view .LVU78
 431 006a 4F83      		std Y+7,r20
 432 006c 2887      		std Y+8,r18
 433 006e F986      		std Y+9,r15
 434 0070 522F      		mov r21,r18
 435 0072 6F2D      		mov r22,r15
 436 0074 7A85      		ldd r23,Y+10
 437 0076 8B85      		ldd r24,Y+11
 438 0078 0E94 0000 		call is_tap_key
 439               	.LVL23:
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 440               		.loc 1 275 27 discriminator 1 view .LVU79
 441 007c 8823      		tst r24
 442 007e 01F4      		brne .+2
 443 0080 00C0      		rjmp .L58
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 444               		.loc 1 275 27 discriminator 1 view .LVU80
 445 0082 00C0      		rjmp .L50
 446               	.LVL24:
 447               	.L67:
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 448               		.loc 1 84 9 is_stmt 1 view .LVU81
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 449               		.loc 1 84 13 is_stmt 0 view .LVU82
 450 0084 A816      		cp r10,r24
 451 0086 B906      		cpc r11,r25
 452 0088 00F0      		brlo .L29
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 453               		.loc 1 84 13 discriminator 1 view .LVU83
 454 008a F501      		movw r30,r10
 455 008c E81B      		sub r30,r24
 456 008e F90B      		sbc r31,r25
 457 0090 CF01      		movw r24,r30
 458               	.L122:
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 459               		.loc 1 84 13 discriminator 2 view .LVU84
 460 0092 EE24      		clr r14
 461 0094 E394      		inc r14
 462 0096 883C      		cpi r24,-56
 463 0098 9105      		cpc r25,__zero_reg__
 464 009a 00F0      		brlo .L31
 465 009c E12C      		mov r14,__zero_reg__
 466               	.L31:
  85:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 467               		.loc 1 85 39 view .LVU85
 468 009e 80E0      		ldi r24,lo8(tapping_key)
 469 00a0 C82E      		mov r12,r24
 470 00a2 80E0      		ldi r24,hi8(tapping_key)
 471 00a4 D82E      		mov r13,r24
 472 00a6 8091 0000 		lds r24,tapping_key+5
 473 00aa 982F      		mov r25,r24
 474 00ac 907F      		andi r25,lo8(-16)
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 475               		.loc 1 84 12 view .LVU86
 476 00ae E110      		cpse r14,__zero_reg__
 477 00b0 00C0      		rjmp .L69
 184:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 478               		.loc 1 184 13 is_stmt 1 view .LVU87
 184:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 479               		.loc 1 184 16 is_stmt 0 view .LVU88
 480 00b2 01F0      		breq .+2
 481 00b4 00C0      		rjmp .L51
 482               	.LBB77:
 185:../../tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 483               		.loc 1 185 17 is_stmt 1 view .LVU89
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 484               		.loc 1 186 17 view .LVU90
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 485               		.loc 1 186 17 is_stmt 0 view .LVU91
 486 00b6 522F      		mov r21,r18
 487 00b8 6F2D      		mov r22,r15
 488 00ba 7A85      		ldd r23,Y+10
 489 00bc 8B85      		ldd r24,Y+11
 490 00be 0E94 0000 		call debug_event
 491               	.LVL25:
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 492               		.loc 1 186 37 is_stmt 1 view .LVU92
 187:../../tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 493               		.loc 1 187 17 view .LVU93
 494 00c2 80E0      		ldi r24,lo8(tapping_key)
 495 00c4 90E0      		ldi r25,hi8(tapping_key)
 496 00c6 0E94 0000 		call process_action
 497               	.LVL26:
 188:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 498               		.loc 1 188 17 view .LVU94
 188:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 499               		.loc 1 188 29 is_stmt 0 view .LVU95
 500 00ca 86E0      		ldi r24,lo8(6)
 501 00cc F601      		movw r30,r12
 502               		0:
 503 00ce 1192      		st Z+,__zero_reg__
 504 00d0 8A95      		dec r24
 505 00d2 01F4      		brne 0b
 506               	.L124:
 189:../../tmk_core/common/action_tapping.c ****                 return false;
 507               		.loc 1 189 17 is_stmt 1 view .LVU96
 508 00d4 0E94 0000 		call debug_tapping_key
 509               	.LVL27:
 190:../../tmk_core/common/action_tapping.c ****             }  else {
 510               		.loc 1 190 17 view .LVU97
 511 00d8 00C0      		rjmp .L26
 512               	.LVL28:
 513               	.L29:
 190:../../tmk_core/common/action_tapping.c ****             }  else {
 514               		.loc 1 190 17 is_stmt 0 view .LVU98
 515               	.LBE77:
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 516               		.loc 1 84 13 discriminator 2 view .LVU99
 517 00da 8095      		com r24
 518 00dc 9095      		com r25
 519 00de 8A0D      		add r24,r10
 520 00e0 9B1D      		adc r25,r11
 521 00e2 00C0      		rjmp .L122
 522               	.L69:
  85:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 523               		.loc 1 85 13 is_stmt 1 view .LVU100
  85:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 524               		.loc 1 85 16 is_stmt 0 view .LVU101
 525 00e4 9111      		cpse r25,__zero_reg__
 526 00e6 00C0      		rjmp .L33
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 527               		.loc 1 86 17 is_stmt 1 view .LVU102
 528               	.LVL29:
 529               		.loc 2 49 51 view .LVU103
 530               	.LBB78:
 531               	.LBB79:
  50:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:../../tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 532               		.loc 2 51 88 is_stmt 0 view .LVU104
 533 00e8 EF2C      		mov r14,r15
 534               	.LVL30:
 535               		.loc 2 51 88 view .LVU105
 536               	.LBE79:
 537               	.LBE78:
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 538               		.loc 1 86 21 view .LVU106
 539 00ea 5213      		cpse r21,r18
 540 00ec 00C0      		rjmp .L34
 541               	.LVL31:
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 542               		.loc 1 86 21 discriminator 2 view .LVU107
 543 00ee 3413      		cpse r19,r20
 544 00f0 00C0      		rjmp .L34
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 545               		.loc 1 86 47 discriminator 3 view .LVU108
 546 00f2 F110      		cpse r15,__zero_reg__
 547 00f4 00C0      		rjmp .L34
  88:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 548               		.loc 1 88 21 is_stmt 1 view .LVU109
  89:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 549               		.loc 1 89 21 view .LVU110
  89:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 550               		.loc 1 89 43 is_stmt 0 view .LVU111
 551 00f6 8F70      		andi r24,lo8(15)
 552 00f8 8061      		ori r24,lo8(16)
 553 00fa 8093 0000 		sts tapping_key+5,r24
 554               	.LVL32:
  90:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
 555               		.loc 1 90 21 is_stmt 1 view .LVU112
 556 00fe 0E94 0000 		call debug_tapping_key
 557               	.LVL33:
  91:../../tmk_core/common/action_tapping.c **** 
 558               		.loc 1 91 21 view .LVU113
 559 0102 80E0      		ldi r24,lo8(tapping_key)
 560 0104 90E0      		ldi r25,hi8(tapping_key)
 561 0106 0E94 0000 		call process_action
 562               	.LVL34:
  94:../../tmk_core/common/action_tapping.c ****                     // enqueue
 563               		.loc 1 94 21 view .LVU114
  94:../../tmk_core/common/action_tapping.c ****                     // enqueue
 564               		.loc 1 94 31 is_stmt 0 view .LVU115
 565 010a 8091 0000 		lds r24,tapping_key+5
 566 010e D801      		movw r26,r16
 567 0110 1596      		adiw r26,5
 568 0112 8C93      		st X,r24
  96:../../tmk_core/common/action_tapping.c ****                 }
 569               		.loc 1 96 21 is_stmt 1 view .LVU116
 570               	.LVL35:
 571               	.L26:
 286:../../tmk_core/common/action_tapping.c **** 
 572               		.loc 1 286 1 is_stmt 0 view .LVU117
 573 0114 8E2D      		mov r24,r14
 574               	/* epilogue start */
 286:../../tmk_core/common/action_tapping.c **** 
 575               		.loc 1 286 1 view .LVU118
 576 0116 2B96      		adiw r28,11
 577 0118 0FB6      		in __tmp_reg__,__SREG__
 578 011a F894      		cli
 579 011c DEBF      		out __SP_H__,r29
 580 011e 0FBE      		out __SREG__,__tmp_reg__
 581 0120 CDBF      		out __SP_L__,r28
 582 0122 DF91      		pop r29
 583 0124 CF91      		pop r28
 584 0126 1F91      		pop r17
 585 0128 0F91      		pop r16
 586               	.LVL36:
 286:../../tmk_core/common/action_tapping.c **** 
 587               		.loc 1 286 1 view .LVU119
 588 012a FF90      		pop r15
 589               	.LVL37:
 286:../../tmk_core/common/action_tapping.c **** 
 590               		.loc 1 286 1 view .LVU120
 591 012c EF90      		pop r14
 592 012e DF90      		pop r13
 593 0130 CF90      		pop r12
 594 0132 BF90      		pop r11
 595 0134 AF90      		pop r10
 596 0136 9F90      		pop r9
 597 0138 0895      		ret
 598               	.LVL38:
 599               	.L34:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 600               		.loc 1 116 22 is_stmt 1 view .LVU121
 601               	.LBB84:
 602               	.LBI78:
 603               		.loc 2 51 20 view .LVU122
 604               	.LBB82:
 605               		.loc 2 51 52 view .LVU123
 606               	.LBB80:
 607               	.LBI80:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 608               		.loc 2 49 20 view .LVU124
 609               	.LBB81:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 610               		.loc 2 49 51 view .LVU125
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 611               		.loc 2 49 74 is_stmt 0 view .LVU126
 612 013a AB28      		or r10,r11
 613 013c 01F0      		breq .L71
 614 013e 842F      		mov r24,r20
 615 0140 8223      		and r24,r18
 616 0142 8F3F      		cpi r24,lo8(-1)
 617 0144 01F0      		breq .+2
 618 0146 00C0      		rjmp .L37
 619               	.L71:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 620               		.loc 2 49 74 view .LVU127
 621               	.LBE81:
 622               	.LBE80:
 623               		.loc 2 51 79 view .LVU128
 624 0148 80E0      		ldi r24,0
 625               	.LVL39:
 626               	.L36:
 627               		.loc 2 51 79 view .LVU129
 628               	.LBE82:
 629               	.LBE84:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 630               		.loc 1 116 25 view .LVU130
 631 014a B82F      		mov r27,r24
 632 014c B170      		andi r27,lo8(1)
 633 014e DB2E      		mov r13,r27
 634               	.LBB85:
 635               	.LBB86:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 636               		.loc 1 318 18 view .LVU131
 637 0150 E091 0000 		lds r30,waiting_buffer_tail
 638               	.LVL40:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 639               		.loc 1 318 45 view .LVU132
 640 0154 3091 0000 		lds r19,waiting_buffer_head
 641               	.LBE86:
 642               	.LBE85:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 643               		.loc 1 116 25 view .LVU133
 644 0158 80FD      		sbrc r24,0
 645 015a 00C0      		rjmp .L39
 646               	.L38:
 647               	.LVL41:
 138:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 648               		.loc 1 138 21 is_stmt 1 view .LVU134
 138:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 649               		.loc 1 138 24 is_stmt 0 view .LVU135
 650 015c FF20      		tst r15
 651 015e 01F0      		breq .L26
 139:../../tmk_core/common/action_tapping.c ****                     }
 652               		.loc 1 139 25 is_stmt 1 view .LVU136
 139:../../tmk_core/common/action_tapping.c ****                     }
 653               		.loc 1 139 53 is_stmt 0 view .LVU137
 654 0160 8091 0000 		lds r24,tapping_key+5
 655 0164 8160      		ori r24,lo8(1<<0)
 656 0166 8093 0000 		sts tapping_key+5,r24
 657               	.LVL42:
 658               	.L123:
 659               	.LBB88:
 270:../../tmk_core/common/action_tapping.c ****         }
 660               		.loc 1 270 13 is_stmt 1 view .LVU138
 270:../../tmk_core/common/action_tapping.c ****         }
 661               		.loc 1 270 20 is_stmt 0 view .LVU139
 662 016a E12C      		mov r14,__zero_reg__
 663 016c 00C0      		rjmp .L26
 664               	.LVL43:
 665               	.L41:
 270:../../tmk_core/common/action_tapping.c ****         }
 666               		.loc 1 270 20 view .LVU140
 667               	.LBE88:
 668               	.LBB89:
 669               	.LBB87:
 319:../../tmk_core/common/action_tapping.c ****             return true;
 670               		.loc 1 319 9 is_stmt 1 view .LVU141
 319:../../tmk_core/common/action_tapping.c ****             return true;
 671               		.loc 1 319 13 is_stmt 0 view .LVU142
 672 016e F0E0      		ldi r31,0
 673 0170 CF01      		movw r24,r30
 674 0172 66E0      		ldi r22,lo8(6)
 675 0174 70E0      		ldi r23,0
 676 0176 0E94 0000 		call __mulhi3
 677 017a DC01      		movw r26,r24
 678 017c A050      		subi r26,lo8(-(waiting_buffer))
 679 017e B040      		sbci r27,hi8(-(waiting_buffer))
 319:../../tmk_core/common/action_tapping.c ****             return true;
 680               		.loc 1 319 12 view .LVU143
 681 0180 1196      		adiw r26,1
 682 0182 8C91      		ld r24,X
 683 0184 1197      		sbiw r26,1
 684 0186 8213      		cpse r24,r18
 685 0188 00C0      		rjmp .L40
 319:../../tmk_core/common/action_tapping.c ****             return true;
 686               		.loc 1 319 13 view .LVU144
 687 018a 8C91      		ld r24,X
 688 018c 8413      		cpse r24,r20
 689 018e 00C0      		rjmp .L40
 319:../../tmk_core/common/action_tapping.c ****             return true;
 690               		.loc 1 319 59 view .LVU145
 691 0190 1296      		adiw r26,2
 692 0192 8C91      		ld r24,X
 693 0194 8F11      		cpse r24,r15
 694 0196 00C0      		rjmp .L38
 695               	.L40:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 696               		.loc 1 318 69 is_stmt 1 view .LVU146
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 697               		.loc 1 318 76 is_stmt 0 view .LVU147
 698 0198 3196      		adiw r30,1
 699               	.LVL44:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 700               		.loc 1 318 71 view .LVU148
 701 019a E770      		andi r30,lo8(7)
 702               	.L39:
 703               	.LVL45:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 704               		.loc 1 318 43 is_stmt 1 view .LVU149
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 705               		.loc 1 318 5 is_stmt 0 view .LVU150
 706 019c E313      		cpse r30,r19
 707 019e 00C0      		rjmp .L41
 708               	.LVL46:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 709               		.loc 1 318 5 view .LVU151
 710               	.LBE87:
 711               	.LBE89:
 712               	.LBB90:
 118:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 713               		.loc 1 118 21 is_stmt 1 view .LVU152
 118:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 714               		.loc 1 118 39 is_stmt 0 view .LVU153
 715 01a0 522F      		mov r21,r18
 716 01a2 6F2D      		mov r22,r15
 717 01a4 7A85      		ldd r23,Y+10
 718 01a6 8B85      		ldd r24,Y+11
 719 01a8 0E94 0000 		call layer_switch_get_action
 720               	.LVL47:
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 721               		.loc 1 119 21 is_stmt 1 view .LVU154
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 722               		.loc 1 119 40 is_stmt 0 view .LVU155
 723 01ac 292F      		mov r18,r25
 724 01ae 2295      		swap r18
 725 01b0 2F70      		andi r18,lo8(15)
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 726               		.loc 1 119 21 view .LVU156
 727 01b2 9032      		cpi r25,lo8(32)
 728 01b4 00F0      		brlo .L62
 729 01b6 225F      		subi r18,lo8(-(14))
 730 01b8 2F70      		andi r18,lo8(15)
 731 01ba 2230      		cpi r18,lo8(2)
 732 01bc 00F4      		brsh .L45
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 733               		.loc 1 127 29 is_stmt 1 view .LVU157
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 734               		.loc 1 127 33 is_stmt 0 view .LVU158
 735 01be 9F70      		andi r25,lo8(15)
 736               	.LVL48:
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 737               		.loc 1 127 32 view .LVU159
 738 01c0 01F0      		breq .L46
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 739               		.loc 1 127 68 discriminator 1 view .LVU160
 740 01c2 F801      		movw r30,r16
 741 01c4 9581      		ldd r25,Z+5
 742 01c6 907F      		andi r25,lo8(-16)
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 743               		.loc 1 127 49 discriminator 1 view .LVU161
 744 01c8 01F4      		brne .L46
 745               	.LVL49:
 746               	.L75:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 747               		.loc 1 122 77 view .LVU162
 748 01ca D12C      		mov r13,__zero_reg__
 749 01cc 00C0      		rjmp .L44
 750               	.LVL50:
 751               	.L62:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 752               		.loc 1 122 29 is_stmt 1 view .LVU163
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 753               		.loc 1 122 33 is_stmt 0 view .LVU164
 754 01ce 9F70      		andi r25,lo8(15)
 755               	.LVL51:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 756               		.loc 1 122 32 view .LVU165
 757 01d0 01F0      		breq .L46
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 758               		.loc 1 122 49 discriminator 1 view .LVU166
 759 01d2 8823      		tst r24
 760 01d4 01F0      		breq .L75
 761               	.L46:
 128:../../tmk_core/common/action_tapping.c ****                             break;
 762               		.loc 1 128 29 is_stmt 1 view .LVU167
 128:../../tmk_core/common/action_tapping.c ****                             break;
 763               		.loc 1 128 33 is_stmt 0 view .LVU168
 764 01d6 805E      		subi r24,lo8(-(32))
 765               	.LVL52:
 128:../../tmk_core/common/action_tapping.c ****                             break;
 766               		.loc 1 128 32 view .LVU169
 767 01d8 8830      		cpi r24,lo8(8)
 768 01da 00F0      		brlo .L75
 769               	.LVL53:
 770               	.L45:
 132:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 771               		.loc 1 132 21 is_stmt 1 view .LVU170
 133:../../tmk_core/common/action_tapping.c ****                     return true;
 772               		.loc 1 133 21 view .LVU171
 773 01dc C801      		movw r24,r16
 774               	.LVL54:
 133:../../tmk_core/common/action_tapping.c ****                     return true;
 775               		.loc 1 133 21 is_stmt 0 view .LVU172
 776 01de 0E94 0000 		call process_action
 777               	.LVL55:
 134:../../tmk_core/common/action_tapping.c ****                 }
 778               		.loc 1 134 21 is_stmt 1 view .LVU173
 779               	.L44:
 134:../../tmk_core/common/action_tapping.c ****                 }
 780               		.loc 1 134 21 is_stmt 0 view .LVU174
 781 01e2 ED2C      		mov r14,r13
 782               	.LVL56:
 134:../../tmk_core/common/action_tapping.c ****                 }
 783               		.loc 1 134 21 view .LVU175
 784 01e4 00C0      		rjmp .L26
 785               	.LVL57:
 786               	.L54:
 134:../../tmk_core/common/action_tapping.c ****                 }
 787               		.loc 1 134 21 view .LVU176
 788               	.LBE90:
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 789               		.loc 1 227 13 discriminator 2 view .LVU177
 790 01e6 8095      		com r24
 791 01e8 9095      		com r25
 792 01ea A80E      		add r10,r24
 793 01ec B91E      		adc r11,r25
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 794               		.loc 1 227 12 discriminator 2 view .LVU178
 795 01ee 68EC      		ldi r22,-56
 796 01f0 A616      		cp r10,r22
 797 01f2 B104      		cpc r11,__zero_reg__
 798 01f4 00F0      		brlo .+2
 799 01f6 00C0      		rjmp .L56
 800               	.L55:
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 801               		.loc 1 228 13 is_stmt 1 view .LVU179
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 802               		.loc 1 228 22 is_stmt 0 view .LVU180
 803 01f8 EF2C      		mov r14,r15
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 804               		.loc 1 228 16 view .LVU181
 805 01fa F110      		cpse r15,__zero_reg__
 806 01fc 00C0      		rjmp .L57
 807               	.LVL58:
 808               	.L58:
 174:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 809               		.loc 1 174 21 is_stmt 1 view .LVU182
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 810               		.loc 2 49 51 view .LVU183
 175:../../tmk_core/common/action_tapping.c ****                     }
 811               		.loc 1 175 25 view .LVU184
 177:../../tmk_core/common/action_tapping.c ****                     return true;
 812               		.loc 1 177 21 view .LVU185
 813 01fe C801      		movw r24,r16
 814 0200 0E94 0000 		call process_action
 815               	.LVL59:
 816 0204 00C0      		rjmp .L125
 817               	.LVL60:
 818               	.L60:
 241:../../tmk_core/common/action_tapping.c ****                         return true;
 819               		.loc 1 241 25 view .LVU186
 241:../../tmk_core/common/action_tapping.c ****                         return true;
 820               		.loc 1 241 37 is_stmt 0 view .LVU187
 821 0206 86E0      		ldi r24,lo8(6)
 822 0208 F801      		movw r30,r16
 823 020a A0E0      		ldi r26,lo8(tapping_key)
 824 020c B0E0      		ldi r27,hi8(tapping_key)
 825               		0:
 826 020e 0190      		ld r0,Z+
 827 0210 0D92      		st X+,r0
 828 0212 8A95      		dec r24
 829 0214 01F4      		brne 0b
 242:../../tmk_core/common/action_tapping.c ****                     }
 830               		.loc 1 242 25 is_stmt 1 view .LVU188
 242:../../tmk_core/common/action_tapping.c ****                     }
 831               		.loc 1 242 32 is_stmt 0 view .LVU189
 832 0216 00C0      		rjmp .L26
 833               	.L59:
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 834               		.loc 1 244 24 is_stmt 1 view .LVU190
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 835               		.loc 1 244 28 is_stmt 0 view .LVU191
 836 0218 4F83      		std Y+7,r20
 837 021a 2887      		std Y+8,r18
 838 021c F986      		std Y+9,r15
 839 021e 522F      		mov r21,r18
 840 0220 6F2D      		mov r22,r15
 841 0222 7A85      		ldd r23,Y+10
 842 0224 8B85      		ldd r24,Y+11
 843 0226 0E94 0000 		call is_tap_key
 844               	.LVL61:
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 845               		.loc 1 244 27 view .LVU192
 846 022a 8111      		cpse r24,__zero_reg__
 847 022c 00C0      		rjmp .L50
 254:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 848               		.loc 1 254 21 is_stmt 1 view .LVU193
 254:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 849               		.loc 1 254 49 is_stmt 0 view .LVU194
 850 022e 8091 0000 		lds r24,tapping_key+5
 851 0232 8160      		ori r24,lo8(1<<0)
 852 0234 8093 0000 		sts tapping_key+5,r24
 255:../../tmk_core/common/action_tapping.c ****                     return true;
 853               		.loc 1 255 21 is_stmt 1 view .LVU195
 854 0238 C801      		movw r24,r16
 855 023a 0E94 0000 		call process_action
 856               	.LVL62:
 256:../../tmk_core/common/action_tapping.c ****                 }
 857               		.loc 1 256 21 view .LVU196
 256:../../tmk_core/common/action_tapping.c ****                 }
 858               		.loc 1 256 28 is_stmt 0 view .LVU197
 859 023e 00C0      		rjmp .L26
 860               	.LVL63:
 861               	.L37:
 862               	.LBB91:
 863               	.LBB83:
 864               		.loc 2 51 79 view .LVU198
 865 0240 81E0      		ldi r24,lo8(1)
 866 0242 8F25      		eor r24,r15
 867 0244 00C0      		rjmp .L36
 868               	.LVL64:
 869               	.L33:
 870               		.loc 2 51 79 view .LVU199
 871               	.LBE83:
 872               	.LBE91:
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 873               		.loc 1 147 17 is_stmt 1 view .LVU200
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 874               		.loc 2 49 51 view .LVU201
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 875               		.loc 1 147 21 is_stmt 0 view .LVU202
 876 0246 5213      		cpse r21,r18
 877 0248 00C0      		rjmp .L47
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 878               		.loc 1 147 21 discriminator 2 view .LVU203
 879 024a 3413      		cpse r19,r20
 880 024c 00C0      		rjmp .L47
 149:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 881               		.loc 1 149 31 discriminator 3 view .LVU204
 882 024e D801      		movw r26,r16
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 883               		.loc 1 147 47 discriminator 3 view .LVU205
 884 0250 FF20      		tst r15
 885 0252 01F4      		brne .+2
 886 0254 00C0      		rjmp .L128
 887               	.L47:
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 888               		.loc 1 155 22 is_stmt 1 view .LVU206
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 889               		.loc 1 155 26 is_stmt 0 view .LVU207
 890 0256 4F83      		std Y+7,r20
 891 0258 2887      		std Y+8,r18
 892 025a F986      		std Y+9,r15
 893 025c 522F      		mov r21,r18
 894 025e 6F2D      		mov r22,r15
 895 0260 7A85      		ldd r23,Y+10
 896 0262 8B85      		ldd r24,Y+11
 897 0264 0E94 0000 		call is_tap_key
 898               	.LVL65:
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 899               		.loc 1 155 25 view .LVU208
 900 0268 8823      		tst r24
 901 026a 01F0      		breq .L58
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 902               		.loc 1 155 44 discriminator 1 view .LVU209
 903 026c FF20      		tst r15
 904 026e 01F0      		breq .L58
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 905               		.loc 1 156 21 is_stmt 1 view .LVU210
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 906               		.loc 1 156 40 is_stmt 0 view .LVU211
 907 0270 8091 0000 		lds r24,tapping_key+5
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 908               		.loc 1 156 24 view .LVU212
 909 0274 8032      		cpi r24,lo8(32)
 910 0276 00F0      		brlo .L50
 911               	.LBB92:
 157:../../tmk_core/common/action_tapping.c ****                         // unregister key
 912               		.loc 1 157 25 is_stmt 1 view .LVU213
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 913               		.loc 1 159 25 view .LVU214
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 914               		.loc 1 159 54 is_stmt 0 view .LVU215
 915 0278 2091 0000 		lds r18,tapping_key
 916 027c 3091 0000 		lds r19,tapping_key+1
 917 0280 3A83      		std Y+2,r19
 918 0282 2983      		std Y+1,r18
 919 0284 1B82      		std Y+3,__zero_reg__
 920 0286 BD82      		std Y+5,r11
 921 0288 AC82      		std Y+4,r10
 922 028a 8E83      		std Y+6,r24
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 923               		.loc 1 159 25 view .LVU216
 924 028c CE01      		movw r24,r28
 925 028e 0196      		adiw r24,1
 926 0290 0E94 0000 		call process_action
 927               	.LVL66:
 928               	.L50:
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 929               		.loc 1 159 25 view .LVU217
 930               	.LBE92:
 166:../../tmk_core/common/action_tapping.c ****                     }
 931               		.loc 1 166 25 is_stmt 1 view .LVU218
 168:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 932               		.loc 1 168 21 view .LVU219
 168:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 933               		.loc 1 168 33 is_stmt 0 view .LVU220
 934 0294 86E0      		ldi r24,lo8(6)
 935 0296 F801      		movw r30,r16
 936 0298 A0E0      		ldi r26,lo8(tapping_key)
 937 029a B0E0      		ldi r27,hi8(tapping_key)
 938               		0:
 939 029c 0190      		ld r0,Z+
 940 029e 0D92      		st X+,r0
 941 02a0 8A95      		dec r24
 942 02a2 01F4      		brne 0b
 169:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 943               		.loc 1 169 21 is_stmt 1 view .LVU221
 944 02a4 0E94 0000 		call waiting_buffer_scan_tap
 945               	.LVL67:
 170:../../tmk_core/common/action_tapping.c ****                     return true;
 946               		.loc 1 170 21 view .LVU222
 947 02a8 0E94 0000 		call debug_tapping_key
 948               	.LVL68:
 171:../../tmk_core/common/action_tapping.c ****                 }
 949               		.loc 1 171 21 view .LVU223
 950               	.L125:
 178:../../tmk_core/common/action_tapping.c ****                 }
 951               		.loc 1 178 21 view .LVU224
 178:../../tmk_core/common/action_tapping.c ****                 }
 952               		.loc 1 178 28 is_stmt 0 view .LVU225
 953 02ac EE24      		clr r14
 954 02ae E394      		inc r14
 955 02b0 00C0      		rjmp .L26
 956               	.LVL69:
 957               	.L51:
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 958               		.loc 1 192 17 is_stmt 1 view .LVU226
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 959               		.loc 2 49 51 view .LVU227
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 960               		.loc 1 192 21 is_stmt 0 view .LVU228
 961 02b2 5213      		cpse r21,r18
 962 02b4 00C0      		rjmp .L47
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 963               		.loc 1 192 21 discriminator 2 view .LVU229
 964 02b6 3413      		cpse r19,r20
 965 02b8 00C0      		rjmp .L47
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 966               		.loc 1 192 47 discriminator 3 view .LVU230
 967 02ba F110      		cpse r15,__zero_reg__
 968 02bc 00C0      		rjmp .L47
 969               	.LBB93:
 193:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 970               		.loc 1 193 21 is_stmt 1 view .LVU231
 194:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 971               		.loc 1 194 21 view .LVU232
 194:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 972               		.loc 1 194 31 is_stmt 0 view .LVU233
 973 02be D801      		movw r26,r16
 974 02c0 1596      		adiw r26,5
 975 02c2 8C93      		st X,r24
 195:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 976               		.loc 1 195 21 is_stmt 1 view .LVU234
 977 02c4 C801      		movw r24,r16
 978 02c6 0E94 0000 		call process_action
 979               	.LVL70:
 196:../../tmk_core/common/action_tapping.c ****                     return true;
 980               		.loc 1 196 21 view .LVU235
 196:../../tmk_core/common/action_tapping.c ****                     return true;
 981               		.loc 1 196 33 is_stmt 0 view .LVU236
 982 02ca 86E0      		ldi r24,lo8(6)
 983 02cc F601      		movw r30,r12
 984               		0:
 985 02ce 1192      		st Z+,__zero_reg__
 986 02d0 8A95      		dec r24
 987 02d2 01F4      		brne 0b
 197:../../tmk_core/common/action_tapping.c ****                 }
 988               		.loc 1 197 21 is_stmt 1 view .LVU237
 197:../../tmk_core/common/action_tapping.c ****                 }
 989               		.loc 1 197 28 is_stmt 0 view .LVU238
 990 02d4 E92C      		mov r14,r9
 991 02d6 00C0      		rjmp .L26
 992               	.LVL71:
 993               	.L57:
 197:../../tmk_core/common/action_tapping.c ****                 }
 994               		.loc 1 197 28 view .LVU239
 995               	.LBE93:
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 996               		.loc 1 229 17 is_stmt 1 view .LVU240
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 997               		.loc 2 49 51 view .LVU241
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 998               		.loc 1 229 21 is_stmt 0 view .LVU242
 999 02d8 5213      		cpse r21,r18
 1000 02da 00C0      		rjmp .L59
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 1001               		.loc 1 229 21 discriminator 2 view .LVU243
 1002 02dc 3413      		cpse r19,r20
 1003 02de 00C0      		rjmp .L59
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 1004               		.loc 1 230 21 is_stmt 1 view .LVU244
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 1005               		.loc 1 230 41 is_stmt 0 view .LVU245
 1006 02e0 8091 0000 		lds r24,tapping_key+5
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 1007               		.loc 1 230 24 view .LVU246
 1008 02e4 80FD      		sbrc r24,0
 1009 02e6 00C0      		rjmp .L60
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 1010               		.loc 1 230 79 discriminator 1 view .LVU247
 1011 02e8 982F      		mov r25,r24
 1012 02ea 907F      		andi r25,lo8(-16)
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 1013               		.loc 1 230 54 discriminator 1 view .LVU248
 1014 02ec 01F4      		brne .+2
 1015 02ee 00C0      		rjmp .L60
 232:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 1016               		.loc 1 232 25 is_stmt 1 view .LVU249
 232:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 1017               		.loc 1 232 35 is_stmt 0 view .LVU250
 1018 02f0 D801      		movw r26,r16
 1019 02f2 1596      		adiw r26,5
 1020 02f4 8C93      		st X,r24
 1021 02f6 1597      		sbiw r26,5
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1022               		.loc 1 233 25 is_stmt 1 view .LVU251
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1023               		.loc 1 233 28 is_stmt 0 view .LVU252
 1024 02f8 903F      		cpi r25,lo8(-16)
 1025 02fa 01F0      		breq .L61
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1026               		.loc 1 233 51 is_stmt 1 discriminator 1 view .LVU253
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1027               		.loc 1 233 67 is_stmt 0 discriminator 1 view .LVU254
 1028 02fc 982F      		mov r25,r24
 1029 02fe 907F      		andi r25,lo8(-16)
 1030 0300 905F      		subi r25,lo8(-(16))
 1031 0302 8F70      		andi r24,lo8(15)
 1032 0304 892B      		or r24,r25
 1033               	.LVL72:
 1034               	.L128:
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1035               		.loc 1 233 67 discriminator 1 view .LVU255
 1036 0306 1596      		adiw r26,5
 1037 0308 8C93      		st X,r24
 1038               	.L61:
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 1039               		.loc 1 234 25 is_stmt 1 view .LVU256
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 1040               		.loc 1 234 55 view .LVU257
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 1041               		.loc 1 234 83 view .LVU258
 235:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 1042               		.loc 1 235 25 view .LVU259
 1043 030a C801      		movw r24,r16
 1044 030c 0E94 0000 		call process_action
 1045               	.LVL73:
 236:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1046               		.loc 1 236 25 view .LVU260
 236:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1047               		.loc 1 236 37 is_stmt 0 view .LVU261
 1048 0310 86E0      		ldi r24,lo8(6)
 1049 0312 F801      		movw r30,r16
 1050 0314 A0E0      		ldi r26,lo8(tapping_key)
 1051 0316 B0E0      		ldi r27,hi8(tapping_key)
 1052               		0:
 1053 0318 0190      		ld r0,Z+
 1054 031a 0D92      		st X+,r0
 1055 031c 8A95      		dec r24
 1056 031e 01F4      		brne 0b
 237:../../tmk_core/common/action_tapping.c ****                         return true;
 1057               		.loc 1 237 25 is_stmt 1 view .LVU262
 1058 0320 00C0      		rjmp .L124
 1059               	.LVL74:
 1060               	.L115:
  80:../../tmk_core/common/action_tapping.c **** 
 1061               		.loc 1 80 16 is_stmt 0 view .LVU263
 1062 0322 F801      		movw r30,r16
 1063 0324 A380      		ldd r10,Z+3
 1064 0326 B480      		ldd r11,Z+4
 1065               	.LVL75:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 1066               		.loc 1 83 9 view .LVU264
 1067 0328 9090 0000 		lds r9,tapping_key+2
 1068 032c 9110      		cpse r9,__zero_reg__
 1069 032e 00C0      		rjmp .L67
 226:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 1070               		.loc 1 226 12 is_stmt 1 view .LVU265
 1071               	.LVL76:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1072               		.loc 2 49 51 view .LVU266
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1073               		.loc 1 227 9 view .LVU267
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1074               		.loc 1 227 13 is_stmt 0 view .LVU268
 1075 0330 A816      		cp r10,r24
 1076 0332 B906      		cpc r11,r25
 1077 0334 00F4      		brsh .+2
 1078 0336 00C0      		rjmp .L54
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1079               		.loc 1 227 13 discriminator 1 view .LVU269
 1080 0338 A81A      		sub r10,r24
 1081 033a B90A      		sbc r11,r25
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1082               		.loc 1 227 12 discriminator 1 view .LVU270
 1083 033c F8EC      		ldi r31,-56
 1084 033e AF16      		cp r10,r31
 1085 0340 B104      		cpc r11,__zero_reg__
 1086 0342 00F4      		brsh .+2
 1087 0344 00C0      		rjmp .L55
 1088               	.L56:
 1089               	.LBB94:
 266:../../tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 1090               		.loc 1 266 13 is_stmt 1 view .LVU271
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1091               		.loc 1 267 13 view .LVU272
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1092               		.loc 1 267 13 is_stmt 0 view .LVU273
 1093 0346 522F      		mov r21,r18
 1094 0348 6F2D      		mov r22,r15
 1095 034a 7A85      		ldd r23,Y+10
 1096 034c 8B85      		ldd r24,Y+11
 1097 034e 0E94 0000 		call debug_event
 1098               	.LVL77:
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1099               		.loc 1 267 33 is_stmt 1 view .LVU274
 268:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1100               		.loc 1 268 13 view .LVU275
 268:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1101               		.loc 1 268 25 is_stmt 0 view .LVU276
 1102 0352 86E0      		ldi r24,lo8(6)
 1103 0354 E0E0      		ldi r30,lo8(tapping_key)
 1104 0356 F0E0      		ldi r31,hi8(tapping_key)
 1105 0358 DF01      		movw r26,r30
 1106               		0:
 1107 035a 1D92      		st X+,__zero_reg__
 1108 035c 8A95      		dec r24
 1109 035e 01F4      		brne 0b
 269:../../tmk_core/common/action_tapping.c ****             return false;
 1110               		.loc 1 269 13 is_stmt 1 view .LVU277
 1111 0360 0E94 0000 		call debug_tapping_key
 1112               	.LVL78:
 1113 0364 00C0      		rjmp .L123
 1114               	.LBE94:
 1115               		.cfi_endproc
 1116               	.LFE5:
 1118               		.section	.text.action_tapping_process,"ax",@progbits
 1119               	.global	action_tapping_process
 1121               	action_tapping_process:
 1122               	.LFB4:
  39:../../tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1123               		.loc 1 39 1 view -0
 1124               		.cfi_startproc
 1125 0000 CF93      		push r28
 1126               	.LCFI20:
 1127               		.cfi_def_cfa_offset 3
 1128               		.cfi_offset 28, -2
 1129 0002 DF93      		push r29
 1130               	.LCFI21:
 1131               		.cfi_def_cfa_offset 4
 1132               		.cfi_offset 29, -3
 1133 0004 CDB7      		in r28,__SP_L__
 1134 0006 DEB7      		in r29,__SP_H__
 1135               	.LCFI22:
 1136               		.cfi_def_cfa_register 28
 1137 0008 2C97      		sbiw r28,12
 1138               	.LCFI23:
 1139               		.cfi_def_cfa_offset 16
 1140 000a 0FB6      		in __tmp_reg__,__SREG__
 1141 000c F894      		cli
 1142 000e DEBF      		out __SP_H__,r29
 1143 0010 0FBE      		out __SREG__,__tmp_reg__
 1144 0012 CDBF      		out __SP_L__,r28
 1145               	/* prologue: function */
 1146               	/* frame size = 12 */
 1147               	/* stack size = 14 */
 1148               	.L__stack_usage = 14
 1149 0014 4F83      		std Y+7,r20
 1150 0016 5887      		std Y+8,r21
 1151 0018 6987      		std Y+9,r22
 1152 001a 7A87      		std Y+10,r23
 1153 001c 8B87      		std Y+11,r24
 1154 001e 9C87      		std Y+12,r25
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1155               		.loc 1 40 5 view .LVU279
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1156               		.loc 1 40 9 is_stmt 0 view .LVU280
 1157 0020 CE01      		movw r24,r28
 1158 0022 0796      		adiw r24,7
 1159 0024 0E94 0000 		call process_tapping
 1160               	.LVL79:
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1161               		.loc 1 40 8 view .LVU281
 1162 0028 8823      		tst r24
 1163 002a 01F0      		breq .L133
  41:../../tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1164               		.loc 1 41 9 is_stmt 1 view .LVU282
 1165               	.LVL80:
 1166               	.LBB104:
 1167               	.LBI104:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1168               		.loc 2 49 20 view .LVU283
 1169               	.LBB105:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1170               		.loc 2 49 51 view .LVU284
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1171               		.loc 2 49 74 is_stmt 0 view .LVU285
 1172 002c 8A85      		ldd r24,Y+10
 1173 002e 9B85      		ldd r25,Y+11
 1174 0030 892B      		or r24,r25
 1175 0032 01F0      		breq .L141
 1176 0034 5885      		ldd r21,Y+8
 1177 0036 4F81      		ldd r20,Y+7
 1178 0038 852F      		mov r24,r21
 1179 003a 8423      		and r24,r20
 1180 003c 8F3F      		cpi r24,lo8(-1)
 1181 003e 01F0      		breq .+2
 1182 0040 00C0      		rjmp .L156
 1183               	.LVL81:
 1184               	.L141:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1185               		.loc 2 49 74 view .LVU286
 1186               	.LBE105:
 1187               	.LBE104:
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1188               		.loc 1 58 12 is_stmt 1 discriminator 1 view .LVU287
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1189               		.loc 1 58 32 is_stmt 0 discriminator 1 view .LVU288
 1190 0042 8091 0000 		lds r24,waiting_buffer_tail
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1191               		.loc 1 58 5 discriminator 1 view .LVU289
 1192 0046 9091 0000 		lds r25,waiting_buffer_head
 1193 004a 8913      		cpse r24,r25
 1194 004c 00C0      		rjmp .L139
 1195               	.L132:
 1196               	/* epilogue start */
  69:../../tmk_core/common/action_tapping.c **** 
 1197               		.loc 1 69 1 view .LVU290
 1198 004e 2C96      		adiw r28,12
 1199 0050 0FB6      		in __tmp_reg__,__SREG__
 1200 0052 F894      		cli
 1201 0054 DEBF      		out __SP_H__,r29
 1202 0056 0FBE      		out __SREG__,__tmp_reg__
 1203 0058 CDBF      		out __SP_L__,r28
 1204 005a DF91      		pop r29
 1205 005c CF91      		pop r28
 1206 005e 0895      		ret
 1207               	.L133:
  45:../../tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1208               		.loc 1 45 9 is_stmt 1 view .LVU291
 1209 0060 86E0      		ldi r24,lo8(6)
 1210 0062 FE01      		movw r30,r28
 1211 0064 3796      		adiw r30,7
 1212 0066 DE01      		movw r26,r28
 1213 0068 1196      		adiw r26,1
 1214               		0:
 1215 006a 0190      		ld r0,Z+
 1216 006c 0D92      		st X+,r0
 1217 006e 8A95      		dec r24
 1218 0070 01F4      		brne 0b
 1219               	.LVL82:
 1220               	.LBB106:
 1221               	.LBI106:
 292:../../tmk_core/common/action_tapping.c **** {
 1222               		.loc 1 292 6 view .LVU292
 1223               	.LBB107:
 294:../../tmk_core/common/action_tapping.c ****         return true;
 1224               		.loc 1 294 5 view .LVU293
 1225               	.LBB108:
 1226               	.LBI108:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1227               		.loc 2 49 20 view .LVU294
 1228               	.LBB109:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1229               		.loc 2 49 51 view .LVU295
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1230               		.loc 2 49 74 is_stmt 0 view .LVU296
 1231 0072 8A85      		ldd r24,Y+10
 1232 0074 9B85      		ldd r25,Y+11
 1233 0076 892B      		or r24,r25
 1234 0078 01F0      		breq .L141
 1235 007a 8F81      		ldd r24,Y+7
 1236 007c 9885      		ldd r25,Y+8
 1237 007e 8923      		and r24,r25
 1238 0080 8F3F      		cpi r24,lo8(-1)
 1239 0082 01F0      		breq .L141
 1240               	.LVL83:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1241               		.loc 2 49 74 view .LVU297
 1242               	.LBE109:
 1243               	.LBE108:
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1244               		.loc 1 298 5 is_stmt 1 view .LVU298
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1245               		.loc 1 298 30 is_stmt 0 view .LVU299
 1246 0084 8091 0000 		lds r24,waiting_buffer_head
 1247 0088 90E0      		ldi r25,0
 1248 008a 9C01      		movw r18,r24
 1249 008c 2F5F      		subi r18,-1
 1250 008e 3F4F      		sbci r19,-1
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1251               		.loc 1 298 35 view .LVU300
 1252 0090 2770      		andi r18,7
 1253 0092 3327      		clr r19
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1254               		.loc 1 298 57 view .LVU301
 1255 0094 4091 0000 		lds r20,waiting_buffer_tail
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1256               		.loc 1 298 8 view .LVU302
 1257 0098 4217      		cp r20,r18
 1258 009a 1306      		cpc __zero_reg__,r19
 1259 009c 01F4      		brne .L158
 1260               	.LVL84:
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1261               		.loc 1 298 8 view .LVU303
 1262               	.LBE107:
 1263               	.LBE106:
 1264               	.LBB111:
  47:../../tmk_core/common/action_tapping.c ****             clear_keyboard();
 1265               		.loc 1 47 13 is_stmt 1 view .LVU304
  48:../../tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1266               		.loc 1 48 13 view .LVU305
 1267 009e 0E94 0000 		call clear_keyboard
 1268               	.LVL85:
  49:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1269               		.loc 1 49 13 view .LVU306
 1270               	.LBB112:
 1271               	.LBI112:
 310:../../tmk_core/common/action_tapping.c **** {
 1272               		.loc 1 310 6 view .LVU307
 1273               	.LBB113:
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1274               		.loc 1 312 5 view .LVU308
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1275               		.loc 1 312 25 is_stmt 0 view .LVU309
 1276 00a2 1092 0000 		sts waiting_buffer_head,__zero_reg__
 313:../../tmk_core/common/action_tapping.c **** }
 1277               		.loc 1 313 5 is_stmt 1 view .LVU310
 313:../../tmk_core/common/action_tapping.c **** }
 1278               		.loc 1 313 25 is_stmt 0 view .LVU311
 1279 00a6 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1280               	.LBE113:
 1281               	.LBE112:
  50:../../tmk_core/common/action_tapping.c ****         }
 1282               		.loc 1 50 13 is_stmt 1 view .LVU312
  50:../../tmk_core/common/action_tapping.c ****         }
 1283               		.loc 1 50 25 is_stmt 0 view .LVU313
 1284 00aa 86E0      		ldi r24,lo8(6)
 1285 00ac E0E0      		ldi r30,lo8(tapping_key)
 1286 00ae F0E0      		ldi r31,hi8(tapping_key)
 1287 00b0 DF01      		movw r26,r30
 1288               		0:
 1289 00b2 1D92      		st X+,__zero_reg__
 1290 00b4 8A95      		dec r24
 1291 00b6 01F4      		brne 0b
 1292 00b8 00C0      		rjmp .L141
 1293               	.LVL86:
 1294               	.L158:
  50:../../tmk_core/common/action_tapping.c ****         }
 1295               		.loc 1 50 25 view .LVU314
 1296               	.LBE111:
 1297               	.LBB114:
 1298               	.LBB110:
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1299               		.loc 1 303 5 is_stmt 1 view .LVU315
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1300               		.loc 1 303 41 is_stmt 0 view .LVU316
 1301 00ba 66E0      		ldi r22,lo8(6)
 1302 00bc 70E0      		ldi r23,0
 1303 00be 0E94 0000 		call __mulhi3
 1304 00c2 DC01      		movw r26,r24
 1305 00c4 A050      		subi r26,lo8(-(waiting_buffer))
 1306 00c6 B040      		sbci r27,hi8(-(waiting_buffer))
 1307 00c8 86E0      		ldi r24,lo8(6)
 1308 00ca FE01      		movw r30,r28
 1309 00cc 3196      		adiw r30,1
 1310               		0:
 1311 00ce 0190      		ld r0,Z+
 1312 00d0 0D92      		st X+,r0
 1313 00d2 8A95      		dec r24
 1314 00d4 01F4      		brne 0b
 304:../../tmk_core/common/action_tapping.c **** 
 1315               		.loc 1 304 5 is_stmt 1 view .LVU317
 304:../../tmk_core/common/action_tapping.c **** 
 1316               		.loc 1 304 25 is_stmt 0 view .LVU318
 1317 00d6 2093 0000 		sts waiting_buffer_head,r18
 306:../../tmk_core/common/action_tapping.c ****     return true;
 1318               		.loc 1 306 5 is_stmt 1 view .LVU319
 306:../../tmk_core/common/action_tapping.c ****     return true;
 1319               		.loc 1 306 36 view .LVU320
 1320 00da 0E94 0000 		call debug_waiting_buffer
 1321               	.LVL87:
 307:../../tmk_core/common/action_tapping.c **** }
 1322               		.loc 1 307 5 view .LVU321
 307:../../tmk_core/common/action_tapping.c **** }
 1323               		.loc 1 307 5 is_stmt 0 view .LVU322
 1324 00de 00C0      		rjmp .L141
 1325               	.L139:
 1326               	.LBE110:
 1327               	.LBE114:
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1328               		.loc 1 59 9 is_stmt 1 view .LVU323
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1329               		.loc 1 59 13 is_stmt 0 view .LVU324
 1330 00e0 90E0      		ldi r25,0
 1331 00e2 66E0      		ldi r22,lo8(6)
 1332 00e4 70E0      		ldi r23,0
 1333 00e6 0E94 0000 		call __mulhi3
 1334 00ea 8050      		subi r24,lo8(-(waiting_buffer))
 1335 00ec 9040      		sbci r25,hi8(-(waiting_buffer))
 1336 00ee 0E94 0000 		call process_tapping
 1337               	.LVL88:
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1338               		.loc 1 59 12 view .LVU325
 1339 00f2 8823      		tst r24
 1340 00f4 01F4      		brne .+2
 1341 00f6 00C0      		rjmp .L132
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1342               		.loc 1 60 13 is_stmt 1 view .LVU326
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1343               		.loc 1 60 50 view .LVU327
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1344               		.loc 1 60 82 view .LVU328
  61:../../tmk_core/common/action_tapping.c ****         } else {
 1345               		.loc 1 61 13 view .LVU329
 1346 00f8 8091 0000 		lds r24,waiting_buffer_tail
 1347 00fc 90E0      		ldi r25,0
 1348 00fe 66E0      		ldi r22,lo8(6)
 1349 0100 70E0      		ldi r23,0
 1350 0102 0E94 0000 		call __mulhi3
 1351 0106 FC01      		movw r30,r24
 1352 0108 E050      		subi r30,lo8(-(waiting_buffer))
 1353 010a F040      		sbci r31,hi8(-(waiting_buffer))
 1354 010c 4081      		ld r20,Z
 1355 010e 5181      		ldd r21,Z+1
 1356 0110 6281      		ldd r22,Z+2
 1357 0112 7381      		ldd r23,Z+3
 1358 0114 8481      		ldd r24,Z+4
 1359 0116 9581      		ldd r25,Z+5
 1360 0118 0E94 0000 		call debug_record
 1361               	.LVL89:
  61:../../tmk_core/common/action_tapping.c ****         } else {
 1362               		.loc 1 61 64 view .LVU330
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1363               		.loc 1 58 56 view .LVU331
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1364               		.loc 1 58 99 is_stmt 0 view .LVU332
 1365 011c 8091 0000 		lds r24,waiting_buffer_tail
 1366 0120 90E0      		ldi r25,0
 1367 0122 0196      		adiw r24,1
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1368               		.loc 1 58 104 view .LVU333
 1369 0124 8770      		andi r24,7
 1370 0126 9927      		clr r25
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1371               		.loc 1 58 76 view .LVU334
 1372 0128 8093 0000 		sts waiting_buffer_tail,r24
 1373 012c 00C0      		rjmp .L141
 1374               	.LVL90:
 1375               	.L156:
  42:../../tmk_core/common/action_tapping.c ****         }
 1376               		.loc 1 42 13 is_stmt 1 view .LVU335
  42:../../tmk_core/common/action_tapping.c ****         }
 1377               		.loc 1 42 35 view .LVU336
 1378 012e 6985      		ldd r22,Y+9
 1379 0130 7A85      		ldd r23,Y+10
 1380 0132 8B85      		ldd r24,Y+11
 1381 0134 9C85      		ldd r25,Y+12
 1382 0136 0E94 0000 		call debug_record
 1383               	.LVL91:
 1384 013a 00C0      		rjmp .L141
 1385               		.cfi_endproc
 1386               	.LFE4:
 1388               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1391               	waiting_buffer_tail:
 1392 0000 00        		.zero	1
 1393               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1396               	waiting_buffer_head:
 1397 0000 00        		.zero	1
 1398               		.section	.bss.waiting_buffer,"aw",@nobits
 1401               	waiting_buffer:
 1402 0000 0000 0000 		.zero	48
 1402      0000 0000 
 1402      0000 0000 
 1402      0000 0000 
 1402      0000 0000 
 1403               		.section	.bss.tapping_key,"aw",@nobits
 1406               	tapping_key:
 1407 0000 0000 0000 		.zero	6
 1407      0000 
 1408               		.text
 1409               	.Letext0:
 1410               		.file 3 "/usr/avr/include/stdint.h"
 1411               		.file 4 "../../tmk_core/common/keycode.h"
 1412               		.file 5 "../../tmk_core/common/action_code.h"
 1413               		.file 6 "../../tmk_core/common/action.h"
 1414               		.file 7 "../../tmk_core/common/action_layer.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
     /tmp/ccmzG2pv.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccmzG2pv.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccmzG2pv.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccmzG2pv.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccmzG2pv.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccmzG2pv.s:12     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
     /tmp/ccmzG2pv.s:1391   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
     /tmp/ccmzG2pv.s:1396   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
     /tmp/ccmzG2pv.s:1401   .bss.waiting_buffer:0000000000000000 waiting_buffer
     /tmp/ccmzG2pv.s:88     .text.debug_tapping_key:0000000000000000 debug_tapping_key
     /tmp/ccmzG2pv.s:1406   .bss.tapping_key:0000000000000000 tapping_key
     /tmp/ccmzG2pv.s:111    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
     /tmp/ccmzG2pv.s:308    .text.process_tapping:0000000000000000 process_tapping
     /tmp/ccmzG2pv.s:1121   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
__mulhi3
debug_record
process_action
is_tap_key
debug_event
layer_switch_get_action
clear_keyboard
__do_clear_bss
