   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.text
   9               	.Ltext0:
  10               		.cfi_sections	.debug_frame
  11               		.section	.text.debug_waiting_buffer,"ax",@progbits
  13               	debug_waiting_buffer:
  14               	.LFB12:
  15               		.file 1 "./tmk_core/common/action_tapping.c"
   1:./tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:./tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:./tmk_core/common/action_tapping.c **** #include "action.h"
   4:./tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:./tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:./tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:./tmk_core/common/action_tapping.c **** #include "timer.h"
   8:./tmk_core/common/action_tapping.c **** 
   9:./tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:./tmk_core/common/action_tapping.c **** #include "debug.h"
  11:./tmk_core/common/action_tapping.c **** #else
  12:./tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:./tmk_core/common/action_tapping.c **** #endif
  14:./tmk_core/common/action_tapping.c **** 
  15:./tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:./tmk_core/common/action_tapping.c **** 
  17:./tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:./tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:./tmk_core/common/action_tapping.c **** 
  23:./tmk_core/common/action_tapping.c **** 
  24:./tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:./tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:./tmk_core/common/action_tapping.c **** 
  29:./tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:./tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  34:./tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  35:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  36:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  37:./tmk_core/common/action_tapping.c **** 
  38:./tmk_core/common/action_tapping.c **** 
  39:./tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  40:./tmk_core/common/action_tapping.c **** {
  41:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  42:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  43:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  44:./tmk_core/common/action_tapping.c ****         }
  45:./tmk_core/common/action_tapping.c ****     } else {
  46:./tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  47:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  48:./tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  49:./tmk_core/common/action_tapping.c ****             clear_keyboard();
  50:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  51:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  52:./tmk_core/common/action_tapping.c ****         }
  53:./tmk_core/common/action_tapping.c ****     }
  54:./tmk_core/common/action_tapping.c **** 
  55:./tmk_core/common/action_tapping.c ****     // process waiting_buffer
  56:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  57:./tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  58:./tmk_core/common/action_tapping.c ****     }
  59:./tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  60:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  61:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  62:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  63:./tmk_core/common/action_tapping.c ****         } else {
  64:./tmk_core/common/action_tapping.c ****             break;
  65:./tmk_core/common/action_tapping.c ****         }
  66:./tmk_core/common/action_tapping.c ****     }
  67:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  68:./tmk_core/common/action_tapping.c ****         debug("\n");
  69:./tmk_core/common/action_tapping.c ****     }
  70:./tmk_core/common/action_tapping.c **** }
  71:./tmk_core/common/action_tapping.c **** 
  72:./tmk_core/common/action_tapping.c **** 
  73:./tmk_core/common/action_tapping.c **** /* Tapping
  74:./tmk_core/common/action_tapping.c ****  *
  75:./tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  76:./tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  77:./tmk_core/common/action_tapping.c ****  */
  78:./tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  79:./tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  80:./tmk_core/common/action_tapping.c **** {
  81:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  82:./tmk_core/common/action_tapping.c **** 
  83:./tmk_core/common/action_tapping.c ****     // if tapping
  84:./tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  85:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  86:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  87:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  88:./tmk_core/common/action_tapping.c ****                     // first tap!
  89:./tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  90:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  91:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  92:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
  93:./tmk_core/common/action_tapping.c **** 
  94:./tmk_core/common/action_tapping.c ****                     // copy tapping state
  95:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
  96:./tmk_core/common/action_tapping.c ****                     // enqueue
  97:./tmk_core/common/action_tapping.c ****                     return false;
  98:./tmk_core/common/action_tapping.c ****                 }
  99:./tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500
 100:./tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 101:./tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 102:./tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 103:./tmk_core/common/action_tapping.c ****                  */
 104:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 105:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 106:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 107:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 108:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 109:./tmk_core/common/action_tapping.c ****                     // enqueue
 110:./tmk_core/common/action_tapping.c ****                     return false;
 111:./tmk_core/common/action_tapping.c ****                 }
 112:./tmk_core/common/action_tapping.c **** #endif
 113:./tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 114:./tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 115:./tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 116:./tmk_core/common/action_tapping.c ****                  */
 117:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 118:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 119:./tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 120:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 121:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 122:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 123:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 124:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 125:./tmk_core/common/action_tapping.c ****                             break;
 126:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 127:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 128:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 129:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 130:./tmk_core/common/action_tapping.c ****                             break;
 131:./tmk_core/common/action_tapping.c ****                     }
 132:./tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 133:./tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 134:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 135:./tmk_core/common/action_tapping.c ****                     return true;
 136:./tmk_core/common/action_tapping.c ****                 }
 137:./tmk_core/common/action_tapping.c ****                 else {
 138:./tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 139:./tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 140:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 141:./tmk_core/common/action_tapping.c ****                     }
 142:./tmk_core/common/action_tapping.c ****                     // enqueue
 143:./tmk_core/common/action_tapping.c ****                     return false;
 144:./tmk_core/common/action_tapping.c ****                 }
 145:./tmk_core/common/action_tapping.c ****             }
 146:./tmk_core/common/action_tapping.c ****             // tap_count > 0
 147:./tmk_core/common/action_tapping.c ****             else {
 148:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 149:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 150:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 151:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 152:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 153:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 154:./tmk_core/common/action_tapping.c ****                     return true;
 155:./tmk_core/common/action_tapping.c ****                 }
 156:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 157:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 158:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 159:./tmk_core/common/action_tapping.c ****                         // unregister key
 160:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 161:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 162:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 163:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 164:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 165:./tmk_core/common/action_tapping.c ****                         });
 166:./tmk_core/common/action_tapping.c ****                     } else {
 167:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 168:./tmk_core/common/action_tapping.c ****                     }
 169:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 170:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 171:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 172:./tmk_core/common/action_tapping.c ****                     return true;
 173:./tmk_core/common/action_tapping.c ****                 }
 174:./tmk_core/common/action_tapping.c ****                 else {
 175:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 176:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 177:./tmk_core/common/action_tapping.c ****                     }
 178:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 179:./tmk_core/common/action_tapping.c ****                     return true;
 180:./tmk_core/common/action_tapping.c ****                 }
 181:./tmk_core/common/action_tapping.c ****             }
 182:./tmk_core/common/action_tapping.c ****         }
 183:./tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 184:./tmk_core/common/action_tapping.c ****         else {
 185:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 186:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 187:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 188:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 189:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 190:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 191:./tmk_core/common/action_tapping.c ****                 return false;
 192:./tmk_core/common/action_tapping.c ****             }  else {
 193:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 194:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 195:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 196:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 197:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 198:./tmk_core/common/action_tapping.c ****                     return true;
 199:./tmk_core/common/action_tapping.c ****                 }
 200:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 201:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 202:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 203:./tmk_core/common/action_tapping.c ****                         // unregister key
 204:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 205:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 206:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 207:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 208:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 209:./tmk_core/common/action_tapping.c ****                         });
 210:./tmk_core/common/action_tapping.c ****                     } else {
 211:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 212:./tmk_core/common/action_tapping.c ****                     }
 213:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 214:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 215:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 216:./tmk_core/common/action_tapping.c ****                     return true;
 217:./tmk_core/common/action_tapping.c ****                 }
 218:./tmk_core/common/action_tapping.c ****                 else {
 219:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 220:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 221:./tmk_core/common/action_tapping.c ****                     }
 222:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 223:./tmk_core/common/action_tapping.c ****                     return true;
 224:./tmk_core/common/action_tapping.c ****                 }
 225:./tmk_core/common/action_tapping.c ****             }
 226:./tmk_core/common/action_tapping.c ****         }
 227:./tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 228:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 229:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 230:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 231:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 232:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 233:./tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 234:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 235:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 236:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 237:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 238:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 239:./tmk_core/common/action_tapping.c ****                         return true;
 240:./tmk_core/common/action_tapping.c ****                     } else {
 241:./tmk_core/common/action_tapping.c ****                         // FIX: start new tap again
 242:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 243:./tmk_core/common/action_tapping.c ****                         return true;
 244:./tmk_core/common/action_tapping.c ****                     }
 245:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 246:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 247:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 248:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 249:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 250:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 251:./tmk_core/common/action_tapping.c ****                     return true;
 252:./tmk_core/common/action_tapping.c ****                 } else {
 253:./tmk_core/common/action_tapping.c ****                     // should none in buffer
 254:./tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 255:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 256:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 257:./tmk_core/common/action_tapping.c ****                     return true;
 258:./tmk_core/common/action_tapping.c ****                 }
 259:./tmk_core/common/action_tapping.c ****             } else {
 260:./tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n") {};
 261:./tmk_core/common/action_tapping.c ****                 process_record(keyp);
 262:./tmk_core/common/action_tapping.c ****                 return true;
 263:./tmk_core/common/action_tapping.c ****             }
 264:./tmk_core/common/action_tapping.c ****         } else {
 265:./tmk_core/common/action_tapping.c ****             // FIX: process_aciton here?
 266:./tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 267:./tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 268:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 269:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 270:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 271:./tmk_core/common/action_tapping.c ****             return false;
 272:./tmk_core/common/action_tapping.c ****         }
 273:./tmk_core/common/action_tapping.c ****     }
 274:./tmk_core/common/action_tapping.c ****     // not tapping state
 275:./tmk_core/common/action_tapping.c ****     else {
 276:./tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event.key)) {
 277:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 278:./tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 279:./tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 280:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 281:./tmk_core/common/action_tapping.c ****             return true;
 282:./tmk_core/common/action_tapping.c ****         } else {
 283:./tmk_core/common/action_tapping.c ****             process_record(keyp);
 284:./tmk_core/common/action_tapping.c ****             return true;
 285:./tmk_core/common/action_tapping.c ****         }
 286:./tmk_core/common/action_tapping.c ****     }
 287:./tmk_core/common/action_tapping.c **** }
 288:./tmk_core/common/action_tapping.c **** 
 289:./tmk_core/common/action_tapping.c **** 
 290:./tmk_core/common/action_tapping.c **** /*
 291:./tmk_core/common/action_tapping.c ****  * Waiting buffer
 292:./tmk_core/common/action_tapping.c ****  */
 293:./tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 294:./tmk_core/common/action_tapping.c **** {
 295:./tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 296:./tmk_core/common/action_tapping.c ****         return true;
 297:./tmk_core/common/action_tapping.c ****     }
 298:./tmk_core/common/action_tapping.c **** 
 299:./tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 300:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 301:./tmk_core/common/action_tapping.c ****         return false;
 302:./tmk_core/common/action_tapping.c ****     }
 303:./tmk_core/common/action_tapping.c **** 
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 305:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 306:./tmk_core/common/action_tapping.c **** 
 307:./tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 308:./tmk_core/common/action_tapping.c ****     return true;
 309:./tmk_core/common/action_tapping.c **** }
 310:./tmk_core/common/action_tapping.c **** 
 311:./tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 312:./tmk_core/common/action_tapping.c **** {
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 314:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 315:./tmk_core/common/action_tapping.c **** }
 316:./tmk_core/common/action_tapping.c **** 
 317:./tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 318:./tmk_core/common/action_tapping.c **** {
 319:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 320:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 321:./tmk_core/common/action_tapping.c ****             return true;
 322:./tmk_core/common/action_tapping.c ****         }
 323:./tmk_core/common/action_tapping.c ****     }
 324:./tmk_core/common/action_tapping.c ****     return false;
 325:./tmk_core/common/action_tapping.c **** }
 326:./tmk_core/common/action_tapping.c **** 
 327:./tmk_core/common/action_tapping.c **** __attribute__((unused))
 328:./tmk_core/common/action_tapping.c **** bool waiting_buffer_has_anykey_pressed(void)
 329:./tmk_core/common/action_tapping.c **** {
 330:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 331:./tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 332:./tmk_core/common/action_tapping.c ****     }
 333:./tmk_core/common/action_tapping.c ****     return false;
 334:./tmk_core/common/action_tapping.c **** }
 335:./tmk_core/common/action_tapping.c **** 
 336:./tmk_core/common/action_tapping.c **** /* scan buffer for tapping */
 337:./tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 338:./tmk_core/common/action_tapping.c **** {
 339:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 340:./tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 341:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 342:./tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 343:./tmk_core/common/action_tapping.c **** 
 344:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 345:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 346:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 347:./tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 348:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 349:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 350:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 351:./tmk_core/common/action_tapping.c **** 
 352:./tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 353:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 354:./tmk_core/common/action_tapping.c ****             return;
 355:./tmk_core/common/action_tapping.c ****         }
 356:./tmk_core/common/action_tapping.c ****     }
 357:./tmk_core/common/action_tapping.c **** }
 358:./tmk_core/common/action_tapping.c **** 
 359:./tmk_core/common/action_tapping.c **** 
 360:./tmk_core/common/action_tapping.c **** /*
 361:./tmk_core/common/action_tapping.c ****  * debug print
 362:./tmk_core/common/action_tapping.c ****  */
 363:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 364:./tmk_core/common/action_tapping.c **** {
 365:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 366:./tmk_core/common/action_tapping.c **** }
 367:./tmk_core/common/action_tapping.c **** 
 368:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 369:./tmk_core/common/action_tapping.c **** {
  16               		.loc 1 369 1 view -0
  17               		.cfi_startproc
  18 0000 1F93      		push r17
  19               	.LCFI0:
  20               		.cfi_def_cfa_offset 3
  21               		.cfi_offset 17, -2
  22 0002 CF93      		push r28
  23               	.LCFI1:
  24               		.cfi_def_cfa_offset 4
  25               		.cfi_offset 28, -3
  26 0004 DF93      		push r29
  27               	.LCFI2:
  28               		.cfi_def_cfa_offset 5
  29               		.cfi_offset 29, -4
  30               	/* prologue: function */
  31               	/* frame size = 0 */
  32               	/* stack size = 3 */
  33               	.L__stack_usage = 3
 370:./tmk_core/common/action_tapping.c ****     debug("{ ");
  34               		.loc 1 370 16 view .LVU1
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  35               		.loc 1 371 5 view .LVU2
  36               	.LBB41:
  37               		.loc 1 371 10 view .LVU3
  38               		.loc 1 371 18 is_stmt 0 view .LVU4
  39 0006 E091 0000 		lds r30,waiting_buffer_tail
  40               	.LVL0:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  41               		.loc 1 372 48 view .LVU5
  42 000a 16E0      		ldi r17,lo8(6)
  43               	.LVL1:
  44               	.L2:
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  45               		.loc 1 371 43 is_stmt 1 discriminator 1 view .LVU6
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  46               		.loc 1 371 5 is_stmt 0 discriminator 1 view .LVU7
  47 000c 8091 0000 		lds r24,waiting_buffer_head
  48 0010 8E13      		cpse r24,r30
  49 0012 00C0      		rjmp .L3
  50               	/* epilogue start */
  51               	.LBE41:
 373:./tmk_core/common/action_tapping.c ****     }
 374:./tmk_core/common/action_tapping.c ****     debug("}\n");
 375:./tmk_core/common/action_tapping.c **** }
  52               		.loc 1 375 1 view .LVU8
  53 0014 DF91      		pop r29
  54 0016 CF91      		pop r28
  55 0018 1F91      		pop r17
  56 001a 0895      		ret
  57               	.L3:
  58               	.LBB42:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  59               		.loc 1 372 19 is_stmt 1 discriminator 3 view .LVU9
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  60               		.loc 1 372 33 discriminator 3 view .LVU10
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  61               		.loc 1 372 46 discriminator 3 view .LVU11
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  62               		.loc 1 372 48 discriminator 3 view .LVU12
  63 001c CE2F      		mov r28,r30
  64 001e D0E0      		ldi r29,0
  65 0020 1E9F      		mul r17,r30
  66 0022 F001      		movw r30,r0
  67 0024 1124      		clr __zero_reg__
  68               	.LVL2:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  69               		.loc 1 372 48 is_stmt 0 discriminator 3 view .LVU13
  70 0026 E050      		subi r30,lo8(-(waiting_buffer))
  71 0028 F040      		sbci r31,hi8(-(waiting_buffer))
  72 002a 4081      		ld r20,Z
  73 002c 5181      		ldd r21,Z+1
  74 002e 6281      		ldd r22,Z+2
  75 0030 7381      		ldd r23,Z+3
  76 0032 8481      		ldd r24,Z+4
  77 0034 9581      		ldd r25,Z+5
  78 0036 0E94 0000 		call debug_record
  79               	.LVL3:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  80               		.loc 1 372 91 is_stmt 1 discriminator 3 view .LVU14
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  81               		.loc 1 371 69 discriminator 3 view .LVU15
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  82               		.loc 1 371 76 is_stmt 0 discriminator 3 view .LVU16
  83 003a FE01      		movw r30,r28
  84 003c 3196      		adiw r30,1
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  85               		.loc 1 371 71 discriminator 3 view .LVU17
  86 003e E770      		andi r30,lo8(7)
  87               	.LVL4:
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  88               		.loc 1 371 71 discriminator 3 view .LVU18
  89 0040 00C0      		rjmp .L2
  90               	.LBE42:
  91               		.cfi_endproc
  92               	.LFE12:
  94               		.section	.text.debug_tapping_key,"ax",@progbits
  96               	debug_tapping_key:
  97               	.LFB11:
 364:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  98               		.loc 1 364 1 is_stmt 1 view -0
  99               		.cfi_startproc
 100               	/* prologue: function */
 101               	/* frame size = 0 */
 102               	/* stack size = 0 */
 103               	.L__stack_usage = 0
 365:./tmk_core/common/action_tapping.c **** }
 104               		.loc 1 365 26 view .LVU20
 365:./tmk_core/common/action_tapping.c **** }
 105               		.loc 1 365 28 view .LVU21
 106 0000 4091 0000 		lds r20,tapping_key
 107 0004 5091 0000 		lds r21,tapping_key+1
 108 0008 6091 0000 		lds r22,tapping_key+2
 109 000c 7091 0000 		lds r23,tapping_key+3
 110 0010 8091 0000 		lds r24,tapping_key+4
 111 0014 9091 0000 		lds r25,tapping_key+5
 112 0018 0C94 0000 		jmp debug_record
 113               	.LVL5:
 114               		.cfi_endproc
 115               	.LFE11:
 117               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 119               	waiting_buffer_scan_tap:
 120               	.LFB10:
 338:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 121               		.loc 1 338 1 view -0
 122               		.cfi_startproc
 123 0000 1F93      		push r17
 124               	.LCFI3:
 125               		.cfi_def_cfa_offset 3
 126               		.cfi_offset 17, -2
 127 0002 CF93      		push r28
 128               	.LCFI4:
 129               		.cfi_def_cfa_offset 4
 130               		.cfi_offset 28, -3
 131 0004 DF93      		push r29
 132               	.LCFI5:
 133               		.cfi_def_cfa_offset 5
 134               		.cfi_offset 29, -4
 135               	/* prologue: function */
 136               	/* frame size = 0 */
 137               	/* stack size = 3 */
 138               	.L__stack_usage = 3
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 139               		.loc 1 340 5 view .LVU23
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 140               		.loc 1 340 31 is_stmt 0 view .LVU24
 141 0006 8091 0000 		lds r24,tapping_key+5
 142 000a 807F      		andi r24,lo8(-16)
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 143               		.loc 1 340 8 view .LVU25
 144 000c 01F4      		brne .L5
 342:./tmk_core/common/action_tapping.c **** 
 145               		.loc 1 342 5 is_stmt 1 view .LVU26
 342:./tmk_core/common/action_tapping.c **** 
 146               		.loc 1 342 8 is_stmt 0 view .LVU27
 147 000e 8091 0000 		lds r24,tapping_key+2
 148 0012 8823      		tst r24
 149 0014 01F0      		breq .L5
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 150               		.loc 1 344 5 is_stmt 1 view .LVU28
 151               	.LBB43:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 152               		.loc 1 344 10 view .LVU29
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 153               		.loc 1 344 18 is_stmt 0 view .LVU30
 154 0016 8091 0000 		lds r24,waiting_buffer_tail
 155               	.LVL6:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 156               		.loc 1 344 45 view .LVU31
 157 001a C091 0000 		lds r28,waiting_buffer_head
 158 001e 7091 0000 		lds r23,tapping_key
 159 0022 6091 0000 		lds r22,tapping_key+1
 160 0026 4091 0000 		lds r20,tapping_key+3
 161 002a 5091 0000 		lds r21,tapping_key+3+1
 162 002e D62F      		mov r29,r22
 163 0030 D723      		and r29,r23
 164 0032 DA01      		movw r26,r20
 165 0034 A095      		com r26
 166 0036 B095      		com r27
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 167               		.loc 1 345 13 view .LVU32
 168 0038 16E0      		ldi r17,lo8(6)
 169               	.LVL7:
 170               	.L7:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 171               		.loc 1 344 43 is_stmt 1 discriminator 1 view .LVU33
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 172               		.loc 1 344 5 is_stmt 0 discriminator 1 view .LVU34
 173 003a C813      		cpse r28,r24
 174 003c 00C0      		rjmp .L12
 175               	.LVL8:
 176               	.L5:
 177               	/* epilogue start */
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 178               		.loc 1 344 5 discriminator 1 view .LVU35
 179               	.LBE43:
 357:./tmk_core/common/action_tapping.c **** 
 180               		.loc 1 357 1 view .LVU36
 181 003e DF91      		pop r29
 182 0040 CF91      		pop r28
 183 0042 1F91      		pop r17
 184 0044 0895      		ret
 185               	.LVL9:
 186               	.L12:
 187               	.LBB48:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 188               		.loc 1 345 9 is_stmt 1 view .LVU37
 189               	.LBB44:
 190               	.LBI44:
 191               		.file 2 "./tmk_core/common/keyboard.h"
   1:./tmk_core/common/keyboard.h **** /*
   2:./tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:./tmk_core/common/keyboard.h **** 
   4:./tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:./tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:./tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:./tmk_core/common/keyboard.h **** (at your option) any later version.
   8:./tmk_core/common/keyboard.h **** 
   9:./tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:./tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:./tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:./tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:./tmk_core/common/keyboard.h **** 
  14:./tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:./tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:./tmk_core/common/keyboard.h **** */
  17:./tmk_core/common/keyboard.h **** 
  18:./tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:./tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:./tmk_core/common/keyboard.h **** 
  21:./tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:./tmk_core/common/keyboard.h **** #include <stdint.h>
  23:./tmk_core/common/keyboard.h **** 
  24:./tmk_core/common/keyboard.h **** 
  25:./tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:./tmk_core/common/keyboard.h **** extern "C" {
  27:./tmk_core/common/keyboard.h **** #endif
  28:./tmk_core/common/keyboard.h **** 
  29:./tmk_core/common/keyboard.h **** /* key matrix position */
  30:./tmk_core/common/keyboard.h **** typedef struct {
  31:./tmk_core/common/keyboard.h ****     uint8_t col;
  32:./tmk_core/common/keyboard.h ****     uint8_t row;
  33:./tmk_core/common/keyboard.h **** } keypos_t;
  34:./tmk_core/common/keyboard.h **** 
  35:./tmk_core/common/keyboard.h **** /* key event */
  36:./tmk_core/common/keyboard.h **** typedef struct {
  37:./tmk_core/common/keyboard.h ****     keypos_t key;
  38:./tmk_core/common/keyboard.h ****     bool     pressed;
  39:./tmk_core/common/keyboard.h ****     uint16_t time;
  40:./tmk_core/common/keyboard.h **** } keyevent_t;
  41:./tmk_core/common/keyboard.h **** 
  42:./tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:./tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:./tmk_core/common/keyboard.h **** 
  45:./tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:./tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:./tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:./tmk_core/common/keyboard.h ****  */
  49:./tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 192               		.loc 2 49 20 view .LVU38
 193               	.LBB45:
 194               		.loc 2 49 51 view .LVU39
 195               	.LBE45:
 196               	.LBE44:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 197               		.loc 1 345 13 is_stmt 0 view .LVU40
 198 0046 90E0      		ldi r25,0
 199               	.LBB47:
 200               	.LBB46:
 201               		.loc 2 49 74 view .LVU41
 202 0048 4115      		cp r20,__zero_reg__
 203 004a 5105      		cpc r21,__zero_reg__
 204 004c 01F0      		breq .L8
 205 004e DF3F      		cpi r29,lo8(-1)
 206 0050 01F4      		brne .L23
 207               	.LVL10:
 208               	.L8:
 209               		.loc 2 49 74 view .LVU42
 210               	.LBE46:
 211               	.LBE47:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 212               		.loc 1 344 69 is_stmt 1 discriminator 2 view .LVU43
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 213               		.loc 1 344 76 is_stmt 0 discriminator 2 view .LVU44
 214 0052 0196      		adiw r24,1
 215               	.LVL11:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 216               		.loc 1 344 71 discriminator 2 view .LVU45
 217 0054 8770      		andi r24,lo8(7)
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 218               		.loc 1 344 71 discriminator 2 view .LVU46
 219 0056 00C0      		rjmp .L7
 220               	.LVL12:
 221               	.L10:
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 222               		.loc 1 347 17 discriminator 2 view .LVU47
 223 0058 2A0F      		add r18,r26
 224 005a 3B1F      		adc r19,r27
 225 005c 00C0      		rjmp .L25
 226               	.LVL13:
 227               	.L23:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 228               		.loc 1 345 13 view .LVU48
 229 005e 189F      		mul r17,r24
 230 0060 F001      		movw r30,r0
 231 0062 199F      		mul r17,r25
 232 0064 F00D      		add r31,r0
 233 0066 1124      		clr __zero_reg__
 234 0068 E050      		subi r30,lo8(-(waiting_buffer))
 235 006a F040      		sbci r31,hi8(-(waiting_buffer))
 236 006c 2181      		ldd r18,Z+1
 237 006e 6213      		cpse r22,r18
 238 0070 00C0      		rjmp .L8
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 239               		.loc 1 345 13 discriminator 2 view .LVU49
 240 0072 2081      		ld r18,Z
 241 0074 2713      		cpse r18,r23
 242 0076 00C0      		rjmp .L8
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 243               		.loc 1 345 57 discriminator 3 view .LVU50
 244 0078 2281      		ldd r18,Z+2
 245 007a 2111      		cpse r18,__zero_reg__
 246 007c 00C0      		rjmp .L8
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 247               		.loc 1 347 17 view .LVU51
 248 007e 2381      		ldd r18,Z+3
 249 0080 3481      		ldd r19,Z+4
 250 0082 2417      		cp r18,r20
 251 0084 3507      		cpc r19,r21
 252 0086 00F0      		brlo .L10
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 253               		.loc 1 347 17 discriminator 1 view .LVU52
 254 0088 241B      		sub r18,r20
 255 008a 350B      		sbc r19,r21
 256               	.L25:
 346:./tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 257               		.loc 1 346 50 discriminator 2 view .LVU53
 258 008c 283C      		cpi r18,-56
 259 008e 3105      		cpc r19,__zero_reg__
 260 0090 00F4      		brsh .L8
 348:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 261               		.loc 1 348 13 is_stmt 1 view .LVU54
 348:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 262               		.loc 1 348 35 is_stmt 0 view .LVU55
 263 0092 2091 0000 		lds r18,tapping_key+5
 264 0096 2F70      		andi r18,lo8(15)
 265 0098 2061      		ori r18,lo8(16)
 266 009a 2093 0000 		sts tapping_key+5,r18
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 267               		.loc 1 349 13 is_stmt 1 view .LVU56
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 268               		.loc 1 349 41 is_stmt 0 view .LVU57
 269 009e 26E0      		ldi r18,lo8(6)
 270 00a0 289F      		mul r18,r24
 271 00a2 F001      		movw r30,r0
 272 00a4 299F      		mul r18,r25
 273 00a6 F00D      		add r31,r0
 274 00a8 1124      		clr __zero_reg__
 275 00aa E050      		subi r30,lo8(-(waiting_buffer+5))
 276 00ac F040      		sbci r31,hi8(-(waiting_buffer+5))
 277 00ae 8081      		ld r24,Z
 278               	.LVL14:
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 279               		.loc 1 349 41 view .LVU58
 280 00b0 8F70      		andi r24,lo8(15)
 281 00b2 8061      		ori r24,lo8(16)
 282 00b4 8083      		st Z,r24
 350:./tmk_core/common/action_tapping.c **** 
 283               		.loc 1 350 13 is_stmt 1 view .LVU59
 284 00b6 80E0      		ldi r24,lo8(tapping_key)
 285 00b8 90E0      		ldi r25,hi8(tapping_key)
 286 00ba 0E94 0000 		call process_record
 287               	.LVL15:
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 288               		.loc 1 352 57 view .LVU60
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 289               		.loc 1 352 71 view .LVU61
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 290               		.loc 1 352 85 view .LVU62
 353:./tmk_core/common/action_tapping.c ****             return;
 291               		.loc 1 353 13 view .LVU63
 292               	/* epilogue start */
 293               	.LBE48:
 357:./tmk_core/common/action_tapping.c **** 
 294               		.loc 1 357 1 is_stmt 0 view .LVU64
 295 00be DF91      		pop r29
 296 00c0 CF91      		pop r28
 297 00c2 1F91      		pop r17
 298               	.LBB49:
 353:./tmk_core/common/action_tapping.c ****             return;
 299               		.loc 1 353 13 view .LVU65
 300 00c4 0C94 0000 		jmp debug_waiting_buffer
 301               	.LVL16:
 302               	.LBE49:
 303               		.cfi_endproc
 304               	.LFE10:
 306               		.section	.text.process_tapping,"ax",@progbits
 308               	process_tapping:
 309               	.LVL17:
 310               	.LFB5:
  80:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 311               		.loc 1 80 1 is_stmt 1 view -0
 312               		.cfi_startproc
  80:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 313               		.loc 1 80 1 is_stmt 0 view .LVU67
 314 0000 9F92      		push r9
 315               	.LCFI6:
 316               		.cfi_def_cfa_offset 3
 317               		.cfi_offset 9, -2
 318 0002 AF92      		push r10
 319               	.LCFI7:
 320               		.cfi_def_cfa_offset 4
 321               		.cfi_offset 10, -3
 322 0004 BF92      		push r11
 323               	.LCFI8:
 324               		.cfi_def_cfa_offset 5
 325               		.cfi_offset 11, -4
 326 0006 CF92      		push r12
 327               	.LCFI9:
 328               		.cfi_def_cfa_offset 6
 329               		.cfi_offset 12, -5
 330 0008 DF92      		push r13
 331               	.LCFI10:
 332               		.cfi_def_cfa_offset 7
 333               		.cfi_offset 13, -6
 334 000a EF92      		push r14
 335               	.LCFI11:
 336               		.cfi_def_cfa_offset 8
 337               		.cfi_offset 14, -7
 338 000c FF92      		push r15
 339               	.LCFI12:
 340               		.cfi_def_cfa_offset 9
 341               		.cfi_offset 15, -8
 342 000e 0F93      		push r16
 343               	.LCFI13:
 344               		.cfi_def_cfa_offset 10
 345               		.cfi_offset 16, -9
 346 0010 1F93      		push r17
 347               	.LCFI14:
 348               		.cfi_def_cfa_offset 11
 349               		.cfi_offset 17, -10
 350 0012 CF93      		push r28
 351               	.LCFI15:
 352               		.cfi_def_cfa_offset 12
 353               		.cfi_offset 28, -11
 354 0014 DF93      		push r29
 355               	.LCFI16:
 356               		.cfi_def_cfa_offset 13
 357               		.cfi_offset 29, -12
 358 0016 CDB7      		in r28,__SP_L__
 359 0018 DEB7      		in r29,__SP_H__
 360               	.LCFI17:
 361               		.cfi_def_cfa_register 28
 362 001a 2B97      		sbiw r28,11
 363               	.LCFI18:
 364               		.cfi_def_cfa_offset 24
 365 001c 0FB6      		in __tmp_reg__,__SREG__
 366 001e F894      		cli
 367 0020 DEBF      		out __SP_H__,r29
 368 0022 0FBE      		out __SREG__,__tmp_reg__
 369 0024 CDBF      		out __SP_L__,r28
 370               	/* prologue: function */
 371               	/* frame size = 11 */
 372               	/* stack size = 22 */
 373               	.L__stack_usage = 22
 374 0026 8C01      		movw r16,r24
  81:./tmk_core/common/action_tapping.c **** 
 375               		.loc 1 81 5 is_stmt 1 view .LVU68
  81:./tmk_core/common/action_tapping.c **** 
 376               		.loc 1 81 16 is_stmt 0 view .LVU69
 377 0028 85E0      		ldi r24,lo8(5)
 378               	.LVL18:
  81:./tmk_core/common/action_tapping.c **** 
 379               		.loc 1 81 16 view .LVU70
 380 002a F801      		movw r30,r16
 381 002c DE01      		movw r26,r28
 382 002e 1796      		adiw r26,7
 383               		0:
 384 0030 0190      		ld r0,Z+
 385 0032 0D92      		st X+,r0
 386 0034 8A95      		dec r24
 387 0036 01F4      		brne 0b
 388 0038 D801      		movw r26,r16
 389 003a 1296      		adiw r26,2
 390 003c EC90      		ld r14,X
 391               	.LVL19:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 392               		.loc 1 84 5 is_stmt 1 view .LVU71
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 393               		.loc 1 84 5 is_stmt 0 view .LVU72
 394 003e 8091 0000 		lds r24,tapping_key+3
 395 0042 9091 0000 		lds r25,tapping_key+3+1
 396               	.LVL20:
 397               	.LBB75:
 398               	.LBI75:
 399               		.loc 2 49 20 is_stmt 1 view .LVU73
 400               	.LBB76:
 401               		.loc 2 49 51 view .LVU74
 402               		.loc 2 49 74 is_stmt 0 view .LVU75
 403 0046 0097      		sbiw r24,0
 404 0048 01F0      		breq .L27
 405 004a 4091 0000 		lds r20,tapping_key
 406 004e 5091 0000 		lds r21,tapping_key+1
 407 0052 242F      		mov r18,r20
 408 0054 2523      		and r18,r21
 409 0056 2F3F      		cpi r18,lo8(-1)
 410 0058 01F0      		breq .+2
 411 005a 00C0      		rjmp .L115
 412               	.L27:
 413               	.LVL21:
 414               		.loc 2 49 74 view .LVU76
 415               	.LBE76:
 416               	.LBE75:
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 417               		.loc 1 276 9 is_stmt 1 view .LVU77
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 418               		.loc 1 276 12 is_stmt 0 view .LVU78
 419 005c EE20      		tst r14
 420 005e 01F4      		brne .+2
 421 0060 00C0      		rjmp .L58
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 422               		.loc 1 276 30 discriminator 1 view .LVU79
 423 0062 8F81      		ldd r24,Y+7
 424 0064 9885      		ldd r25,Y+8
 425 0066 0E94 0000 		call is_tap_key
 426               	.LVL22:
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 427               		.loc 1 276 27 discriminator 1 view .LVU80
 428 006a 8823      		tst r24
 429 006c 01F4      		brne .+2
 430 006e 00C0      		rjmp .L58
 431 0070 00C0      		rjmp .L50
 432               	.LVL23:
 433               	.L67:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 434               		.loc 1 85 9 is_stmt 1 view .LVU81
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 435               		.loc 1 85 13 is_stmt 0 view .LVU82
 436 0072 C816      		cp r12,r24
 437 0074 D906      		cpc r13,r25
 438 0076 00F0      		brlo .L29
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 439               		.loc 1 85 13 discriminator 1 view .LVU83
 440 0078 F601      		movw r30,r12
 441 007a E81B      		sub r30,r24
 442 007c F90B      		sbc r31,r25
 443 007e CF01      		movw r24,r30
 444               	.L122:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 445               		.loc 1 85 13 discriminator 2 view .LVU84
 446 0080 FF24      		clr r15
 447 0082 F394      		inc r15
 448 0084 883C      		cpi r24,-56
 449 0086 9105      		cpc r25,__zero_reg__
 450 0088 00F0      		brlo .L31
 451 008a F12C      		mov r15,__zero_reg__
 452               	.L31:
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 453               		.loc 1 86 39 view .LVU85
 454 008c 80E0      		ldi r24,lo8(tapping_key)
 455 008e A82E      		mov r10,r24
 456 0090 80E0      		ldi r24,hi8(tapping_key)
 457 0092 B82E      		mov r11,r24
 458 0094 8091 0000 		lds r24,tapping_key+5
 459 0098 982F      		mov r25,r24
 460 009a 907F      		andi r25,lo8(-16)
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 461               		.loc 1 85 12 view .LVU86
 462 009c F110      		cpse r15,__zero_reg__
 463 009e 00C0      		rjmp .L69
 185:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 464               		.loc 1 185 13 is_stmt 1 view .LVU87
 185:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 465               		.loc 1 185 16 is_stmt 0 view .LVU88
 466 00a0 01F0      		breq .+2
 467 00a2 00C0      		rjmp .L51
 468               	.LBB77:
 186:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 469               		.loc 1 186 61 is_stmt 1 view .LVU89
 187:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 470               		.loc 1 187 17 view .LVU90
 471 00a4 4F81      		ldd r20,Y+7
 472 00a6 5885      		ldd r21,Y+8
 473 00a8 6985      		ldd r22,Y+9
 474 00aa 7A85      		ldd r23,Y+10
 475 00ac 8B85      		ldd r24,Y+11
 476 00ae 0E94 0000 		call debug_event
 477               	.LVL24:
 187:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 478               		.loc 1 187 48 view .LVU91
 188:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 479               		.loc 1 188 17 view .LVU92
 480 00b2 80E0      		ldi r24,lo8(tapping_key)
 481 00b4 90E0      		ldi r25,hi8(tapping_key)
 482 00b6 0E94 0000 		call process_record
 483               	.LVL25:
 189:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 484               		.loc 1 189 17 view .LVU93
 189:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 485               		.loc 1 189 29 is_stmt 0 view .LVU94
 486 00ba 86E0      		ldi r24,lo8(6)
 487 00bc F501      		movw r30,r10
 488               		0:
 489 00be 1192      		st Z+,__zero_reg__
 490 00c0 8A95      		dec r24
 491 00c2 01F4      		brne 0b
 492               	.L124:
 190:./tmk_core/common/action_tapping.c ****                 return false;
 493               		.loc 1 190 17 is_stmt 1 view .LVU95
 494 00c4 0E94 0000 		call debug_tapping_key
 495               	.LVL26:
 191:./tmk_core/common/action_tapping.c ****             }  else {
 496               		.loc 1 191 17 view .LVU96
 497 00c8 00C0      		rjmp .L26
 498               	.LVL27:
 499               	.L29:
 191:./tmk_core/common/action_tapping.c ****             }  else {
 500               		.loc 1 191 17 is_stmt 0 view .LVU97
 501               	.LBE77:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 502               		.loc 1 85 13 discriminator 2 view .LVU98
 503 00ca 8095      		com r24
 504 00cc 9095      		com r25
 505 00ce 8C0D      		add r24,r12
 506 00d0 9D1D      		adc r25,r13
 507 00d2 00C0      		rjmp .L122
 508               	.L69:
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 509               		.loc 1 86 13 is_stmt 1 view .LVU99
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 510               		.loc 1 86 16 is_stmt 0 view .LVU100
 511 00d4 9111      		cpse r25,__zero_reg__
 512 00d6 00C0      		rjmp .L33
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 513               		.loc 1 87 17 is_stmt 1 view .LVU101
 514               	.LVL28:
 515               		.loc 2 49 51 view .LVU102
 516               	.LBB78:
 517               	.LBB79:
  50:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:./tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 518               		.loc 2 51 88 is_stmt 0 view .LVU103
 519 00d8 FE2C      		mov r15,r14
 520               	.LVL29:
 521               		.loc 2 51 88 view .LVU104
 522               	.LBE79:
 523               	.LBE78:
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 524               		.loc 1 87 21 view .LVU105
 525 00da 2513      		cpse r18,r21
 526 00dc 00C0      		rjmp .L34
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 527               		.loc 1 87 21 discriminator 2 view .LVU106
 528 00de 4313      		cpse r20,r19
 529 00e0 00C0      		rjmp .L34
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 530               		.loc 1 87 47 discriminator 3 view .LVU107
 531 00e2 E110      		cpse r14,__zero_reg__
 532 00e4 00C0      		rjmp .L34
  89:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 533               		.loc 1 89 57 is_stmt 1 view .LVU108
  90:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 534               		.loc 1 90 21 view .LVU109
  90:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 535               		.loc 1 90 43 is_stmt 0 view .LVU110
 536 00e6 8F70      		andi r24,lo8(15)
 537 00e8 8061      		ori r24,lo8(16)
 538 00ea 8093 0000 		sts tapping_key+5,r24
 539               	.LVL30:
  91:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 540               		.loc 1 91 21 is_stmt 1 view .LVU111
 541 00ee 0E94 0000 		call debug_tapping_key
 542               	.LVL31:
  92:./tmk_core/common/action_tapping.c **** 
 543               		.loc 1 92 21 view .LVU112
 544 00f2 80E0      		ldi r24,lo8(tapping_key)
 545 00f4 90E0      		ldi r25,hi8(tapping_key)
 546 00f6 0E94 0000 		call process_record
 547               	.LVL32:
  95:./tmk_core/common/action_tapping.c ****                     // enqueue
 548               		.loc 1 95 21 view .LVU113
  95:./tmk_core/common/action_tapping.c ****                     // enqueue
 549               		.loc 1 95 31 is_stmt 0 view .LVU114
 550 00fa 8091 0000 		lds r24,tapping_key+5
 551 00fe D801      		movw r26,r16
 552 0100 1596      		adiw r26,5
 553 0102 8C93      		st X,r24
  97:./tmk_core/common/action_tapping.c ****                 }
 554               		.loc 1 97 21 is_stmt 1 view .LVU115
 555               	.LVL33:
 556               	.L26:
 287:./tmk_core/common/action_tapping.c **** 
 557               		.loc 1 287 1 is_stmt 0 view .LVU116
 558 0104 8F2D      		mov r24,r15
 559               	/* epilogue start */
 287:./tmk_core/common/action_tapping.c **** 
 560               		.loc 1 287 1 view .LVU117
 561 0106 2B96      		adiw r28,11
 562 0108 0FB6      		in __tmp_reg__,__SREG__
 563 010a F894      		cli
 564 010c DEBF      		out __SP_H__,r29
 565 010e 0FBE      		out __SREG__,__tmp_reg__
 566 0110 CDBF      		out __SP_L__,r28
 567 0112 DF91      		pop r29
 568 0114 CF91      		pop r28
 569 0116 1F91      		pop r17
 570 0118 0F91      		pop r16
 571               	.LVL34:
 287:./tmk_core/common/action_tapping.c **** 
 572               		.loc 1 287 1 view .LVU118
 573 011a FF90      		pop r15
 574 011c EF90      		pop r14
 575               	.LVL35:
 287:./tmk_core/common/action_tapping.c **** 
 576               		.loc 1 287 1 view .LVU119
 577 011e DF90      		pop r13
 578 0120 CF90      		pop r12
 579 0122 BF90      		pop r11
 580 0124 AF90      		pop r10
 581 0126 9F90      		pop r9
 582 0128 0895      		ret
 583               	.LVL36:
 584               	.L34:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 585               		.loc 1 117 22 is_stmt 1 view .LVU120
 586               	.LBB84:
 587               	.LBI78:
 588               		.loc 2 51 20 view .LVU121
 589               	.LBB82:
 590               		.loc 2 51 52 view .LVU122
 591               	.LBB80:
 592               	.LBI80:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 593               		.loc 2 49 20 view .LVU123
 594               	.LBB81:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 595               		.loc 2 49 51 view .LVU124
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 596               		.loc 2 49 74 is_stmt 0 view .LVU125
 597 012a CD28      		or r12,r13
 598 012c 01F0      		breq .L71
 599 012e 822F      		mov r24,r18
 600 0130 8323      		and r24,r19
 601 0132 8F3F      		cpi r24,lo8(-1)
 602 0134 01F0      		breq .+2
 603 0136 00C0      		rjmp .L37
 604               	.L71:
 605               	.LBE81:
 606               	.LBE80:
 607               		.loc 2 51 79 view .LVU126
 608 0138 80E0      		ldi r24,0
 609               	.LVL37:
 610               	.L36:
 611               		.loc 2 51 79 view .LVU127
 612               	.LBE82:
 613               	.LBE84:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 614               		.loc 1 117 25 view .LVU128
 615 013a B82F      		mov r27,r24
 616 013c B170      		andi r27,lo8(1)
 617 013e DB2E      		mov r13,r27
 618               	.LBB85:
 619               	.LBB86:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 620               		.loc 1 319 18 view .LVU129
 621 0140 E091 0000 		lds r30,waiting_buffer_tail
 622               	.LVL38:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 623               		.loc 1 319 45 view .LVU130
 624 0144 4091 0000 		lds r20,waiting_buffer_head
 320:./tmk_core/common/action_tapping.c ****             return true;
 625               		.loc 1 320 13 view .LVU131
 626 0148 56E0      		ldi r21,lo8(6)
 627               	.LBE86:
 628               	.LBE85:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 629               		.loc 1 117 25 view .LVU132
 630 014a 80FD      		sbrc r24,0
 631 014c 00C0      		rjmp .L39
 632               	.LVL39:
 633               	.L38:
 139:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 634               		.loc 1 139 21 is_stmt 1 view .LVU133
 139:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 635               		.loc 1 139 24 is_stmt 0 view .LVU134
 636 014e EE20      		tst r14
 637 0150 01F0      		breq .L26
 140:./tmk_core/common/action_tapping.c ****                     }
 638               		.loc 1 140 25 is_stmt 1 view .LVU135
 140:./tmk_core/common/action_tapping.c ****                     }
 639               		.loc 1 140 53 is_stmt 0 view .LVU136
 640 0152 8091 0000 		lds r24,tapping_key+5
 641 0156 8160      		ori r24,lo8(1<<0)
 642 0158 8093 0000 		sts tapping_key+5,r24
 643               	.LVL40:
 644               	.L123:
 645               	.LBB88:
 271:./tmk_core/common/action_tapping.c ****         }
 646               		.loc 1 271 13 is_stmt 1 view .LVU137
 271:./tmk_core/common/action_tapping.c ****         }
 647               		.loc 1 271 20 is_stmt 0 view .LVU138
 648 015c F12C      		mov r15,__zero_reg__
 649 015e 00C0      		rjmp .L26
 650               	.LVL41:
 651               	.L41:
 271:./tmk_core/common/action_tapping.c ****         }
 652               		.loc 1 271 20 view .LVU139
 653               	.LBE88:
 654               	.LBB89:
 655               	.LBB87:
 320:./tmk_core/common/action_tapping.c ****             return true;
 656               		.loc 1 320 9 is_stmt 1 view .LVU140
 320:./tmk_core/common/action_tapping.c ****             return true;
 657               		.loc 1 320 13 is_stmt 0 view .LVU141
 658 0160 8E2F      		mov r24,r30
 659 0162 90E0      		ldi r25,0
 660 0164 5E9F      		mul r21,r30
 661 0166 F001      		movw r30,r0
 662 0168 1124      		clr __zero_reg__
 663               	.LVL42:
 320:./tmk_core/common/action_tapping.c ****             return true;
 664               		.loc 1 320 13 view .LVU142
 665 016a E050      		subi r30,lo8(-(waiting_buffer))
 666 016c F040      		sbci r31,hi8(-(waiting_buffer))
 320:./tmk_core/common/action_tapping.c ****             return true;
 667               		.loc 1 320 12 view .LVU143
 668 016e 6181      		ldd r22,Z+1
 669 0170 2613      		cpse r18,r22
 670 0172 00C0      		rjmp .L40
 320:./tmk_core/common/action_tapping.c ****             return true;
 671               		.loc 1 320 13 view .LVU144
 672 0174 6081      		ld r22,Z
 673 0176 3613      		cpse r19,r22
 674 0178 00C0      		rjmp .L40
 320:./tmk_core/common/action_tapping.c ****             return true;
 675               		.loc 1 320 59 view .LVU145
 676 017a 6281      		ldd r22,Z+2
 677 017c E612      		cpse r14,r22
 678 017e 00C0      		rjmp .L38
 679               	.L40:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 680               		.loc 1 319 69 is_stmt 1 view .LVU146
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 681               		.loc 1 319 76 is_stmt 0 view .LVU147
 682 0180 FC01      		movw r30,r24
 683 0182 3196      		adiw r30,1
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 684               		.loc 1 319 71 view .LVU148
 685 0184 E770      		andi r30,lo8(7)
 686               	.LVL43:
 687               	.L39:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 688               		.loc 1 319 43 is_stmt 1 view .LVU149
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 689               		.loc 1 319 5 is_stmt 0 view .LVU150
 690 0186 E413      		cpse r30,r20
 691 0188 00C0      		rjmp .L41
 692               	.LVL44:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 693               		.loc 1 319 5 view .LVU151
 694               	.LBE87:
 695               	.LBE89:
 696               	.LBB90:
 119:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 697               		.loc 1 119 21 is_stmt 1 view .LVU152
 119:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 698               		.loc 1 119 39 is_stmt 0 view .LVU153
 699 018a 8F81      		ldd r24,Y+7
 700 018c 9885      		ldd r25,Y+8
 701 018e 0E94 0000 		call layer_switch_get_action
 702               	.LVL45:
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 703               		.loc 1 120 21 is_stmt 1 view .LVU154
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 704               		.loc 1 120 40 is_stmt 0 view .LVU155
 705 0192 292F      		mov r18,r25
 706 0194 2295      		swap r18
 707 0196 2F70      		andi r18,lo8(15)
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 708               		.loc 1 120 21 view .LVU156
 709 0198 9032      		cpi r25,lo8(32)
 710 019a 00F0      		brlo .L62
 711 019c 225F      		subi r18,lo8(-(14))
 712 019e 2F70      		andi r18,lo8(15)
 713 01a0 2230      		cpi r18,lo8(2)
 714 01a2 00F4      		brsh .L45
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 715               		.loc 1 128 29 is_stmt 1 view .LVU157
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 716               		.loc 1 128 33 is_stmt 0 view .LVU158
 717 01a4 9F70      		andi r25,lo8(15)
 718               	.LVL46:
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 719               		.loc 1 128 32 view .LVU159
 720 01a6 01F0      		breq .L46
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 721               		.loc 1 128 68 discriminator 1 view .LVU160
 722 01a8 F801      		movw r30,r16
 723 01aa 9581      		ldd r25,Z+5
 724 01ac 907F      		andi r25,lo8(-16)
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 725               		.loc 1 128 49 discriminator 1 view .LVU161
 726 01ae 01F4      		brne .L46
 727               	.LVL47:
 728               	.L75:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 729               		.loc 1 123 77 view .LVU162
 730 01b0 D12C      		mov r13,__zero_reg__
 731 01b2 00C0      		rjmp .L44
 732               	.LVL48:
 733               	.L62:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 734               		.loc 1 123 29 is_stmt 1 view .LVU163
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 735               		.loc 1 123 33 is_stmt 0 view .LVU164
 736 01b4 9F70      		andi r25,lo8(15)
 737               	.LVL49:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 738               		.loc 1 123 32 view .LVU165
 739 01b6 01F0      		breq .L46
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 740               		.loc 1 123 49 discriminator 1 view .LVU166
 741 01b8 8823      		tst r24
 742 01ba 01F0      		breq .L75
 743               	.L46:
 129:./tmk_core/common/action_tapping.c ****                             break;
 744               		.loc 1 129 29 is_stmt 1 view .LVU167
 129:./tmk_core/common/action_tapping.c ****                             break;
 745               		.loc 1 129 33 is_stmt 0 view .LVU168
 746 01bc 805E      		subi r24,lo8(-(32))
 747               	.LVL50:
 129:./tmk_core/common/action_tapping.c ****                             break;
 748               		.loc 1 129 32 view .LVU169
 749 01be 8830      		cpi r24,lo8(8)
 750 01c0 00F0      		brlo .L75
 751               	.LVL51:
 752               	.L45:
 133:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 753               		.loc 1 133 86 is_stmt 1 view .LVU170
 134:./tmk_core/common/action_tapping.c ****                     return true;
 754               		.loc 1 134 21 view .LVU171
 755 01c2 C801      		movw r24,r16
 756               	.LVL52:
 134:./tmk_core/common/action_tapping.c ****                     return true;
 757               		.loc 1 134 21 is_stmt 0 view .LVU172
 758 01c4 0E94 0000 		call process_record
 759               	.LVL53:
 135:./tmk_core/common/action_tapping.c ****                 }
 760               		.loc 1 135 21 is_stmt 1 view .LVU173
 761               	.L44:
 135:./tmk_core/common/action_tapping.c ****                 }
 762               		.loc 1 135 21 is_stmt 0 view .LVU174
 763 01c8 FD2C      		mov r15,r13
 764 01ca 00C0      		rjmp .L26
 765               	.LVL54:
 766               	.L54:
 135:./tmk_core/common/action_tapping.c ****                 }
 767               		.loc 1 135 21 view .LVU175
 768               	.LBE90:
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 769               		.loc 1 228 13 discriminator 2 view .LVU176
 770 01cc 8095      		com r24
 771 01ce 9095      		com r25
 772 01d0 8C0D      		add r24,r12
 773 01d2 9D1D      		adc r25,r13
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 774               		.loc 1 228 12 discriminator 2 view .LVU177
 775 01d4 883C      		cpi r24,-56
 776 01d6 9105      		cpc r25,__zero_reg__
 777 01d8 00F0      		brlo .+2
 778 01da 00C0      		rjmp .L56
 779               	.L55:
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 780               		.loc 1 229 13 is_stmt 1 view .LVU178
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 781               		.loc 1 229 22 is_stmt 0 view .LVU179
 782 01dc FE2C      		mov r15,r14
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 783               		.loc 1 229 16 view .LVU180
 784 01de E110      		cpse r14,__zero_reg__
 785 01e0 00C0      		rjmp .L57
 786               	.LVL55:
 787               	.L58:
 175:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 788               		.loc 1 175 21 is_stmt 1 view .LVU181
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 789               		.loc 2 49 51 view .LVU182
 176:./tmk_core/common/action_tapping.c ****                     }
 790               		.loc 1 176 74 view .LVU183
 178:./tmk_core/common/action_tapping.c ****                     return true;
 791               		.loc 1 178 21 view .LVU184
 792 01e2 C801      		movw r24,r16
 793 01e4 0E94 0000 		call process_record
 794               	.LVL56:
 795 01e8 00C0      		rjmp .L125
 796               	.LVL57:
 797               	.L60:
 242:./tmk_core/common/action_tapping.c ****                         return true;
 798               		.loc 1 242 25 view .LVU185
 242:./tmk_core/common/action_tapping.c ****                         return true;
 799               		.loc 1 242 37 is_stmt 0 view .LVU186
 800 01ea 86E0      		ldi r24,lo8(6)
 801 01ec F801      		movw r30,r16
 802 01ee A0E0      		ldi r26,lo8(tapping_key)
 803 01f0 B0E0      		ldi r27,hi8(tapping_key)
 804               		0:
 805 01f2 0190      		ld r0,Z+
 806 01f4 0D92      		st X+,r0
 807 01f6 8A95      		dec r24
 808 01f8 01F4      		brne 0b
 243:./tmk_core/common/action_tapping.c ****                     }
 809               		.loc 1 243 25 is_stmt 1 view .LVU187
 243:./tmk_core/common/action_tapping.c ****                     }
 810               		.loc 1 243 32 is_stmt 0 view .LVU188
 811 01fa 00C0      		rjmp .L26
 812               	.L59:
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 813               		.loc 1 245 24 is_stmt 1 view .LVU189
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 814               		.loc 1 245 28 is_stmt 0 view .LVU190
 815 01fc 8F81      		ldd r24,Y+7
 816 01fe 9885      		ldd r25,Y+8
 817 0200 0E94 0000 		call is_tap_key
 818               	.LVL58:
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 819               		.loc 1 245 27 view .LVU191
 820 0204 8111      		cpse r24,__zero_reg__
 821 0206 00C0      		rjmp .L50
 255:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 822               		.loc 1 255 21 is_stmt 1 view .LVU192
 255:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 823               		.loc 1 255 49 is_stmt 0 view .LVU193
 824 0208 8091 0000 		lds r24,tapping_key+5
 825 020c 8160      		ori r24,lo8(1<<0)
 826 020e 8093 0000 		sts tapping_key+5,r24
 256:./tmk_core/common/action_tapping.c ****                     return true;
 827               		.loc 1 256 21 is_stmt 1 view .LVU194
 828 0212 C801      		movw r24,r16
 829 0214 0E94 0000 		call process_record
 830               	.LVL59:
 257:./tmk_core/common/action_tapping.c ****                 }
 831               		.loc 1 257 21 view .LVU195
 257:./tmk_core/common/action_tapping.c ****                 }
 832               		.loc 1 257 28 is_stmt 0 view .LVU196
 833 0218 00C0      		rjmp .L26
 834               	.LVL60:
 835               	.L37:
 836               	.LBB91:
 837               	.LBB83:
 838               		.loc 2 51 79 view .LVU197
 839 021a 81E0      		ldi r24,lo8(1)
 840 021c 8E25      		eor r24,r14
 841 021e 00C0      		rjmp .L36
 842               	.LVL61:
 843               	.L33:
 844               		.loc 2 51 79 view .LVU198
 845               	.LBE83:
 846               	.LBE91:
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 847               		.loc 1 148 17 is_stmt 1 view .LVU199
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 848               		.loc 2 49 51 view .LVU200
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 849               		.loc 1 148 21 is_stmt 0 view .LVU201
 850 0220 2513      		cpse r18,r21
 851 0222 00C0      		rjmp .L47
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 852               		.loc 1 148 21 discriminator 2 view .LVU202
 853 0224 4313      		cpse r20,r19
 854 0226 00C0      		rjmp .L47
 150:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 855               		.loc 1 150 31 discriminator 3 view .LVU203
 856 0228 D801      		movw r26,r16
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 857               		.loc 1 148 47 discriminator 3 view .LVU204
 858 022a EE20      		tst r14
 859 022c 01F4      		brne .+2
 860 022e 00C0      		rjmp .L128
 861               	.L47:
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 862               		.loc 1 156 22 is_stmt 1 view .LVU205
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 863               		.loc 1 156 26 is_stmt 0 view .LVU206
 864 0230 8F81      		ldd r24,Y+7
 865 0232 9885      		ldd r25,Y+8
 866 0234 0E94 0000 		call is_tap_key
 867               	.LVL62:
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 868               		.loc 1 156 25 view .LVU207
 869 0238 8823      		tst r24
 870 023a 01F0      		breq .L58
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 871               		.loc 1 156 48 discriminator 1 view .LVU208
 872 023c EE20      		tst r14
 873 023e 01F0      		breq .L58
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 874               		.loc 1 157 21 is_stmt 1 view .LVU209
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 875               		.loc 1 157 40 is_stmt 0 view .LVU210
 876 0240 8091 0000 		lds r24,tapping_key+5
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 877               		.loc 1 157 24 view .LVU211
 878 0244 8032      		cpi r24,lo8(32)
 879 0246 00F0      		brlo .L50
 880               	.LBB92:
 158:./tmk_core/common/action_tapping.c ****                         // unregister key
 881               		.loc 1 158 87 is_stmt 1 view .LVU212
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 882               		.loc 1 160 25 view .LVU213
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 883               		.loc 1 160 54 is_stmt 0 view .LVU214
 884 0248 2091 0000 		lds r18,tapping_key
 885 024c 3091 0000 		lds r19,tapping_key+1
 886 0250 3A83      		std Y+2,r19
 887 0252 2983      		std Y+1,r18
 888 0254 1B82      		std Y+3,__zero_reg__
 889 0256 DD82      		std Y+5,r13
 890 0258 CC82      		std Y+4,r12
 891 025a 8E83      		std Y+6,r24
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 892               		.loc 1 160 25 view .LVU215
 893 025c CE01      		movw r24,r28
 894 025e 0196      		adiw r24,1
 895 0260 0E94 0000 		call process_record
 896               	.LVL63:
 897               	.L50:
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 898               		.loc 1 160 25 view .LVU216
 899               	.LBE92:
 167:./tmk_core/common/action_tapping.c ****                     }
 900               		.loc 1 167 69 is_stmt 1 view .LVU217
 169:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 901               		.loc 1 169 21 view .LVU218
 169:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 902               		.loc 1 169 33 is_stmt 0 view .LVU219
 903 0264 86E0      		ldi r24,lo8(6)
 904 0266 F801      		movw r30,r16
 905 0268 A0E0      		ldi r26,lo8(tapping_key)
 906 026a B0E0      		ldi r27,hi8(tapping_key)
 907               		0:
 908 026c 0190      		ld r0,Z+
 909 026e 0D92      		st X+,r0
 910 0270 8A95      		dec r24
 911 0272 01F4      		brne 0b
 170:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 912               		.loc 1 170 21 is_stmt 1 view .LVU220
 913 0274 0E94 0000 		call waiting_buffer_scan_tap
 914               	.LVL64:
 171:./tmk_core/common/action_tapping.c ****                     return true;
 915               		.loc 1 171 21 view .LVU221
 916 0278 0E94 0000 		call debug_tapping_key
 917               	.LVL65:
 172:./tmk_core/common/action_tapping.c ****                 }
 918               		.loc 1 172 21 view .LVU222
 919               	.L125:
 179:./tmk_core/common/action_tapping.c ****                 }
 920               		.loc 1 179 21 view .LVU223
 179:./tmk_core/common/action_tapping.c ****                 }
 921               		.loc 1 179 28 is_stmt 0 view .LVU224
 922 027c FF24      		clr r15
 923 027e F394      		inc r15
 924 0280 00C0      		rjmp .L26
 925               	.LVL66:
 926               	.L51:
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 927               		.loc 1 193 17 is_stmt 1 view .LVU225
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 928               		.loc 2 49 51 view .LVU226
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 929               		.loc 1 193 21 is_stmt 0 view .LVU227
 930 0282 2513      		cpse r18,r21
 931 0284 00C0      		rjmp .L47
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 932               		.loc 1 193 21 discriminator 2 view .LVU228
 933 0286 4313      		cpse r20,r19
 934 0288 00C0      		rjmp .L47
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 935               		.loc 1 193 47 discriminator 3 view .LVU229
 936 028a E110      		cpse r14,__zero_reg__
 937 028c 00C0      		rjmp .L47
 938               	.LBB93:
 194:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 939               		.loc 1 194 73 is_stmt 1 view .LVU230
 195:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 940               		.loc 1 195 21 view .LVU231
 195:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 941               		.loc 1 195 31 is_stmt 0 view .LVU232
 942 028e D801      		movw r26,r16
 943 0290 1596      		adiw r26,5
 944 0292 8C93      		st X,r24
 196:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 945               		.loc 1 196 21 is_stmt 1 view .LVU233
 946 0294 C801      		movw r24,r16
 947 0296 0E94 0000 		call process_record
 948               	.LVL67:
 197:./tmk_core/common/action_tapping.c ****                     return true;
 949               		.loc 1 197 21 view .LVU234
 197:./tmk_core/common/action_tapping.c ****                     return true;
 950               		.loc 1 197 33 is_stmt 0 view .LVU235
 951 029a 86E0      		ldi r24,lo8(6)
 952 029c F501      		movw r30,r10
 953               		0:
 954 029e 1192      		st Z+,__zero_reg__
 955 02a0 8A95      		dec r24
 956 02a2 01F4      		brne 0b
 198:./tmk_core/common/action_tapping.c ****                 }
 957               		.loc 1 198 21 is_stmt 1 view .LVU236
 198:./tmk_core/common/action_tapping.c ****                 }
 958               		.loc 1 198 28 is_stmt 0 view .LVU237
 959 02a4 F92C      		mov r15,r9
 960 02a6 00C0      		rjmp .L26
 961               	.LVL68:
 962               	.L57:
 198:./tmk_core/common/action_tapping.c ****                 }
 963               		.loc 1 198 28 view .LVU238
 964               	.LBE93:
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 965               		.loc 1 230 17 is_stmt 1 view .LVU239
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 966               		.loc 2 49 51 view .LVU240
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 967               		.loc 1 230 21 is_stmt 0 view .LVU241
 968 02a8 2513      		cpse r18,r21
 969 02aa 00C0      		rjmp .L59
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 970               		.loc 1 230 21 discriminator 2 view .LVU242
 971 02ac 4313      		cpse r20,r19
 972 02ae 00C0      		rjmp .L59
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 973               		.loc 1 231 21 is_stmt 1 view .LVU243
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 974               		.loc 1 231 41 is_stmt 0 view .LVU244
 975 02b0 8091 0000 		lds r24,tapping_key+5
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 976               		.loc 1 231 24 view .LVU245
 977 02b4 80FD      		sbrc r24,0
 978 02b6 00C0      		rjmp .L60
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 979               		.loc 1 231 79 discriminator 1 view .LVU246
 980 02b8 982F      		mov r25,r24
 981 02ba 907F      		andi r25,lo8(-16)
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 982               		.loc 1 231 54 discriminator 1 view .LVU247
 983 02bc 01F4      		brne .+2
 984 02be 00C0      		rjmp .L60
 233:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 985               		.loc 1 233 25 is_stmt 1 view .LVU248
 233:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 986               		.loc 1 233 35 is_stmt 0 view .LVU249
 987 02c0 D801      		movw r26,r16
 988 02c2 1596      		adiw r26,5
 989 02c4 8C93      		st X,r24
 990 02c6 1597      		sbiw r26,5
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 991               		.loc 1 234 25 is_stmt 1 view .LVU250
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 992               		.loc 1 234 28 is_stmt 0 view .LVU251
 993 02c8 903F      		cpi r25,lo8(-16)
 994 02ca 01F0      		breq .L61
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 995               		.loc 1 234 51 is_stmt 1 discriminator 1 view .LVU252
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 996               		.loc 1 234 67 is_stmt 0 discriminator 1 view .LVU253
 997 02cc 982F      		mov r25,r24
 998 02ce 907F      		andi r25,lo8(-16)
 999 02d0 905F      		subi r25,lo8(-(16))
 1000 02d2 8F70      		andi r24,lo8(15)
 1001 02d4 892B      		or r24,r25
 1002               	.L128:
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1003               		.loc 1 234 67 discriminator 1 view .LVU254
 1004 02d6 1596      		adiw r26,5
 1005 02d8 8C93      		st X,r24
 1006               	.L61:
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1007               		.loc 1 235 53 is_stmt 1 view .LVU255
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1008               		.loc 1 235 81 view .LVU256
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1009               		.loc 1 235 95 view .LVU257
 236:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 1010               		.loc 1 236 25 view .LVU258
 1011 02da C801      		movw r24,r16
 1012 02dc 0E94 0000 		call process_record
 1013               	.LVL69:
 237:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1014               		.loc 1 237 25 view .LVU259
 237:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1015               		.loc 1 237 37 is_stmt 0 view .LVU260
 1016 02e0 86E0      		ldi r24,lo8(6)
 1017 02e2 F801      		movw r30,r16
 1018 02e4 A0E0      		ldi r26,lo8(tapping_key)
 1019 02e6 B0E0      		ldi r27,hi8(tapping_key)
 1020               		0:
 1021 02e8 0190      		ld r0,Z+
 1022 02ea 0D92      		st X+,r0
 1023 02ec 8A95      		dec r24
 1024 02ee 01F4      		brne 0b
 238:./tmk_core/common/action_tapping.c ****                         return true;
 1025               		.loc 1 238 25 is_stmt 1 view .LVU261
 1026 02f0 00C0      		rjmp .L124
 1027               	.LVL70:
 1028               	.L115:
  81:./tmk_core/common/action_tapping.c **** 
 1029               		.loc 1 81 16 is_stmt 0 view .LVU262
 1030 02f2 F801      		movw r30,r16
 1031 02f4 3081      		ld r19,Z
 1032 02f6 2181      		ldd r18,Z+1
 1033 02f8 C380      		ldd r12,Z+3
 1034 02fa D480      		ldd r13,Z+4
 1035               	.LVL71:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 1036               		.loc 1 84 9 view .LVU263
 1037 02fc 9090 0000 		lds r9,tapping_key+2
 1038 0300 9110      		cpse r9,__zero_reg__
 1039 0302 00C0      		rjmp .L67
 227:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 1040               		.loc 1 227 12 is_stmt 1 view .LVU264
 1041               	.LVL72:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1042               		.loc 2 49 51 view .LVU265
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1043               		.loc 1 228 9 view .LVU266
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1044               		.loc 1 228 13 is_stmt 0 view .LVU267
 1045 0304 C816      		cp r12,r24
 1046 0306 D906      		cpc r13,r25
 1047 0308 00F4      		brsh .+2
 1048 030a 00C0      		rjmp .L54
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1049               		.loc 1 228 13 discriminator 1 view .LVU268
 1050 030c C81A      		sub r12,r24
 1051 030e D90A      		sbc r13,r25
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1052               		.loc 1 228 12 discriminator 1 view .LVU269
 1053 0310 F8EC      		ldi r31,-56
 1054 0312 CF16      		cp r12,r31
 1055 0314 D104      		cpc r13,__zero_reg__
 1056 0316 00F4      		brsh .+2
 1057 0318 00C0      		rjmp .L55
 1058               	.L56:
 1059               	.LBB94:
 267:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 1060               		.loc 1 267 70 is_stmt 1 view .LVU270
 268:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1061               		.loc 1 268 13 view .LVU271
 1062 031a 4F81      		ldd r20,Y+7
 1063 031c 5885      		ldd r21,Y+8
 1064 031e 6985      		ldd r22,Y+9
 1065 0320 7A85      		ldd r23,Y+10
 1066 0322 8B85      		ldd r24,Y+11
 1067 0324 0E94 0000 		call debug_event
 1068               	.LVL73:
 268:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1069               		.loc 1 268 44 view .LVU272
 269:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1070               		.loc 1 269 13 view .LVU273
 269:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1071               		.loc 1 269 25 is_stmt 0 view .LVU274
 1072 0328 86E0      		ldi r24,lo8(6)
 1073 032a E0E0      		ldi r30,lo8(tapping_key)
 1074 032c F0E0      		ldi r31,hi8(tapping_key)
 1075 032e DF01      		movw r26,r30
 1076               		0:
 1077 0330 1D92      		st X+,__zero_reg__
 1078 0332 8A95      		dec r24
 1079 0334 01F4      		brne 0b
 270:./tmk_core/common/action_tapping.c ****             return false;
 1080               		.loc 1 270 13 is_stmt 1 view .LVU275
 1081 0336 0E94 0000 		call debug_tapping_key
 1082               	.LVL74:
 1083 033a 00C0      		rjmp .L123
 1084               	.LBE94:
 1085               		.cfi_endproc
 1086               	.LFE5:
 1088               		.section	.text.action_tapping_process,"ax",@progbits
 1089               	.global	action_tapping_process
 1091               	action_tapping_process:
 1092               	.LFB4:
  40:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1093               		.loc 1 40 1 view -0
 1094               		.cfi_startproc
 1095 0000 1F93      		push r17
 1096               	.LCFI19:
 1097               		.cfi_def_cfa_offset 3
 1098               		.cfi_offset 17, -2
 1099 0002 CF93      		push r28
 1100               	.LCFI20:
 1101               		.cfi_def_cfa_offset 4
 1102               		.cfi_offset 28, -3
 1103 0004 DF93      		push r29
 1104               	.LCFI21:
 1105               		.cfi_def_cfa_offset 5
 1106               		.cfi_offset 29, -4
 1107 0006 CDB7      		in r28,__SP_L__
 1108 0008 DEB7      		in r29,__SP_H__
 1109               	.LCFI22:
 1110               		.cfi_def_cfa_register 28
 1111 000a 2C97      		sbiw r28,12
 1112               	.LCFI23:
 1113               		.cfi_def_cfa_offset 17
 1114 000c 0FB6      		in __tmp_reg__,__SREG__
 1115 000e F894      		cli
 1116 0010 DEBF      		out __SP_H__,r29
 1117 0012 0FBE      		out __SREG__,__tmp_reg__
 1118 0014 CDBF      		out __SP_L__,r28
 1119               	/* prologue: function */
 1120               	/* frame size = 12 */
 1121               	/* stack size = 15 */
 1122               	.L__stack_usage = 15
 1123 0016 4F83      		std Y+7,r20
 1124 0018 5887      		std Y+8,r21
 1125 001a 6987      		std Y+9,r22
 1126 001c 7A87      		std Y+10,r23
 1127 001e 8B87      		std Y+11,r24
 1128 0020 9C87      		std Y+12,r25
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1129               		.loc 1 41 5 view .LVU277
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1130               		.loc 1 41 9 is_stmt 0 view .LVU278
 1131 0022 CE01      		movw r24,r28
 1132 0024 0796      		adiw r24,7
 1133 0026 0E94 0000 		call process_tapping
 1134               	.LVL75:
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1135               		.loc 1 41 8 view .LVU279
 1136 002a 8823      		tst r24
 1137 002c 01F0      		breq .L133
  42:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1138               		.loc 1 42 9 is_stmt 1 view .LVU280
 1139               	.LVL76:
 1140               	.LBB104:
 1141               	.LBI104:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1142               		.loc 2 49 20 view .LVU281
 1143               	.LBB105:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1144               		.loc 2 49 51 view .LVU282
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1145               		.loc 2 49 74 is_stmt 0 view .LVU283
 1146 002e 8A85      		ldd r24,Y+10
 1147 0030 9B85      		ldd r25,Y+11
 1148 0032 892B      		or r24,r25
 1149 0034 01F0      		breq .L134
 1150 0036 5885      		ldd r21,Y+8
 1151 0038 4F81      		ldd r20,Y+7
 1152 003a 852F      		mov r24,r21
 1153 003c 8423      		and r24,r20
 1154 003e 8F3F      		cpi r24,lo8(-1)
 1155 0040 01F0      		breq .+2
 1156 0042 00C0      		rjmp .L156
 1157               	.LVL77:
 1158               	.L134:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1159               		.loc 2 49 74 view .LVU284
 1160               	.LBE105:
 1161               	.LBE104:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1162               		.loc 1 60 13 discriminator 1 view .LVU285
 1163 0044 16E0      		ldi r17,lo8(6)
 1164 0046 00C0      		rjmp .L141
 1165               	.L133:
  46:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1166               		.loc 1 46 9 is_stmt 1 view .LVU286
 1167 0048 86E0      		ldi r24,lo8(6)
 1168 004a FE01      		movw r30,r28
 1169 004c 3796      		adiw r30,7
 1170 004e DE01      		movw r26,r28
 1171 0050 1196      		adiw r26,1
 1172               		0:
 1173 0052 0190      		ld r0,Z+
 1174 0054 0D92      		st X+,r0
 1175 0056 8A95      		dec r24
 1176 0058 01F4      		brne 0b
 1177               	.LVL78:
 1178               	.LBB106:
 1179               	.LBI106:
 293:./tmk_core/common/action_tapping.c **** {
 1180               		.loc 1 293 6 view .LVU287
 1181               	.LBB107:
 295:./tmk_core/common/action_tapping.c ****         return true;
 1182               		.loc 1 295 5 view .LVU288
 1183               	.LBB108:
 1184               	.LBI108:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1185               		.loc 2 49 20 view .LVU289
 1186               	.LBB109:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1187               		.loc 2 49 51 view .LVU290
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1188               		.loc 2 49 74 is_stmt 0 view .LVU291
 1189 005a 8A85      		ldd r24,Y+10
 1190 005c 9B85      		ldd r25,Y+11
 1191 005e 892B      		or r24,r25
 1192 0060 01F0      		breq .L134
 1193 0062 8F81      		ldd r24,Y+7
 1194 0064 9885      		ldd r25,Y+8
 1195 0066 8923      		and r24,r25
 1196 0068 8F3F      		cpi r24,lo8(-1)
 1197 006a 01F0      		breq .L134
 1198               	.LVL79:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1199               		.loc 2 49 74 view .LVU292
 1200               	.LBE109:
 1201               	.LBE108:
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1202               		.loc 1 299 5 is_stmt 1 view .LVU293
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1203               		.loc 1 299 30 is_stmt 0 view .LVU294
 1204 006c 2091 0000 		lds r18,waiting_buffer_head
 1205 0070 30E0      		ldi r19,0
 1206 0072 C901      		movw r24,r18
 1207 0074 0196      		adiw r24,1
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1208               		.loc 1 299 35 view .LVU295
 1209 0076 8770      		andi r24,7
 1210 0078 9927      		clr r25
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1211               		.loc 1 299 57 view .LVU296
 1212 007a 4091 0000 		lds r20,waiting_buffer_tail
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1213               		.loc 1 299 8 view .LVU297
 1214 007e 4817      		cp r20,r24
 1215 0080 1906      		cpc __zero_reg__,r25
 1216 0082 01F4      		brne .L158
 1217               	.LVL80:
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1218               		.loc 1 299 8 view .LVU298
 1219               	.LBE107:
 1220               	.LBE106:
 1221               	.LBB111:
  48:./tmk_core/common/action_tapping.c ****             clear_keyboard();
 1222               		.loc 1 48 50 is_stmt 1 view .LVU299
  49:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1223               		.loc 1 49 13 view .LVU300
 1224 0084 0E94 0000 		call clear_keyboard
 1225               	.LVL81:
  50:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1226               		.loc 1 50 13 view .LVU301
 1227               	.LBB112:
 1228               	.LBI112:
 311:./tmk_core/common/action_tapping.c **** {
 1229               		.loc 1 311 6 view .LVU302
 1230               	.LBB113:
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1231               		.loc 1 313 5 view .LVU303
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1232               		.loc 1 313 25 is_stmt 0 view .LVU304
 1233 0088 1092 0000 		sts waiting_buffer_head,__zero_reg__
 314:./tmk_core/common/action_tapping.c **** }
 1234               		.loc 1 314 5 is_stmt 1 view .LVU305
 314:./tmk_core/common/action_tapping.c **** }
 1235               		.loc 1 314 25 is_stmt 0 view .LVU306
 1236 008c 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1237               	.LBE113:
 1238               	.LBE112:
  51:./tmk_core/common/action_tapping.c ****         }
 1239               		.loc 1 51 13 is_stmt 1 view .LVU307
  51:./tmk_core/common/action_tapping.c ****         }
 1240               		.loc 1 51 25 is_stmt 0 view .LVU308
 1241 0090 86E0      		ldi r24,lo8(6)
 1242 0092 E0E0      		ldi r30,lo8(tapping_key)
 1243 0094 F0E0      		ldi r31,hi8(tapping_key)
 1244 0096 DF01      		movw r26,r30
 1245               		0:
 1246 0098 1D92      		st X+,__zero_reg__
 1247 009a 8A95      		dec r24
 1248 009c 01F4      		brne 0b
 1249 009e 00C0      		rjmp .L134
 1250               	.LVL82:
 1251               	.L158:
  51:./tmk_core/common/action_tapping.c ****         }
 1252               		.loc 1 51 25 view .LVU309
 1253               	.LBE111:
 1254               	.LBB114:
 1255               	.LBB110:
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1256               		.loc 1 304 5 is_stmt 1 view .LVU310
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1257               		.loc 1 304 41 is_stmt 0 view .LVU311
 1258 00a0 96E0      		ldi r25,lo8(6)
 1259               	.LVL83:
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1260               		.loc 1 304 41 view .LVU312
 1261 00a2 929F      		mul r25,r18
 1262 00a4 D001      		movw r26,r0
 1263 00a6 939F      		mul r25,r19
 1264 00a8 B00D      		add r27,r0
 1265 00aa 1124      		clr __zero_reg__
 1266 00ac A050      		subi r26,lo8(-(waiting_buffer))
 1267 00ae B040      		sbci r27,hi8(-(waiting_buffer))
 1268 00b0 FE01      		movw r30,r28
 1269 00b2 3196      		adiw r30,1
 1270               		0:
 1271 00b4 0190      		ld r0,Z+
 1272 00b6 0D92      		st X+,r0
 1273 00b8 9A95      		dec r25
 1274 00ba 01F4      		brne 0b
 305:./tmk_core/common/action_tapping.c **** 
 1275               		.loc 1 305 5 is_stmt 1 view .LVU313
 305:./tmk_core/common/action_tapping.c **** 
 1276               		.loc 1 305 25 is_stmt 0 view .LVU314
 1277 00bc 8093 0000 		sts waiting_buffer_head,r24
 307:./tmk_core/common/action_tapping.c ****     return true;
 1278               		.loc 1 307 34 is_stmt 1 view .LVU315
 307:./tmk_core/common/action_tapping.c ****     return true;
 1279               		.loc 1 307 36 view .LVU316
 1280 00c0 0E94 0000 		call debug_waiting_buffer
 1281               	.LVL84:
 308:./tmk_core/common/action_tapping.c **** }
 1282               		.loc 1 308 5 view .LVU317
 308:./tmk_core/common/action_tapping.c **** }
 1283               		.loc 1 308 5 is_stmt 0 view .LVU318
 1284 00c4 00C0      		rjmp .L134
 1285               	.L139:
 1286               	.LBE110:
 1287               	.LBE114:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1288               		.loc 1 60 9 is_stmt 1 view .LVU319
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1289               		.loc 1 60 13 is_stmt 0 view .LVU320
 1290 00c6 819F      		mul r24,r17
 1291 00c8 C001      		movw r24,r0
 1292 00ca 1124      		clr __zero_reg__
 1293 00cc 8050      		subi r24,lo8(-(waiting_buffer))
 1294 00ce 9040      		sbci r25,hi8(-(waiting_buffer))
 1295 00d0 0E94 0000 		call process_tapping
 1296               	.LVL85:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1297               		.loc 1 60 12 view .LVU321
 1298 00d4 8823      		tst r24
 1299 00d6 01F0      		breq .L132
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1300               		.loc 1 61 48 is_stmt 1 view .LVU322
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1301               		.loc 1 61 80 view .LVU323
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1302               		.loc 1 61 95 view .LVU324
  62:./tmk_core/common/action_tapping.c ****         } else {
 1303               		.loc 1 62 13 view .LVU325
 1304 00d8 E091 0000 		lds r30,waiting_buffer_tail
 1305 00dc 1E9F      		mul r17,r30
 1306 00de F001      		movw r30,r0
 1307 00e0 1124      		clr __zero_reg__
 1308 00e2 E050      		subi r30,lo8(-(waiting_buffer))
 1309 00e4 F040      		sbci r31,hi8(-(waiting_buffer))
 1310 00e6 4081      		ld r20,Z
 1311 00e8 5181      		ldd r21,Z+1
 1312 00ea 6281      		ldd r22,Z+2
 1313 00ec 7381      		ldd r23,Z+3
 1314 00ee 8481      		ldd r24,Z+4
 1315 00f0 9581      		ldd r25,Z+5
 1316 00f2 0E94 0000 		call debug_record
 1317               	.LVL86:
  62:./tmk_core/common/action_tapping.c ****         } else {
 1318               		.loc 1 62 77 view .LVU326
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1319               		.loc 1 59 56 view .LVU327
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1320               		.loc 1 59 99 is_stmt 0 view .LVU328
 1321 00f6 8091 0000 		lds r24,waiting_buffer_tail
 1322 00fa 90E0      		ldi r25,0
 1323 00fc 0196      		adiw r24,1
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1324               		.loc 1 59 104 view .LVU329
 1325 00fe 8770      		andi r24,7
 1326 0100 9927      		clr r25
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1327               		.loc 1 59 76 view .LVU330
 1328 0102 8093 0000 		sts waiting_buffer_tail,r24
 1329               	.L141:
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1330               		.loc 1 59 12 is_stmt 1 discriminator 1 view .LVU331
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1331               		.loc 1 59 32 is_stmt 0 discriminator 1 view .LVU332
 1332 0106 8091 0000 		lds r24,waiting_buffer_tail
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1333               		.loc 1 59 5 discriminator 1 view .LVU333
 1334 010a 9091 0000 		lds r25,waiting_buffer_head
 1335 010e 8913      		cpse r24,r25
 1336 0110 00C0      		rjmp .L139
 1337               	.L132:
 1338               	/* epilogue start */
  70:./tmk_core/common/action_tapping.c **** 
 1339               		.loc 1 70 1 view .LVU334
 1340 0112 2C96      		adiw r28,12
 1341 0114 0FB6      		in __tmp_reg__,__SREG__
 1342 0116 F894      		cli
 1343 0118 DEBF      		out __SP_H__,r29
 1344 011a 0FBE      		out __SREG__,__tmp_reg__
 1345 011c CDBF      		out __SP_L__,r28
 1346 011e DF91      		pop r29
 1347 0120 CF91      		pop r28
 1348 0122 1F91      		pop r17
 1349 0124 0895      		ret
 1350               	.LVL87:
 1351               	.L156:
  43:./tmk_core/common/action_tapping.c ****         }
 1352               		.loc 1 43 33 is_stmt 1 view .LVU335
  43:./tmk_core/common/action_tapping.c ****         }
 1353               		.loc 1 43 35 view .LVU336
 1354 0126 6985      		ldd r22,Y+9
 1355 0128 7A85      		ldd r23,Y+10
 1356 012a 8B85      		ldd r24,Y+11
 1357 012c 9C85      		ldd r25,Y+12
 1358 012e 0E94 0000 		call debug_record
 1359               	.LVL88:
 1360 0132 00C0      		rjmp .L134
 1361               		.cfi_endproc
 1362               	.LFE4:
 1364               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1367               	waiting_buffer_tail:
 1368 0000 00        		.zero	1
 1369               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1372               	waiting_buffer_head:
 1373 0000 00        		.zero	1
 1374               		.section	.bss.waiting_buffer,"aw",@nobits
 1377               	waiting_buffer:
 1378 0000 0000 0000 		.zero	48
 1378      0000 0000 
 1378      0000 0000 
 1378      0000 0000 
 1378      0000 0000 
 1379               		.section	.bss.tapping_key,"aw",@nobits
 1382               	tapping_key:
 1383 0000 0000 0000 		.zero	6
 1383      0000 
 1384               		.text
 1385               	.Letext0:
 1386               		.file 3 "/usr/avr/include/stdint.h"
 1387               		.file 4 "./tmk_core/common/keycode.h"
 1388               		.file 5 "./tmk_core/common/action_code.h"
 1389               		.file 6 "./tmk_core/common/action.h"
 1390               		.file 7 "./tmk_core/common/action_layer.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
     /tmp/ccPIXMhz.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccPIXMhz.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccPIXMhz.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccPIXMhz.s:5      *ABS*:000000000000003b __RAMPZ__
     /tmp/ccPIXMhz.s:6      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccPIXMhz.s:7      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccPIXMhz.s:13     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
     /tmp/ccPIXMhz.s:1367   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
     /tmp/ccPIXMhz.s:1372   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
     /tmp/ccPIXMhz.s:1377   .bss.waiting_buffer:0000000000000000 waiting_buffer
     /tmp/ccPIXMhz.s:96     .text.debug_tapping_key:0000000000000000 debug_tapping_key
     /tmp/ccPIXMhz.s:1382   .bss.tapping_key:0000000000000000 tapping_key
     /tmp/ccPIXMhz.s:119    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
     /tmp/ccPIXMhz.s:308    .text.process_tapping:0000000000000000 process_tapping
     /tmp/ccPIXMhz.s:1091   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
debug_record
process_record
is_tap_key
debug_event
layer_switch_get_action
clear_keyboard
__do_clear_bss
